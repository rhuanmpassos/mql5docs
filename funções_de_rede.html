<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun√ß√µes de rede - MQL5 Docs</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <h1>MQL5 Docs</h1>
            <p>Documenta√ß√£o Completa</p>
        </div>
        <div class="search-box">
            <input type="text" id="search" placeholder="Buscar..." onkeyup="filterNav()">
        </div>
        <ul class="nav-list" id="nav-list">
            <li class=""><a href="index.html">üìö √çndice</a></li>
            <li class=""><a href="introducao.html">Introducao</a></li>
<li class=""><a href="refer√™ncia_mql5.html">Refer√™ncia MQL5</a></li>
<li class=""><a href="elementos_b√°sicos_da_linguagem.html">Elementos B√°sicos da Linguagem</a></li>
<li class=""><a href="constantes,_enumeradores_e_estruturas.html">Constantes, Enumeradores e Estruturas</a></li>
<li class=""><a href="programas_mql5.html">Programas MQL5</a></li>
<li class=""><a href="vari√°veis_predefinidas.html">Vari√°veis Predefinidas</a></li>
<li class=""><a href="fun√ß√µes_comuns.html">Fun√ß√µes Comuns</a></li>
<li class=""><a href="fun√ß√µes_para_array.html">Fun√ß√µes para Array</a></li>
<li class=""><a href="m√©todos_matriciais_e_vetoriais.html">M√©todos matriciais e vetoriais</a></li>
<li class=""><a href="fun√ß√µes_de_convers√£o.html">Fun√ß√µes de Convers√£o</a></li>
<li class=""><a href="fun√ß√µes_matem√°ticas.html">Fun√ß√µes Matem√°ticas</a></li>
<li class=""><a href="fun√ß√µes_de_string.html">Fun√ß√µes de String</a></li>
<li class=""><a href="data_e_hora.html">Data e Hora</a></li>
<li class=""><a href="informa√ß√µes_de_conta.html">Informa√ß√µes de Conta</a></li>
<li class=""><a href="verificando_estado.html">Verificando Estado</a></li>
<li class=""><a href="manipula√ß√£o_de_eventos.html">Manipula√ß√£o de eventos</a></li>
<li class=""><a href="informa√ß√µes_de_mercado.html">Informa√ß√µes de Mercado</a></li>
<li class=""><a href="calend√°rio_econ√¥mico.html">Calend√°rio econ√¥mico</a></li>
<li class=""><a href="s√©ries_temporais_e_acesso_a_indicadores.html">S√©ries Temporais e Acesso a Indicadores</a></li>
<li class=""><a href="s√≠mbolos_personalizados.html">S√≠mbolos personalizados</a></li>
<li class=""><a href="opera√ß√µes_de_gr√°ficos.html">Opera√ß√µes de Gr√°ficos</a></li>
<li class=""><a href="fun√ß√µes_de_negocia√ß√£o.html">Fun√ß√µes de Negocia√ß√£o</a></li>
<li class=""><a href="gerenciamento_de_sinais.html">Gerenciamento de sinais</a></li>
<li class="active"><a href="fun√ß√µes_de_rede.html">Fun√ß√µes de rede</a></li>
<li class=""><a href="vari√°veis_globais_do_terminal.html">Vari√°veis Globais do Terminal</a></li>
<li class=""><a href="fun√ß√µes_de_arquivo.html">Fun√ß√µes de Arquivo</a></li>
<li class=""><a href="indicadores_customizados.html">Indicadores Customizados</a></li>
<li class=""><a href="fun√ß√µes_de_objeto.html">Fun√ß√µes de Objeto</a></li>
<li class=""><a href="indicadores_t√©cnicos.html">Indicadores T√©cnicos</a></li>
<li class=""><a href="trabalhando_com_resultados_de_otimiza√ß√£o.html">Trabalhando com Resultados de Otimiza√ß√£o</a></li>
<li class=""><a href="trabalhando_com_eventos.html">Trabalhando com Eventos</a></li>
<li class=""><a href="trabalhando_com_opencl.html">Trabalhando com OpenCL</a></li>
<li class=""><a href="trabalhar_com_bancos_de_dados.html">Trabalhar com bancos de dados</a></li>
<li class=""><a href="trabalho_com_directx.html">Trabalho com DirectX</a></li>
<li class=""><a href="metatrader_para_python.html">MetaTrader para Python</a></li>
<li class=""><a href="modelos_onnx.html">Modelos ONNX</a></li>
<li class=""><a href="biblioteca_padr√£o.html">Biblioteca Padr√£o</a></li>
<li class=""><a href="migrando_do_mql4.html">Migrando do MQL4</a></li>
<li class=""><a href="lista_de_fun√ß√µes_mql5.html">Lista de Fun√ß√µes MQL5</a></li>
<li class=""><a href="lista_de_constantes_mql5.html">Lista de Constantes MQL5</a></li>

        </ul>
    </nav>
    
    <main class="content">
        <header>
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <h1>Fun√ß√µes de rede</h1>
        </header>
        
        <article>
            <p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2404
<h3>Fun√ß√µes de rede</h3>
Os programas MQL5 podem trocar dados com servidores remotos, enviar notifica√ß√µes push, e-mails e
dados FTP.
¬∑ O grupo de fun√ß√µes Socket* permite que voc√™ crie uma conex√£o TCP (incluindo uma conex√£o TLS
segura) com um host remoto por meio de soquetes de sistema. O esquema de trabalho √© simples:
voc√™ cria o soquete, conecta-se ao servidor, e, assim, come√ßaler e registrar dados.
¬∑ A fun√ß√£o WebRequest √© projetada para trabalhar com recursos da Web e facilita o envio de
solicita√ß√µes HTTP (incluindo GET e POST).
¬∑ SendFTP, SendMail e SendNotification s√£o uma fun√ß√£o mais simples para enviar arquivos, e-mail e
notifica√ß√µes m√≥veis.
Para seguran√ßa do usu√°rio final, no lado do terminal do cliente √© implementada uma lista de endere√ßos
IP permitidos, com a qual o programa MQL5 pode ser conectado usando as fun√ß√µes Socket* e
WebRequest. Por exemplo, se ela precisar se conectar a https://www.someserver.com, esse endere√ßo
dever√° ser explicitamente indicado pelo usu√°rio do terminal na lista de permitidos. Via software n√£o √©
poss√≠vel adicionar o endere√ßo.
Para notificar o usu√°rio sobre a necessidade de configura√ß√£o adicional, inclua uma mensagem expl√≠cita
no programa MQL5. Por exemplo, via #property description, Alert ou Print.
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>SocketCreate</h3>
Cria um soquete com os sinalizadores especificados e retorna seu
identificador
<h3>SocketClose</h3>
<h3>Fecha o soquete</h3>
<h3>SocketConnect</h3>
Conecta-se ao servidor com controle de tempo limite
<h3>SocketIsConnected</h3>
Verifica se h√° um soquete conectado atualmente</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2405
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>SocketIsReadable</h3>
Obt√©m o n√∫mero de bytes que podem ser lidos do soquete.
<h3>SocketIsWritable</h3>
Verifica se os dados podem ser registrados no soquete no momento
atual.
<h3>SocketTimeouts</h3>
Define os tempos limite a fim de receber e enviar dados para o
objeto de sistema de soquete
<h3>SocketRead</h3>
<h3>L√™ dados do soquete</h3>
<h3>SocketSend</h3>
<h3>Registra dados no soquete</h3>
<h3>SocketTlsHandshake</h3>
Inicia uma conex√£o TLS (SSL) segura com o host especificado
usando o protocolo TLS Handshake
<h3>SocketTlsCertificate</h3>
Recebe informa√ß√µes sobre o certificado usado para proteger a
conex√£o de rede.
<h3>SocketTlsRead</h3>
L√™ dados de uma conex√£o TLS segura
<h3>SocketTlsReadAvailable</h3>
L√™ todos os dados dispon√≠veis a partir de uma conex√£o TLS segura
<h3>SocketTlsSend</h3>
Envia dados por meio de uma conex√£o TLS segura
<h3>WebRequest</h3>
Envia uma solicita√ß√£o HTTP para o servidor especificado
<h3>SendFTP</h3>
Envia um arquivo para o endere√ßo especificado na janela de
configura√ß√µes na guia &quot;FTP&quot;
<h3>SendMail</h3>
Envia um e-mail para o endere√ßo especificado na janela de
configura√ß√µes na guia &quot;Mail&quot;
<h3>SendNotification</h3>
Envia notifica√ß√µes por push para terminais m√≥veis cuja ID
<h3>MetaQuotes √© indicada na guia &quot;Notifica√ß√µes&quot;</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2406
<h3>SocketCreate</h3>
Cria um soquete com os sinalizadores especificados e retorna seu identificador.
</p>
<pre><code class="language-mql5">
int¬† SocketCreate(
   uint     flags         // sinalizadores
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
flags
[in]  Combina√ß√£o de sinalizadores definindo o modo de opera√ß√£o com o soquete. Atualmente, √©
suportado um sinalizador ‚Äî SOCKET_DEFAULT.
<h3>Valor retornado</h3>
Ap√≥s a cria√ß√£o bem-sucedida de um soquete, retorna seu identificador, caso contr√°rio,
INVALID_HANDLE.
<h3>Coment√°rio:</h3>
Para liberar a mem√≥ria do computador de um soquete n√£o utilizado, chame para ele SocketClose.
De um programa MQL5 voc√™ pode criar um m√°ximo de 128 soquetes. Quando exceder o limite em
_LastError √© registrado o erro 5271 (ERR_NETSOCKET_TOO_MANY_OPENED).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2407
</p>
<pre><code class="language-mql5">
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2408
</p>
<pre><code class="language-mql5">
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2409
<h3>SocketClose</h3>
Fecha o soquete.
</p>
<pre><code class="language-mql5">
bool¬† SocketClose(
   const int  socket      // identificador do soquete
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete que deve ser fechado. O identificador √© retornado pela fun√ß√£o
SocketCreate. Ao passar um identificador inv√°lido para _LastError √© registrado o erro 5270
(ERR_NETSOCKET_INVALIDHANDLE).
<h3>Valor retornado</h3>
Retorna true em caso de sucesso, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
Se, para o soquete, anteriormente foi criada uma conex√£o SocketConnect, ela ser√° interrompida.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2410
</p>
<pre><code class="language-mql5">
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2411
</p>
<pre><code class="language-mql5">
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2412
<h3>SocketConnect</h3>
Conecta-se ao servidor com controle de tempo limite.
</p>
<pre><code class="language-mql5">
bool¬† SocketConnect(
   int           socket,               // soquete
   const string  server,               // endere√ßo para conex√£o
   uint          port,                 // porto para conex√£o
   uint          timeout_receive_ms    // tempo limite da conex√£o
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
server
[in]  Nome de dom√≠nio do servidor ao qual voc√™ deseja se conectar ou seu endere√ßo IP.
port
[in]  N√∫mero da porta para conex√£o.
timeout_receive_ms
[in]  Tempo limite de conex√£o em milissegundos. Se a conex√£o falhar durante esse per√≠odo, ser√£o
interrompidas as tentativas.
<h3>Valor retornado</h3>
Retorna true na conex√£o bem-sucedida, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
O endere√ßo para conex√£o deve ser adicionado √† lista de permitidos no lado do terminal do cliente
(se√ß√£o Servi√ßos \ Configura√ß√µes \ Expert Advisors).
<h3>Em</h3>
caso 
de 
erro 
de 
conex√£o 
em 
_LastError 
√© 
registrado 
o 
erro 
5272
(ERR_NETSOCKET_CANNOT_CONNECT).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2413
</p>
<pre><code class="language-mql5">
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2414
</p>
<pre><code class="language-mql5">
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2415
</p>
<pre><code class="language-mql5">
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2416
<h3>SocketIsConnected</h3>
Verifica se h√° um soquete conectado atualmente.
</p>
<pre><code class="language-mql5">
bool¬† SocketIsConnected(
   const int  socket      // identificador do soquete
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate(). Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
<h3>Valor retornado</h3>
Retorna true se o soquete estiver conectado, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
Usando a fun√ß√£o SocketIsConnected(), voc√™ pode verificar a conex√£o do soquete em um
determinado momento.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            SocketIsConnected.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#property description &quot;Add Address to the list of allowed ones in the terminal setting
#property script_show_inputs
input string Address    =&quot;www.mql5.com&quot;;
input int    Port       =80;
input bool   CloseSocket=true;
bool         ExtTLS     =false;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- criamos um soquete e obtemos seu identificador
   int socket=SocketCreate();
//--- verificamos o identificador</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2417
</p>
<pre><code class="language-mql5">
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver bem, podemos nos conectar.
      if(SocketConnect(socket,Address,Port,1000))
        {
         PrintFormat(&quot;Established connection to %s:%d&quot;,Address,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, imprimimos seus dado
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;TLS certificate:&quot;);
            Print(&quot;   Owner:      &quot;,subject);
            Print(&quot;   Issuer:     &quot;,issuer);
            Print(&quot;   Number:     &quot;,serial);
            Print(&quot;   Print:      &quot;,thumbprint);
            Print(&quot;   Expiration: &quot;,expiration);
            ExtTLS=true;
           }
         //--- enviamos uma solicita√ß√£o GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;GET request sent&quot;);
            //--- lemos a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Failed to get a response, error &quot;,GetLastError());
           }
         else
            Print(&quot;Failed to send GET request, error &quot;,GetLastError());
        }
      else
        {
         PrintFormat(&quot;Connection to %s:%d failed, error %d&quot;,Address,Port,GetLastError
        }
      //--- se o sinalizador estiver definido, fechamos o soquete ap√≥s o uso
      if(CloseSocket)
         SocketClose(socket);
     }
   else
      Print(&quot;Failed to create a socket, error &quot;,GetLastError());
//--- verificamos a conex√£o ao servidor
   bool connected=SocketIsConnected(socket);
//--- se n√£o houver conex√£o, encerramos
   if(!connected)
     {
      Print(&quot;No connection to server&quot;);
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2418
</p>
<pre><code class="language-mql5">
//--- –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–∫–ª—ése houver uma conex√£o com o servidor
   else
     {
      Print(&quot;Connection to the server is available\nThe connection needs to be closed.
      //--- encerramos o soquete e verificamos o status da conex√£o novamente
      SocketClose(socket);
      connected=SocketIsConnected(socket);
     }
//--- imprimimos o estado atual da conex√£o com o servidor no log
   Print(&quot;Currently connected: &quot;,(connected ? &quot;opened&quot; : &quot;closed&quot;));
   /*
   resultado quando CloseSocket = true:
   No connection to server
   Currently connected: closed
   resultado quanto CloseSocket = false:
   Connection to the server is available
   The connection needs to be closed. Closing
   Currently connected: closed
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Envio de um comando ao servidor¬†                                 |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
//--- convertemos a string em um array de caracteres, descartando o zero final
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o protegida por TLS via porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Leitura da resposta do servidor                                  |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout_ms)
  {
   char   rsp[];
   string result;
   ulong  timeout_check=GetTickCount64()+timeout_ms;
//--- lemos dados do soquete enquanto eles existirem, mas n√£o mais do que o tempo limi
   do</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2419
</p>
<pre><code class="language-mql5">
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- comandos de leitura diferentes, dependendo do fato de a conex√£o estar p
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout_ms);
         //--- analisamos a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprimimos apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;HTTP answer header received:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
            //--- atualizamos o tempo de expira√ß√£o do tempo limite de leitura
            timeout_check=GetTickCount64()+timeout_ms;
           }
        }
     }
   while(GetTickCount64()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SocketConnect, SocketIsWritable, SocketCreate, SocketClose</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2420
<h3>SocketIsReadable</h3>
Obt√©m o n√∫mero de bytes que podem ser lidos a partir do soquete.
uint¬† SocketIsReadable(
</p>
<pre><code class="language-mql5">
   const int  socket      // identificador do soquete
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
<h3>Valor retornado</h3>
N√∫mero de bytes que podem ser lidos. Em caso de erro, retorna 0.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
Antes de chamar SocketRead, verifique se o soquete tem dados que ler. Caso contr√°rio, na aus√™ncia
de dados, a fun√ß√£o SocketRead ir√° esperar em v√£o dados durante timeout_ms, atrasando a
execu√ß√£o do programa.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2421
</p>
<pre><code class="language-mql5">
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2422
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2423
<h3>SocketIsWritable</h3>
Verifica se os dados podem ser gravados no soquete no momento atual.
</p>
<pre><code class="language-mql5">
bool¬† SocketIsWritable(
   const int  socket      // identificador do soquete
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
<h3>Valor retornado</h3>
Retorna true se a opera√ß√£o for poss√≠vel, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
Com esta fun√ß√£o, voc√™ pode verificar se os dados podem ser gravados no soquete agora.
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                             SocketIsWritable.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#property description &quot;Add Address to the list of allowed ones in the terminal setting
#property script_show_inputs
input string Address    =&quot;www.mql5.com&quot;;
input int    Port       =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- criamos um soquete e obtemos seu identificador
   int socket=SocketCreate();
//--- verificamos o identificador</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2424
</p>
<pre><code class="language-mql5">
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver bem, podemos nos conectar.
      if(SocketConnect(socket,Address,Port,1000))
        {
         PrintFormat(&quot;Established connection to %s:%d&quot;,Address,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, imprimimos seus dado
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;TLS certificate:&quot;);
            Print(&quot;   Owner:      &quot;,subject);
            Print(&quot;   Issuer:     &quot;,issuer);
            Print(&quot;   Number:     &quot;,serial);
            Print(&quot;   Print:      &quot;,thumbprint);
            Print(&quot;   Expiration: &quot;,expiration);
            ExtTLS=true;
           }
         //--- enviamos uma solicita√ß√£o GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;GET request sent&quot;);
            //--- lemos a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Failed to get a response, error &quot;,GetLastError());
           }
         else
            Print(&quot;Failed to send GET request, error &quot;,GetLastError());
        }
      else
        {
         PrintFormat(&quot;Connection to %s:%d failed, error %d&quot;,Address,Port,GetLastError
        }
      //--- imprimimos no log a possibilidade de gravar dados no soquete no momento at
      if(SocketIsWritable(socket))
         Print(&quot;At the current moment in time, writing data to the socket is possible&quot;
      else
         Print(&quot;It is not possible to write data to the socket at the current time&quot;);
      //--- fechamos o soquete ap√≥s us√°-lo
      if(SocketClose(socket))
         Print(&quot;Now the socket is closed&quot;);
     }
   else
      Print(&quot;Failed to create a socket, error &quot;,GetLastError());
   /*
   Resultado:
   At the current moment in time, writing data to the socket is possible</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2425
</p>
<pre><code class="language-mql5">
   Socket is closed now
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Envio de um comando ao servidor¬†                                 |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
//--- convertemos a string em um array de caracteres, descartando o zero final
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o protegida por TLS via porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Leitura da resposta do servidor                                  |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout_ms)
  {
   char   rsp[];
   string result;
   ulong  timeout_check=GetTickCount64()+timeout_ms;
//--- lemos dados do soquete enquanto eles existirem, mas n√£o mais do que o tempo limi
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- comandos de leitura diferentes, dependendo do fato de a conex√£o estar p
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout_ms);
         //--- analisamos a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprimimos apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2426
</p>
<pre><code class="language-mql5">
              {
               Print(&quot;HTTP answer header received:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
            //--- atualizamos o tempo de expira√ß√£o do tempo limite de leitura
            timeout_check=GetTickCount64()+timeout_ms;
           }
        }
     }
   while(GetTickCount64()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2427
<h3>SocketTimeouts</h3>
Define os tempos limite para receber e enviar dados para o objeto do sistema do soquete.
</p>
<pre><code class="language-mql5">
bool¬† SocketTimeouts(
   int           socket,               // soquete
   uint          timeout_send_ms,      // tempo limite para envio de dados
   uint          timeout_receive_ms    // tempo limite de aquisi√ß√£o de dados
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
timeout_send_ms
[in]  Tempo limite de envio de dados em milissegundos.
timeout_receive_ms
[in]  Tempo limite para receber dados em milissegundos.
<h3>Valor retornado</h3>
Retorna true em caso de sucesso, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
N√£o confunda o tempo limite dos objetos do sistema e o tempo limite definido ao ler os dados via
SocketRead. SocketTimeout define os tempos limite uma vez para o objeto do soquete no sistema
operacional. Esses tempos limite ser√£o aplicados a todas as fun√ß√µes de leitura e de envio de dados
atrav√©s desse soquete. Em SocketRead, o tempo limite √© definido para uma opera√ß√£o de leitura de
dados espec√≠fica.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                               SocketTimeouts.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#define   TIMEOUT_SEND     5000
#define   TIMEOUT_RECEIVE  5000
//+------------------------------------------------------------------+
//| Script program start function                                    |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2428
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- criamos um soquete e obtemos seu identificador
   int socket=SocketCreate();
   if(socket==INVALID_HANDLE)
     {
      Print(&quot;SocketCreate() failed. Error &quot;,GetLastError());
      return;
     }
//--- definimos tempos limite para receber e enviar dados para o objeto do sistema de 
   if(SocketTimeouts(socket,TIMEOUT_SEND,TIMEOUT_RECEIVE))
      PrintFormat(&quot;timeouts were successfully set&quot;,socket,TIMEOUT_SEND,TIMEOUT_RECEIVE
   else
      PrintFormat(&quot;SocketTimeouts(%d, %I64d, %I64d) failed. Error %d&quot;,socket,TIMEOUT_S
//--- fechamos o soquete
   SocketClose(socket);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2429
<h3>SocketRead</h3>
L√™ dados do soquete.
</p>
<pre><code class="language-mql5">
int¬† SocketRead(
   int           socket,               // soquete
   uchar&amp;        buffer[],             // buffer para ler dados do soquete
   uint          buffer_maxlen,        // n√∫mero de bytes necess√°rio para leitura
   uint          timeout_ms            // tempo limite de leitura
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
buffer
[out]  Refer√™ncia para array do tipo uchar em que ser√£o lidos os dados. O tamanho da matriz
din√¢mica √© aumentado pelo n√∫mero de bytes lidos. O tamanho da matriz n√£o pode exceder
INT_MAX (2147483647).
buffer_maxlen
[in]  N√∫mero de bytes que devem ser lidos na matriz buffer[]. Os dados que n√£o se encaixam na
matriz permanecer√£o no soquete. Eles podem ser obtidos pela seguinte chamada SocketRead. O
valor buffer_maxlen n√£o pode exceder INT_MAX (2147483647).
timeout_ms
[in]  Tempo limite de leitura de dados em milissegundos. Se os dados n√£o puderem ser
recuperados durante esse tempo, as tentativas ser√£o conclu√≠das e a fun√ß√£o retornar√° -1.
<h3>Valor retornado</h3>
Se bem-sucedido, retorna o n√∫mero de bytes lidos, em caso de erro, retorna -1.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
<h3>Se</h3>
houver 
um 
erro 
ao 
ler 
os 
dados 
em 
_LastError 
√© 
registrado 
o 
erro 
5273
(ERR_NETSOCKET_IO_ERROR).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2430
</p>
<pre><code class="language-mql5">
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2431
</p>
<pre><code class="language-mql5">
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2432
</p>
<pre><code class="language-mql5">
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
</code></pre>
<p>
<h3>Veja tamb√©m</h3>
<h3>SocketTimeouts, MathSwap</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2433
<h3>SocketSend</h3>
Registra dados no soquete.
</p>
<pre><code class="language-mql5">
int¬† SocketSend(
   int           socket,               // soquete
   const uchar&amp;  buffer[],             // buffer para dados
   uint          buffer_len            // tamanho do buffer
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
buffer
[in]  Refer√™ncia para o array do tipo uchar com os dados que √© preciso enviar para o soquete.
buffer_len
[in]  Tamanho do array buffer.
<h3>Valor retornado</h3>
Se bem-sucedido, retorna o n√∫mero de bytes registrados no socket. Em caso de erro, retorna -1.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
<h3>Se houver um</h3>
erro 
ao 
registrar 
dados 
em 
_LastError 
√© 
registrado 
o 
erro 
5273
(ERR_NETSOCKET_IO_ERROR).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2434
</p>
<pre><code class="language-mql5">
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2435
</p>
<pre><code class="language-mql5">
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2436
</p>
<pre><code class="language-mql5">
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
</code></pre>
<p>
<h3>Veja tamb√©m</h3>
<h3>SocketTimeouts, MathSwap, StringToCharArray</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2437
<h3>SocketTlsHandshake</h3>
Inicia uma conex√£o TLS (SSL) segura com o host especificado usando o protocolo TLS Handshake.
Durante o Handshake, o cliente e o servidor concordam com os par√¢metros de conex√£o: a vers√£o do
protocolo usado e o m√©todo de criptografia de dados.
</p>
<pre><code class="language-mql5">
bool¬† SocketTlsHandshake(
   int           socket,               // soquete
   const string  host                  // endere√ßo do host
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
host
[in]  Endere√ßo do host com o qual √© estabelecida uma conex√£o segura.
<h3>Valor retornado</h3>
Retorna true em caso de sucesso, caso contr√°rio, false.
<h3>Coment√°rio:</h3>
Antes de uma conex√£o segura, o programa deve estabelecer uma conex√£o TCP normal ao host
usando SocketConnect.
Em caso de falha ao estabelecer uma conex√£o segura, em _LastError √© registrado o erro 5274
(ERR_NETSOCKET_HANDSHAKE_FAILED).
N√£o √© necess√°ria a chamada desta fun√ß√£o, se a conex√£o √© realizada para a porta 443. Essa √© a porta
TCP padr√£o usada para conex√µes TLS (SSL) seguras.
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           SocketTlsHandshake.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#define   SERVER    &quot;smtp.gmail.com&quot;
#define   PORT      587
//+------------------------------------------------------------------+
//| Mudan√ßa manual de uma conex√£o insegura para uma conex√£o segura   |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2438
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
bool TlsHandshake(int socket)
  {
//--- recebemos a sauda√ß√£o do servidor
   string rsp;
   if(!RecvString(socket,rsp))
      return(false);
//--- cumprimentamos o servidor
   if(!SendString(socket,&quot;EHLO my.domain.com\r\n&quot;))
      return(false);
//--- recebemos uma resposta do servidor com a lista de comandos suportados
   if(!RecvString(socket,rsp))
      return(false);
//--- imprimimos a sauda√ß√£o
   Print(&quot;SERVER: &quot;,rsp);
//--- informamos ao servidor que desejamos mudar de uma conex√£o insegura para uma segu
   if(!SendString(socket,&quot;STARTTLS\r\n&quot;))
      return(false);
//--- obtemos a resposta do servidores
   if(!RecvString(socket,rsp))
      return(false);
//--- noo exemplo, n√£o verificamos a resposta do servidor de que ele est√° pronto para 
//--- iniciamos uma conex√£o TLS (SSL) segura com o host especificado usando o protocol
   if(SocketTlsHandshake(socket,SERVER))
      return(true);
   Print(&quot;SocketTlsHandshake() failed. Error &quot;,GetLastError());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- criamos um soquete e obtemos seu identificador
   int socket=SocketCreate();
   if(socket==INVALID_HANDLE)
     {
      Print(&quot;SocketCreate() failed. Error &quot;,GetLastError());
      return;
     }
//--- contectamo-nos ao servidor SERVER na porta PORT
   if(!SocketConnect(socket,SERVER,PORT,10000))
     {
      Print(&quot;SocketConnect() failed. Error &quot;,GetLastError());
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2439
</p>
<pre><code class="language-mql5">
   else
     {
      //--- foi estabelecida uma conex√£o insegura
      PrintFormat(&quot;%s connection has been established to %s:%d&quot;,(PORT==443 ? &quot;A secure
      //--- mudamos para uma conex√£o segura
      if(PORT!=443 &amp;&amp; TlsHandshake(socket))
        {
         PrintFormat(&quot;Unsecured connection to %s:%d switched to secured&quot;,SERVER,PORT);
         //--- se a conex√£o estiver protegida por um certificado, imprimimos seus dado
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;TLS certificate:&quot;);
            Print(&quot;   Owner:      &quot;,subject);
            Print(&quot;   Issuer:     &quot;,issuer);
            Print(&quot;   Number:     &quot;,serial);
            Print(&quot;   Print:      &quot;,thumbprint);
            Print(&quot;   Expiration: &quot;,expiration);
           }
        }
     }
//--- fechamos o soquete ap√≥s us√°-lo
   SocketClose(socket);
   /*
¬†  Resultado:
   An unsecured connection has been established to smtp.gmail.com:587
   SERVER: 220 smtp.gmail.com ESMTP a640c23a62f3a-a9b1f298319sm82305866b.105 - gsmtp
   SERVER: 250-smtp.gmail.com at your service, [37.193.40.122]
   250-SIZE 35882577
   250-8BITMIME
   250-STARTTLS
   250-ENHANCEDSTATUSCODES
   250-PIPELINING
   250-CHUNKING
   250 SMTPUTF8
   SERVER: 220 2.0.0 Ready to start TLS
   SocketTlsHandshake(): A secure connection to smtp.gmail.com:587 is now established
   TLS certificate:
      Owner:  /CN=smtp.gmail.com
      Issuer:  /C=US/O=Google Trust Services/CN=WR2
      Number:     1f:f4:db:2a:5a:e6:dc:52:0a:4c:05:ce:81:cc:c3:f7
      Print: d6be8af229b5329cd3d4c2789c02aa94f89b421c
      Expiration: 2024.12.30 08:25:30
   */</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2440
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Enviamos uma string para o servidor                              |
//+------------------------------------------------------------------+
bool SendString(int socket,const string str)
  {
//--- convertemos a string em um array de caracteres
   uchar data[];
   int   size=StringToCharArray(str,data,0,str.Length(),CP_UTF8);
//--- enviamos os dados para o soquete
   ResetLastError();
   if(SocketSend(socket,data,size)==size)
      return(true);
//--- erro de envio de dados
   Print(&quot;Failed to send data to server. Error &quot;,GetLastError());
   return false;
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Obt√©m uma string do servidor¬†                                    |
//+------------------------------------------------------------------+
bool RecvString(int socket,string&amp; result,uint timeout_ms=1000)
  {
//--- aguardamos que os dados apare√ßam no soquete
   ulong wait_time_end=GetMicrosecondCount()+timeout_ms*1000;
   while(!SocketIsReadable(socket))
     {
      Sleep(10);
      //--- o tempo de espera dos dados expirou, retornamos NULL como resposta
      if(wait_time_end&lt;GetMicrosecondCount())
        {
         Print(&quot;ERROR: No response from server&quot;);
         return(false);
        }
     }
//--- lemos os dados do soquete
   uchar  data[128];
   uint   size=0;
   string resp=NULL;
   do
     {
      uchar b[1];
      int   n=SocketRead(socket,b,1,1000);
      if(n &lt; 0)
         break;
      if(n)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2441
</p>
<pre><code class="language-mql5">
        {
         data[size++]=b[0];
         if(size==data.Size())
           {
            resp += CharArrayToString(data,0,data.Size(),CP_UTF8);
            size = 0;
           }
        }
     }
   while(SocketIsReadable(socket));
//--- copiamos os dados lidos para a linha
   if(size)
      resp+=CharArrayToString(data,0,size,CP_UTF8);
//--- se a string estiver vazia, ocorrer√° um erro
   if(!resp.Length())
     {
      Print(&quot;ERROR: No response from server&quot;);
      return(false);
     }
//--- entregamos a string
   result=resp;
   return(true);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2442
<h3>SocketTlsCertificate</h3>
Obt√©m informa√ß√µes sobre o certificado usado para proteger uma conex√£o de rede.
</p>
<pre><code class="language-mql5">
bool¬† SocketTlsCertificate(
   int           socket,               // soquete
   string&amp;       subject,              // propriet√°rio do certificado
   string&amp;       issuer,               // emissor do certificado
   string&amp;       serial,               // n√∫mero de s√©rie do certificado
   string&amp;       thumbprint,           // impress√£o digital do certificado
   datetime&amp;     expiration            // data de expira√ß√£o do certificado
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
subject
[in]  Nome do propriet√°rio do certificado. Corresponde ao campo Subject.
issuer
[in]  Nome do emissor do certificado. Corresponde ao campo Issuer.
serial
[in]  N√∫mero de s√©rie do certificado. Corresponde ao campo SerialNumber.
thumbprint
[in]  Impress√£o digital do certificado. Corresponde ao hash SHA-1 do arquivo de certificado inteiro
(todos os campos, incluindo a assinatura do editor).
expiration
[in]  Data de expira√ß√£o do certificado no formato datetime.
<h3>Valor retornado</h3>
Retorna true em caso de sucesso, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
A solicita√ß√£o de dados do certificado s√≥ √© poss√≠vel ap√≥s estabelecer uma conex√£o segura usando
SocketTlsHandshake.
<h3>Ao</h3>
falhar 
a 
obten√ß√£o 
do 
certificado, 
em 
_LastError 
√© 
registrado 
o 
erro 
5275
(ERR_NETSOCKET_NO_CERTIFICATE).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2443
</p>
<pre><code class="language-mql5">
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2444
</p>
<pre><code class="language-mql5">
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2445
</p>
<pre><code class="language-mql5">
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2446
<h3>SocketTlsRead</h3>
L√™ dados de uma conex√£o TLS segura
</p>
<pre><code class="language-mql5">
int¬† SocketTlsRead(
   int           socket,               // soquete
   uchar&amp;        buffer[],             // buffer para ler dados do soquete
   uint          buffer_maxlen         // n√∫mero de bytes necess√°rio para leitura
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
buffer
[out]  Refer√™ncia para array do tipo uchar em que ser√£o lidos os dados. O tamanho da matriz
din√¢mica √© aumentado pelo n√∫mero de bytes lidos. O tamanho da matriz n√£o pode exceder
INT_MAX (2147483647).
buffer_maxlen
[in]  N√∫mero de bytes que devem ser lidos na matriz buffer[]. Os dados que n√£o se encaixam na
matriz permanecer√£o no soquete. Eles podem ser recebidos pela seguinte chamada
SocketTLSRead. O valor buffer_maxlen n√£o pode exceder INT_MAX (2147483647).
<h3>Valor retornado</h3>
Se bem-sucedido, retorna o n√∫mero de bytes lidos, em caso de erro, retorna -1.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
A fun√ß√£o √© executada at√© que receba a quantidade especificada de dados ou ocorra o tempo limite
(SocketTimeouts).
<h3>Se</h3>
houver 
um 
erro 
ao 
ler 
os 
dados 
em 
_LastError 
√© 
registrado 
o 
erro 
5273
(ERR_NETSOCKET_IO_ERROR).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketExample.mq5 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright   &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link        &quot;https://www.mql5.com&quot;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2447
</p>
<pre><code class="language-mql5">
#property version     &quot;1.00&quot;
#property description &quot;Para o exemplo funcionar, adicione Address √† lista de permitido
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =80;
bool         ExtTLS =false;
//+------------------------------------------------------------------+
//| Enviando comandos para o servidor                                |
//+------------------------------------------------------------------+
bool HTTPSend(int socket,string request)
  {
   char req[];
   int  len=StringToCharArray(request,req)-1;
   if(len&lt;0)
      return(false);
//--- se for usada uma conex√£o TLS segura pela porta 443
   if(ExtTLS)
      return(SocketTlsSend(socket,req,len)==len);
//--- se for usada uma conex√£o TCP normal
   return(SocketSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Lendo a resposta do servidor                                     |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout)
  {
   char   rsp[];
   string result;
   uint   timeout_check=GetTickCount()+timeout;
//--- l√™ dados do soquete enquanto eles existem, mas n√£o mais tempo do que o timeout
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         int rsp_len;
         //--- diferentes comandos de leitura dependendo de se a conex√£o √© segura ou n
         if(ExtTLS)
            rsp_len=SocketTlsRead(socket,rsp,len);
         else
            rsp_len=SocketRead(socket,rsp,len,timeout);
         //--- analisa a resposta
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprime apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2448
</p>
<pre><code class="language-mql5">
              {
               Print(&quot;Cabe√ßalho HTTP de resposta recebido:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
           }
        }
     }
   while(GetTickCount()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   int socket=SocketCreate();
//--- verifica o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver em ordem, conecte-se
      if(SocketConnect(socket,Address,Port,1000))
        {
         Print(&quot;Conectado a &quot;,Address,&quot;:&quot;,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, exibe seus dados
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;Certificado TLS:&quot;);
            Print(&quot;   Propriet√°rio:  &quot;,subject);
            Print(&quot;   Emissor:  &quot;,issuer);
            Print(&quot;   N√∫mero:     &quot;,serial);
            Print(&quot;   Impress√£o digital: &quot;,thumbprint);
            Print(&quot;   Expira√ß√£o: &quot;,expiration);
            ExtTLS=true;
           }
         //--- envia um pedido GET ao servidor
         if(HTTPSend(socket,&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r
           {
            Print(&quot;Solicita√ß√£o GET enviada&quot;);
            //--- leia a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Falha ao obter resposta, erro &quot;,GetLastError());
           }
         else
            Print(&quot;Falha ao enviar solicita√ß√£o GET, erro &quot;,GetLastError());
        }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2449
</p>
<pre><code class="language-mql5">
      else
        {
         Print(&quot;Falhou conex√£o a &quot;,Address,&quot;:&quot;,Port,&quot;, erro &quot;,GetLastError());
        }
      //--- fecha o soquete ap√≥s ser usado
      SocketClose(socket);
     }
   else
      Print(&quot;N√£o foi poss√≠vel criar o soquete, erro &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
</code></pre>
<p>
<h3>Veja tamb√©m</h3>
<h3>SocketTimeouts, MathSwap</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2450
<h3>SocketTlsReadAvailable</h3>
L√™ todos os dados dispon√≠veis a partir de uma conex√£o TLS segura.
</p>
<pre><code class="language-mql5">
int¬† SocketTlsReadAvailable(
   int           socket,               // soquete
   uchar&amp;        buffer[],             // buffer para ler dados do soquete
   const uint    buffer_maxlen         // n√∫mero de bytes necess√°rio para leitura
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
buffer
[out]  Refer√™ncia para array do tipo uchar em que ser√£o lidos os dados. O tamanho da matriz
din√¢mica √© aumentado pelo n√∫mero de bytes lidos. O tamanho da matriz n√£o pode exceder
INT_MAX (2147483647).
buffer_maxlen
[in]  N√∫mero de bytes que devem ser lidos no array buffer[]. Os dados que n√£o se encaixam na
matriz permanecer√£o no soquete. Eles estar√£o dispon√≠veis chamando SocketTlsReadAvailable
ou¬†SocketTlsRead. O valor Buffer_maxlen n√£o pode exceder INT_MAX (2147483647).
<h3>Valor retornado</h3>
Se bem-sucedido, retorna o n√∫mero de bytes lidos, em caso de erro, retorna -1.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
<h3>Se</h3>
houver 
um 
erro 
ao 
ler 
os 
dados 
em 
_LastError 
√© 
registrado 
o 
erro 
5273
(ERR_NETSOCKET_IO_ERROR).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                       SocketTlsReadAvailable.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#property script_show_inputs</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2451
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Par√¢metros de entrada do script                                  |
//+------------------------------------------------------------------+
input string InpMethod =&quot;GET&quot;;            // Method (HEAD,GET)
input string InpServer =&quot;www.google.com&quot;; // Server
input uint   InpPort   =443;              // Port
input uint   InpTimeout=5000;             // Timeouts
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
   Print(&quot;Server: &quot;,InpServer);
   Print(&quot;Port: &quot;,InpPort);
//--- criamos um soquete e obtemos seu identificador
   const int socket=SocketCreate();
   if(socket==INVALID_HANDLE)
     {
      Print(&quot;SocketCreate() failed. Error &quot;,GetLastError());
      return;
     }
//--- definimos tempos limite para receber e enviar dados para o objeto do sistema de 
   if(!SocketTimeouts(socket,InpTimeout,InpTimeout))
     {
      PrintFormat(&quot;SocketTimeouts(%u, %u) failed. Error %d&quot;,InpTimeout,InpTimeout,GetL
      SocketClose(socket);
      return;
     }
//--- contectamo-nos ao servidor Server na porta Port
   if(!SocketConnect(socket,InpServer,InpPort,InpTimeout))
     {
      PrintFormat(&quot;SocketConnect(&#x27;%s&#x27;, %u, %u) failed. Error %d&quot;,InpServer,InpPort,Inp
      SocketClose(socket);
      return;
     }
//--- obtemos dados sobre o certificado usado para proteger a conex√£o de rede
   string   subject,issuer,serial,thumbprint;
   datetime expiration;
   if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
     {
      Print(&quot;TLS certificate:&quot;);
      Print(&quot;   Owner:      &quot;,subject);
      Print(&quot;   Issuer:     &quot;,issuer);
      Print(&quot;   Number:     &quot;,serial);
      Print(&quot;   Print:      &quot;,thumbprint);
      Print(&quot;   Expiration: &quot;,expiration);
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2452
</p>
<pre><code class="language-mql5">
   else
     {
      //--- o servidor n√£o fornecer um certificado, informamos que a conex√£o n√£o √© seg
      Print(&quot;The connection is not secured by a certificate&quot;);
      SocketClose(socket);
      return;
     }
//--- enviamos a consulta ao servidor
   string request=StringFormat(&quot;%s / HTTP/1.1\r\nHost: %s\r\nUser-Agent: MetaTrader 5\
   if(HTTPSendTLS(socket,request))
     {
      //--- consulta enviada, resposta recebida
      Print(&quot;\nRequest sent. Starting page loading...&quot;);
      uchar response[]; // todos os dados recebidos (cabe√ßalho e corpo do documento)
      if(!HTTPRecvTLS(socket,response,InpTimeout))
        {
         Print(&quot;There were errors while reading the page&quot;);
         SocketClose(socket);
         return;
        }
      //--- informamos o n√∫mero de bytes de dados recebidos
      PrintFormat(&quot;%u bytes received&quot;,response.Size());
      //--- imprimimos somente o cabe√ßalho da p√°gina resultante
      string result    =CharArrayToString(response,0,WHOLE_ARRAY,CP_UTF8);
      int    header_end=StringFind(result,&quot;\r\n\r\n&quot;);
      if(header_end&gt;0)
        {
         Print(&quot;\nHTTP answer header received:&quot;);
         Print(StringSubstr(result,0,header_end));
        }
     }
//--- fechamos o soquete ap√≥s us√°-lo
   SocketClose(socket);
   /*
¬†  Resultado:
   Server: www.google.com
   Port: 443
   TLS certificate:
      Owner: /CN=www.google.com
      Issuer: /C=US/O=Google Trust Services/CN=WR2
      Number: 0d:43:b1:4a:bb:9c:15:96:10:e1:3d:55:23:9f:25:4e
      Print: 89167618e5017f813aff981c88ce422dc1016bdf
      Expiration: 2024.12.30 08:26:35
   Request sent. Starting page loading...
   HTTPRecvTLS: Document received within 27 attempts</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2453
</p>
<pre><code class="language-mql5">
   25185 bytes received
   HTTP answer header received:
   HTTP/1.1 200 OK
   Date: Fri, 25 Oct 2024 17:12:42 GMT
   Expires: -1
   Cache-Control: private, max-age=0
   Content-Type: text/html; charset=ISO-8859-1
   Content-Security-Policy-Report-Only: object-src &#x27;none&#x27;;base-uri &#x27;self&#x27;;script-src &#x27;
   Accept-CH: Sec-CH-Prefers-Color-Scheme
   P3P: CP=&quot;This is not a P3P policy! See g.co/p3phelp for more info.&quot;
   Server: gws
   X-XSS-Protection: 0
   X-Frame-Options: SAMEORIGIN
   Set-Cookie: AEC=AVYB7coyYMCdweTDTaWeGYzmRnxzKGqsOEosH_VkbCn8xhWkFz6v0kxQFw; expires
   Set-Cookie: NID=518=J02X02Ff4v_9sMcNoUz-1SolmuG08E26Gs438ik0J_SOJUMy7of-P-qup-LaNSW
   Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000
   Accept-Ranges: none
   Vary: Accept-Encoding
   Transfer-Encoding: chunked
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Enviamos uma solicita√ß√£o HTTP por meio de uma conex√£o segura¬†    |
//+------------------------------------------------------------------+
bool HTTPSendTLS(int socket,const string request)
  {
//--- convertemos a string em um array de caracteres, descartando o zero final
   char req[];
   int  len=StringToCharArray(request,req,0,WHOLE_ARRAY,CP_UTF8)-1;
   if(len&lt;0)
      return false;
   return(SocketTlsSend(socket,req,len)==len);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Recebe uma p√°gina da Web por meio de uma conex√£o segura¬†    |
//+------------------------------------------------------------------+
bool HTTPRecvTLS(int socket,uchar &amp;response[],const uint timeout_ms)
  {
//--- lemos os dados dispon√≠veis de uma conex√£o protegida por TLS antes que o tempo de
   ulong timeout_check=GetTickCount64()+timeout_ms;
   uchar block[1024];   // buffer de bloco para leitura de dados de um soquete
   uint  attempt=0;     // n√∫mero solicitado de blocos de dados
   int   err    =0;     // c√≥digo de erro
   ResetLastError();</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2454
</p>
<pre><code class="language-mql5">
   do
     {
      //--- lemos em blocos de no m√°ximo 1024 bytes
      int len=SocketTlsReadAvailable(socket,block,1024);
      if(len&gt;0)
        {
         attempt++;
         //--- juntamos os blocos de dados resultantes
         ArrayCopy(response,block,response.Size());
         //--- aqui analisamos os dados recebidos, determinamos o cabe√ßalho, o corpo d
         //...
         //...
         //...
         timeout_check=GetTickCount64()+timeout_ms;
        }
      else
         Sleep(10);
      err=GetLastError();
     }
   while(!IsStopped() &amp;&amp; GetTickCount()&lt;timeout_check &amp;&amp; !err);
//--- Houve algum erro na leitura?
   if(err)
     {
      Print(&quot;Error &quot;,err);
      return(false);
     }
   PrintFormat(&quot;%s: Document received within %d attempts&quot;,__FUNCTION__,attempt);
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SocketTimeouts, MathSwap</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2455
<h3>SocketTlsSend</h3>
Envia dados por meio de uma conex√£o TLS segura.
</p>
<pre><code class="language-mql5">
int¬† SocketTlsSend(
   int           socket,               // soquete
   const uchar&amp;  buffer[],             // buffer para dados
   uint          buffer_len            // tamanho do buffer
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
socket
[in]  Identificador do soquete retornado pela fun√ß√£o SocketCreate. Ao passar um identificador
inv√°lido para _LastError √© registrado o erro 5270 (ERR_NETSOCKET_INVALIDHANDLE).
buffer
[in]  Refer√™ncia para o array do tipo uchar com os dados que √© preciso enviar.
buffer_len
[in]  Tamanho do array buffer.
<h3>Valor retornado</h3>
Se bem-sucedido, retorna o n√∫mero de bytes registrados no socket. Em caso de erro, retorna -1.
<h3>Observa√ß√£o</h3>
Se ocorrer um erro durante a execu√ß√£o desta fun√ß√£o no soquete do sistema, a conex√£o estabelecida
Socketconnect ser√° interrompida.
<h3>Se houver um</h3>
erro 
ao 
registrar 
dados 
em 
_LastError 
√© 
registrado 
o 
erro 
5273
(ERR_NETSOCKET_IO_ERROR).
A fun√ß√£o s√≥ pode ser chamada por EAs e scripts, pois eles trabalham em seu pr√≥prio fluxo de
execu√ß√£o. Quando chamado do indicador GetLastError() retorna o erro 4014 ‚Äì &quot;Fun√ß√£o do sistema
n√£o permitida para chamada&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                SocketTlsSend.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#property description &quot;Add Address to the list of allowed ones in the terminal setting
#property script_show_inputs
input string Address=&quot;www.mql5.com&quot;;
input int    Port   =443;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2456
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
   int socket=SocketCreate();
//--- verificamos o identificador
   if(socket!=INVALID_HANDLE)
     {
      //--- se tudo estiver bem, podemos nos conectar.
      if(SocketConnect(socket,Address,Port,1000))
        {
         PrintFormat(&quot;Established connection to %s:%d&quot;,Address,Port);
         string   subject,issuer,serial,thumbprint;
         datetime expiration;
         //--- se a conex√£o estiver protegida por um certificado, imprimimos seus dado
         if(SocketTlsCertificate(socket,subject,issuer,serial,thumbprint,expiration))
           {
            Print(&quot;TLS certificate:&quot;);
            Print(&quot;   Owner:      &quot;,subject);
            Print(&quot;   Issuer:     &quot;,issuer);
            Print(&quot;   Number:     &quot;,serial);
            Print(&quot;   Print:      &quot;,thumbprint);
            Print(&quot;   Expiration: &quot;,expiration);
           }
         //--- enviamos uma solicita√ß√£o GET ao servidor
         string request=&quot;GET / HTTP/1.1\r\nHost: www.mql5.com\r\nUser-Agent: MT5\r\n\r
         char   req[];
         int    len=StringToCharArray(request,req)-1;
         if(len&lt;0)
           {
            Print(&quot;StringToCharArray() failed. Error &quot;, GetLastError());
            SocketClose(socket);
            return;
           }
//--- se for usada uma conex√£o protegida por TLS via porta 443
         if(SocketTlsSend(socket,req,len)==len)
           {
            Print(&quot;GET request sent&quot;);
            //--- lemos a resposta
            if(!HTTPRecv(socket,1000))
               Print(&quot;Failed to get a response, error &quot;,GetLastError());
           }
         else
            Print(&quot;Failed to send GET request, error &quot;,GetLastError());
        }
      else</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2457
</p>
<pre><code class="language-mql5">
        {
         PrintFormat(&quot;Connection to %s:%d failed, error %d&quot;,Address,Port,GetLastError
        }
      //--- fechamos o soquete ap√≥s us√°-lo
      SocketClose(socket);
     }
   else
      Print(&quot;Failed to create a socket, error &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Leitura da resposta do servidor                                  |
//+------------------------------------------------------------------+
bool HTTPRecv(int socket,uint timeout_ms)
  {
//--- lemos dados do soquete enquanto eles existirem, mas n√£o mais do que o tempo limi
   char   rsp[];
   string result;
   ulong  timeout_check=GetTickCount64()+timeout_ms;
   do
     {
      uint len=SocketIsReadable(socket);
      if(len)
        {
         //--- lemos e analisamos os dados de uma conex√£o TLS segura
         int rsp_len=SocketTlsRead(socket,rsp,len);
         if(rsp_len&gt;0)
           {
            result+=CharArrayToString(rsp,0,rsp_len);
            //--- imprimimos apenas o cabe√ßalho da resposta
            int header_end=StringFind(result,&quot;\r\n\r\n&quot;);
            if(header_end&gt;0)
              {
               Print(&quot;HTTP answer header received:&quot;);
               Print(StringSubstr(result,0,header_end));
               return(true);
              }
            //--- atualizamos o tempo de expira√ß√£o do tempo limite de leitura
            timeout_check=GetTickCount64()+timeout_ms;
           }
        }
     }
   while(GetTickCount64()&lt;timeout_check &amp;&amp; !IsStopped());
   return(false);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2458
<h3>Veja tamb√©m</h3>
<h3>SocketTimeouts, MathSwap, StringToCharArray</h3></p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2459
<h3>WebRequest</h3>
A fun√ß√£o envia uma solicita√ß√£o HTTP para um servidor especificado. A fun√ß√£o possui duas vers√µes:
1. Enviando solicita√ß√µes simples do tipo &quot;key = value&quot; usando o cabe√ßalho Content-Type:
application/x-www-form-urlencoded.
</p>
<pre><code class="language-mql5">
int¬† WebRequest(
   const string¬†     method,           // m√©todo HTTP 
   const string ¬†    url,              // URL
   const string ¬†    cookie,           // cookie
   const string ¬†    referer,          // referer
   int               timeout,   ¬†      // tempo esgotado
   const char ¬†      &amp;data[],          // A matriz do corpo da mensagem HTTP
   int               data_size,      ¬† // tamanho do array data[] em bytes
   char              &amp;result[],        // Uma matriz contendo dados de resposta do ser
   string            &amp;result_headers   // cabe√ßalhos de resposta do servidor
   );
</code></pre>
<p>
2. Enviando uma solicita√ß√£o de qualquer tipo especificando o conjunto personalizado de cabe√ßalhos
para uma intera√ß√£o mais flex√≠vel com v√°rios servi√ßos da Web.
</p>
<pre><code class="language-mql5">
int¬† WebRequest(
   const string¬†     method,           // m√©todo HTTP
   const string ¬†    url,              // URL
   const string ¬†    headers,          // cabe√ßalho 
   int               timeout,   ¬†      // tempo esgotado
   const char ¬†      &amp;data[],          // A matriz do corpo da mensagem HTTP
   char              &amp;result[],        // Uma matriz contendo dados de resposta do ser
   string            &amp;result_headers   // cabe√ßalhos de resposta do servidor
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
m√©todo
[in]  m√©todo HTTP.
url
[in]  URL.
cabe√ßalho
[in]  Cabe√ßalhos de solicita√ß√£o do tipo &quot;key: valor&quot;, separados por uma quebra de linha &quot;\r\n&quot;.
cookie
[in]  Valor do cookie.
referer
[in]  Valor do cabe√ßalho Referer do pedido HTTP.
timeout
[in]  Tempo limite em milissegundos.</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2460
data[]
[in]  Matriz de dados do corpo da mensagem HTTP.
data_size
[in]  Tamanho do array data[].
result[]
[out]  Um array contendo dados de resposta do servidor.
result_headers
[out] Cabe√ßalhos de resposta do servidor.
<h3>Valor retornado</h3>
C√≥digo de resposta do servidor HTTP ou -1 para um erro.
<h3>Nota</h3>
Para usar a fun√ß√£o WebRequest(), adicione os endere√ßos dos servidores necess√°rios na lista de URLs
permitidos na guia &quot;Expert Advisors&quot; da janela &quot;Options&quot;. A porta do servidor √© automaticamente
selecionada com base no protocolo especificado - 80 para &quot;http://&quot; e 443 para &quot;https://&quot;.
A fun√ß√£o WebRequest() √© s√≠ncrona, o que significa que interrompe a execu√ß√£o do programa e
aguarda a resposta do servidor solicitado. Uma vez que os atrasos na recep√ß√£o de uma resposta
podem ser grandes, a fun√ß√£o n√£o est√° dispon√≠vel para chamadas a partir dos indicadores, porque os
indicadores s√£o executados em uma linha comum compartilhada por todos os indicadores e gr√°ficos
em um s√≠mbolo. O atraso de desempenho do indicador em um dos gr√°ficos de um s√≠mbolo pode
interromper a atualiza√ß√£o de todos os gr√°ficos do mesmo s√≠mbolo.
A fun√ß√£o pode ser chamada somente de Expert Advisors e scripts, como eles executam em seus
pr√≥prios t√≥picos de execu√ß√£o. Se voc√™ tentar chamar a fun√ß√£o de um indicador, GetLastError()
retornar√° o erro 4014 ‚Äì &quot;Fun√ß√£o n√£o √© permitida&quot;.
O WebRequest() n√£o pode ser executada no Testador de Estrat√©gia.
Um exemplo de usar a primeira vers√£o da fun√ß√£o WebRequest():
</p>
<pre><code class="language-mql5">
void OnStart()
  {
   string cookie=NULL,headers;
   char   post[],result[];
   string url=&quot;https://finance.yahoo.com&quot;;
//--- para trabalhar com o servidor √© necess√°rio adicionar a URL &quot;https://finance.yaho
//--- na lista de URLs permitidas (menu Principal-&gt;Ferramentas-&gt;Op√ß√µes, guia &quot;Experts&quot;
//--- redefinimos o c√≥digo do √∫ltimo erro
   ResetLastError();
//--- download da p√°gina html do Yahoo Finance
   int res=WebRequest(&quot;GET&quot;,url,cookie,NULL,500,post,0,result,headers);
   if(res==-1)
     {
      Print(&quot;Erro no WebRequest. C√≥digo de erro =&quot;,GetLastError());
      //--- √© poss√≠vel que a URL n√£o esteja na lista, exibimos uma mensagem sobre a ne
      MessageBox(&quot;√â necess√°rio adicionar um endere√ßo &#x27;&quot;+url+&quot;&#x27; √† lista de URL permitid</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2461
</p>
<pre><code class="language-mql5">
     }
   else
     {
      if(res==200)
        {
         //--- download bem-sucedido
         PrintFormat(&quot;O arquivo foi baixado com sucesso, tamanho %d bytes.&quot;,ArraySize
         //PrintFormat(&quot;Cabe√ßalhos do servidor: %s&quot;,headers);
         //--- salvamos os dados em um arquivo
         int filehandle=FileOpen(&quot;url.htm&quot;,FILE_WRITE|FILE_BIN);
         if(filehandle!=INVALID_HANDLE)
           {
            //--- armazenamos o conte√∫do do array result[] no arquivo
            FileWriteArray(filehandle,result,0,ArraySize(result));
            //--- fechamos o arquivo
            FileClose(filehandle);
           }
         else
            Print(&quot;Erro em FileOpen. C√≥digo de erro =&quot;,GetLastError());
        }
      else
         PrintFormat(&quot;Erro de download &#x27;%s&#x27;, c√≥digo %d&quot;,url,res);
     }
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2462
<h3>SendFTP</h3>
Envia um arquivo para o endere√ßo especificado na janela de configura√ß√µes da guia &quot;FTP&quot;.
</p>
<pre><code class="language-mql5">
bool¬† SendFTP(
   string¬† filename,¬†         // nome do arquivo enviado
   string¬† ftp_path=NULL¬†     // cat√°logo FTP
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
filename
[in]   Nome do arquivo enviado.
ftp_path=NULL
[in]   Cat√°logo FTP. Se um diret√≥rio n√£o for especificado, ser√° utilizado o diret√≥rio descrito nas
configura√ß√µes.
<h3>Valor retornado</h3>
Em caso de falha, retorna false.
<h3>Observa√ß√£o</h3>
O arquivo enviado deve estar localizado na pasta terminal_directory\MQL5\files ou em suas
subpastas. O envio n√£o ocorre se o endere√ßo FTP e/ou a senha de acesso n√£o estiverem
especificados nas configura√ß√µes. 
SendFTP() function does not work in the Strategy Tester.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                      SendFTP.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#define   FILENAME  &quot;SomeFile.bin&quot;
#define   PATH      NULL
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- verificamos se √© permitido enviar arquivos para o endere√ßo FTP no terminal
   if(!TerminalInfoInteger(TERMINAL_FTP_ENABLED))
     {
      Print(&quot;Error. The client terminal does not have permission to send messages to t</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2463
</p>
<pre><code class="language-mql5">
      return;
     }
//--- enviamos o arquivo
   ResetLastError();
   if(!SendFTP(FILENAME, PATH))
      Print(&quot;SendFTP() failed. Error &quot;,GetLastError());
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2464
<h3>SendMail</h3>
Envia um email para endere√ßo especificado na janela de configura√ß√µes da guia &quot;Email&quot;.
</p>
<pre><code class="language-mql5">
bool¬† SendMail(
   string¬† subject,¬†      // assunto
   string¬† some_text¬†     // texto do e-mail
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
subject
[in]  Assunto do email.
some_text
[in]  Corpo do email.
<h3>Valor retornado</h3>
true ‚Äì se um email √© colocado na fila de envio, caso contr√°rio, false.
<h3>Observa√ß√£o</h3>
O envio de e-mails pode ser proibido nas configura√ß√µes, portanto o respectivo endere√ßo pode ser
omitido. Para obter informa√ß√µes sobre o erro, chamamos GetLastError().
SendMail() function does not work in the Strategy Tester.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                     SendMail.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#define   SUBJECT   &quot;Test SendMail&quot;
#define   TEXT      &quot;Text for SendMail() function&quot;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//--- verificamos se √© permitido enviar e-mails no terminal
   if(!TerminalInfoInteger(TERMINAL_EMAIL_ENABLED))
     {
      Print(&quot;Error. The client terminal does not have permission to send email message
      return;
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2465
</p>
<pre><code class="language-mql5">
//--- enviamos o e-mail
   ResetLastError();
   if(!SendMail(SUBJECT, TEXT))
      Print(&quot;SendMail() failed. Error &quot;,GetLastError());
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2466
<h3>SendNotification</h3>
Envia notifica√ß√µes push para terminais m√≥veis, cujo MetaQuotes ID est√£o especificados na guia
&quot;Notifica√ß√µes&quot;.
</p>
<pre><code class="language-mql5">
bool¬† SendNotification(
   string¬† text¬†         // Texto da notifica√ß√£o
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
text
[in]  Texto da notifica√ß√£o. O comprimento da mensagem n√£o deve exceder 255 caracteres.
<h3>Valor retornado</h3>
true se a notifica√ß√£o foi enviada com sucesso do terminal; em caso de falha, retorna false. Ap√≥s a
falha de envio de notifica√ß√£o durante a verifica√ß√£o, GetLastError () pode retornar um dos seguintes
erros:
¬∑ 4515 ‚Äì ERR_NOTIFICATION_SEND_FAILED,
¬∑ 4516 ‚Äì ERR_NOTIFICATION_WRONG_PARAMETER,
¬∑ 4517 ‚Äì ERR_NOTIFICATION_WRONG_SETTINGS,
¬∑ 4518 ‚Äì ERR_NOTIFICATION_TOO_FREQUENT.
<h3>Observa√ß√£o</h3>
Est√£o definidas restri√ß√µes rigorosas de uso para a fun√ß√£o SendNotification(): n√£o mais que duas
chamadas por segundo e n√£o mais que dez chamadas por minuto. O monitoramento da frequ√™ncia
de uso √© din√¢mico. A fun√ß√£o pode ser desabilitada em caso de viola√ß√£o da restri√ß√£o.
SendNotification() function does not work in the Strategy Tester.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                             SendNotification.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com
#property version     &quot;1.00&quot;
#define   MESSAGE   &quot;Test Message&quot;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart(void)
  {
//-- verificamos se √© permitido enviar notifica√ß√µes no terminal
   if(!TerminalInfoInteger(TERMINAL_NOTIFICATIONS_ENABLED))
     {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de rede</h3>
¬© 2000-2025, MetaQuotes Ltd.
2467
</p>
<pre><code class="language-mql5">
      Print(&quot;Error. The client terminal does not have permission to send notifications
      return;
     }
//--- enviamos a notifica√ß√£o
   ResetLastError();
   if(!SendNotification(MESSAGE))
      Print(&quot;SendNotification() failed. Error &quot;,GetLastError());
</code></pre>
<p>
  }
</p>
        </article>
        
        <footer>
            <p>Documenta√ß√£o MQL5 - Fonte: MetaQuotes Ltd.</p>
        </footer>
    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
        
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }
        
        function filterNav() {
            const filter = document.getElementById('search').value.toLowerCase();
            const items = document.querySelectorAll('.nav-list li');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? '' : 'none';
            });
        }
    </script>
</body>
</html>