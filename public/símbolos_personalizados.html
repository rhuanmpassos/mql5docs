<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√≠mbolos personalizados - MQL5 Docs</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <h1>MQL5 Docs</h1>
            <p>Documenta√ß√£o Completa</p>
        </div>
        <div class="search-box">
            <input type="text" id="search" placeholder="Buscar..." onkeyup="filterNav()">
        </div>
        <ul class="nav-list" id="nav-list">
            <li class=""><a href="index.html">üìö √çndice</a></li>
            <li class=""><a href="introducao.html">Introducao</a></li>
<li class=""><a href="refer√™ncia_mql5.html">Refer√™ncia MQL5</a></li>
<li class=""><a href="elementos_b√°sicos_da_linguagem.html">Elementos B√°sicos da Linguagem</a></li>
<li class=""><a href="constantes,_enumeradores_e_estruturas.html">Constantes, Enumeradores e Estruturas</a></li>
<li class=""><a href="programas_mql5.html">Programas MQL5</a></li>
<li class=""><a href="vari√°veis_predefinidas.html">Vari√°veis Predefinidas</a></li>
<li class=""><a href="fun√ß√µes_comuns.html">Fun√ß√µes Comuns</a></li>
<li class=""><a href="fun√ß√µes_para_array.html">Fun√ß√µes para Array</a></li>
<li class=""><a href="m√©todos_matriciais_e_vetoriais.html">M√©todos matriciais e vetoriais</a></li>
<li class=""><a href="fun√ß√µes_de_convers√£o.html">Fun√ß√µes de Convers√£o</a></li>
<li class=""><a href="fun√ß√µes_matem√°ticas.html">Fun√ß√µes Matem√°ticas</a></li>
<li class=""><a href="fun√ß√µes_de_string.html">Fun√ß√µes de String</a></li>
<li class=""><a href="data_e_hora.html">Data e Hora</a></li>
<li class=""><a href="informa√ß√µes_de_conta.html">Informa√ß√µes de Conta</a></li>
<li class=""><a href="verificando_estado.html">Verificando Estado</a></li>
<li class=""><a href="manipula√ß√£o_de_eventos.html">Manipula√ß√£o de eventos</a></li>
<li class=""><a href="informa√ß√µes_de_mercado.html">Informa√ß√µes de Mercado</a></li>
<li class=""><a href="calend√°rio_econ√¥mico.html">Calend√°rio econ√¥mico</a></li>
<li class=""><a href="s√©ries_temporais_e_acesso_a_indicadores.html">S√©ries Temporais e Acesso a Indicadores</a></li>
<li class="active"><a href="s√≠mbolos_personalizados.html">S√≠mbolos personalizados</a></li>
<li class=""><a href="opera√ß√µes_de_gr√°ficos.html">Opera√ß√µes de Gr√°ficos</a></li>
<li class=""><a href="fun√ß√µes_de_negocia√ß√£o.html">Fun√ß√µes de Negocia√ß√£o</a></li>
<li class=""><a href="gerenciamento_de_sinais.html">Gerenciamento de sinais</a></li>
<li class=""><a href="fun√ß√µes_de_rede.html">Fun√ß√µes de rede</a></li>
<li class=""><a href="vari√°veis_globais_do_terminal.html">Vari√°veis Globais do Terminal</a></li>
<li class=""><a href="fun√ß√µes_de_arquivo.html">Fun√ß√µes de Arquivo</a></li>
<li class=""><a href="indicadores_customizados.html">Indicadores Customizados</a></li>
<li class=""><a href="fun√ß√µes_de_objeto.html">Fun√ß√µes de Objeto</a></li>
<li class=""><a href="indicadores_t√©cnicos.html">Indicadores T√©cnicos</a></li>
<li class=""><a href="trabalhando_com_resultados_de_otimiza√ß√£o.html">Trabalhando com Resultados de Otimiza√ß√£o</a></li>
<li class=""><a href="trabalhando_com_eventos.html">Trabalhando com Eventos</a></li>
<li class=""><a href="trabalhando_com_opencl.html">Trabalhando com OpenCL</a></li>
<li class=""><a href="trabalhar_com_bancos_de_dados.html">Trabalhar com bancos de dados</a></li>
<li class=""><a href="trabalho_com_directx.html">Trabalho com DirectX</a></li>
<li class=""><a href="metatrader_para_python.html">MetaTrader para Python</a></li>
<li class=""><a href="modelos_onnx.html">Modelos ONNX</a></li>
<li class=""><a href="biblioteca_padr√£o.html">Biblioteca Padr√£o</a></li>
<li class=""><a href="migrando_do_mql4.html">Migrando do MQL4</a></li>
<li class=""><a href="lista_de_fun√ß√µes_mql5.html">Lista de Fun√ß√µes MQL5</a></li>
<li class=""><a href="lista_de_constantes_mql5.html">Lista de Constantes MQL5</a></li>

        </ul>
    </nav>
    
    <main class="content">
        <header>
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <h1>S√≠mbolos personalizados</h1>
        </header>
        
        <article>
            <p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2140
<h3>S√≠mbolos personalizados</h3>
Fun√ß√µes para criar e editar as propriedades dos s√≠mbolos personalizados.
Ao conectar o terminal a um determinado servidor de negocia√ß√£o, o usu√°rio pode trabalhar com os
TimeSeries dos instrumentos financeiros que fornece a corretora. A lista de s√≠mbolos - mostrada na
janela da Observa√ß√£o do mercado - exibe os instrumentos financeiros dispon√≠veis, e um grupo
separado de fun√ß√µes permite obter informa√ß√µes sobre as propriedades do s√≠mbolo, sess√µes de
negocia√ß√£o e atualiza√ß√µes do livro de ofertas.
O grupo de fun√ß√µes nesta se√ß√£o permite criar seus pr√≥prios s√≠mbolos personalizados. Para fazer isso, √©
poss√≠vel criar os s√≠mbolos existentes do servidor de negocia√ß√£o, arquivos de texto ou hist√≥ricos de
dados externos.
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>CustomSymbolCreate</h3>
Cria um s√≠mbolo personalizado com o nome especificado no
grupo definido
<h3>CustomSymbolDelete</h3>
Remove o s√≠mbolo personalizado com o nome especificado
<h3>CustomSymbolSetInteger</h3>
Define o valor do tipo inteiro para o s√≠mbolo personalizado
<h3>CustomSymbolSetDouble</h3>
Define o valor do tipo real para o s√≠mbolo personalizado
<h3>CustomSymbolSetString</h3>
Define o valor do tipo cadeia de caracteres para o s√≠mbolo
personalizado
<h3>CustomSymbolSetMarginRate</h3>
Define o coeficiente de cobran√ßa da margem - dependendo do
tipo e dire√ß√£o da ordem - para o s√≠mbolo personalizado
<h3>CustomSymbolSetSessionQuote</h3>
Define a hora de in√≠cio e fim da sess√£o de cota√ß√£o especificada
para o s√≠mbolo especificado e dia da semana
<h3>CustomSymbolSetSessionTrade</h3>
Define a hora de in√≠cio e fim da sess√£o de negocia√ß√£o
especificada para o s√≠mbolo especificado e dia da semana
<h3>CustomRatesDelete</h3>
Exclui todas as barras no hist√≥rico de pre√ßo do instrumento
personalizado, no intervalo de tempo selecionado
<h3>CustomRatesReplace</h3>
<h3>Substitui</h3>
todo 
o 
hist√≥rico 
de 
pre√ßo 
do 
instrumento
personalizado pelos dados na matriz do tipo MqlRates, no
intervalo de tempo definido
<h3>CustomRatesUpdate</h3>
Adiciona ao hist√≥rico do instrumento personalizado as barras
que faltam e substitui os dados existentes na matriz do tipo
<h3>MqlRates</h3>
<h3>CustomTicksAdd</h3>
Adds data from an array of the MqlTick type to the price
history of a custom symbol. The custom symbol must be
selected in the Market Watch window. 
<h3>CustomTicksDelete</h3>
Exclui todos os ticks no hist√≥rico de pre√ßo do instrumento
personalizado, no intervalo de tempo selecionado</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2141
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>CustomTicksReplace</h3>
<h3>Substitui</h3>
todo 
o 
hist√≥rico 
de 
pre√ßo 
do 
instrumento
personalizado pelos dados na matriz do tipo MqlTick, no
intervalo de tempo definido
<h3>CustomBookAdd</h3>
Envia o estado do livro de ofertas 
do 
instrumento
personalizado</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2142
<h3>CustomSymbolCreate</h3>
Cria um s√≠mbolo personalizado com o nome especificado no grupo definido.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolCreate(
   const string     symbol_name,         // nome do s√≠mbolo personalizado
   const string¬†    symbol_path=&quot;&quot;,      // nome do grupo em que ser√° criado o s√≠mbolo
   const string¬†    symbol_origin=NULL¬†  // nome do s√≠mbolo com base no qual ser√° cria
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado. Ele n√£o deve conter grupos ou sub-grupos em que se
encontre o s√≠mbolo.
symbol_path=&quot;&quot;
[in]  Nome do grupo em que √© criado o s√≠mbolo.
symbol_origin=NULL
[in]  Nome do s√≠mbolo a partir do qual ser√£o copiadas as propriedades do s√≠mbolo personalizado
gerado. Depois de criar um s√≠mbolo personalizado, voc√™ pode alterar qualquer propriedade para o
valor desejado com as fun√ß√µes correspondentes.
<h3>Valor retornado</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Todos os s√≠mbolos personalizados s√£o gerados na se√ß√£o especial Custom. Se o nome de grupo n√£o
</p>
<pre><code class="language-mql5">
for especificado (o par√¢metro symbol_path na fun√ß√£o CustomSymbolCreate cont√©m uma string vazia
</code></pre>
<p>
ou NULL), o s√≠mbolo personalizado ser√° criado na raiz da se√ß√£o Custom. Aqui voc√™ pode fazer uma
analogia com o sistema de arquivos, onde grupos e subgrupos podem ser vistos como pastas e
subpastas
O nome do s√≠mbolo e descri√ß√£o do grupo s√£o definidos apenas por caracteres latinos sem pontua√ß√£o,
espa√ßos e caracteres especiais (s√£o permitidos &quot;.&quot;, &quot;_&quot;, &quot;&amp;&quot; e &quot;#&quot;). N√£o √© recomendado usar - nos
nomes dos s√≠mbolos - os caracteres &lt;, &gt;, :, &quot;, /, |, ?, *.
O nome do s√≠mbolo personalizado deve ser √∫nico, independentemente do nome do grupo em que ele
√© criado. Se j√° existir um s√≠mbolo com o mesmo nome, a fun√ß√£o CustomSymbolCreate() retornar√°
false, 
enquanto 
a 
chamada 
subsequente 
de 
<h3>GetLastError()</h3>
gerar√° 
o 
erro 
5300
(ERR_NOT_CUSTOM_SYMBOL) ou 5304 (ERR_CUSTOM_SYMBOL_EXIST). 
O nome do s√≠mbolo n√£o deve exceder 31 caracteres, caso contr√°rio, CustomSymbolCreate()
retornar√° false e ser√° gerado o ero 5302 ‚Äì ERR_CUSTOM_SYMBOL_NAME_LONG.
Par√¢metro symbol_path pode ser definido de duas maneiras:
¬∑ apenas o nome do grupo sem o nome do s√≠mbolo personalizado, por exemplo ‚Äì &quot;CFD\\Metals&quot;. √â
melhor usar essa op√ß√£o para evitar erros.
¬∑ ou nome de &lt;grupo&gt; + separador de grupo &quot;\\&quot;+&lt;nome de s√≠mbolo personalizado&gt;, por exemplo ‚Äì
&quot;CFD\\Metals\\Platinum&quot;. Nesse caso, o nome do grupo deve terminar com o nome exato do</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2143
s√≠mbolo personalizado. Mesmo em caso de incompatibilidade, o s√≠mbolo personalizado ser√° criado,
mas n√£o no grupo pretendido. Por exemplo, se symbol_path=&quot;CFD\\Metals\\Platinum&quot;
e¬†symbol_name=&quot;platinum&quot; (erro no registro), ser√° criado o s√≠mbolo personalizado com o nome
&quot;platinum&quot; 
no 
grupo 
&quot;Custom\CFD\Metals\Platinum&quot;. 
<h3>Nesse</h3>
caso, 
a 
fun√ß√£o
<h3>SymbolInfoGetString(&quot;platinum&quot;,SYMBOL_PATH)</h3>
retornar√° 
o 
valor
&quot;Custom\CFD\Metals\Platinum\platinum&quot;. 
Deve-se ter em mente que a propriedade SYMBOL_PATH retorna o caminho com o nome do s√≠mbolo
no final. Portanto, voc√™ n√£o pode simplesmente copi√°-lo sem altera√ß√µes, se quiser criar um s√≠mbolo
personalizado exatamente no mesmo grupo. Nesse caso, √© necess√°rio cortar o nome do s√≠mbolo para
n√£o obter o resultado descrito acima. 
Se como par√¢metro symbol_origin for especificado um s√≠mbolo inexistente, o s√≠mbolo personalizado
ser√° criado vazio, como se o par√¢metro symbol_origin n√£o tivesse sido especificado. Nesse caso,
ser√° gerado o erro 4301 ‚Äì ERR_MARKET_UNKNOWN_SYMBOL.
O comprimento do par√¢metro symbol_path n√£o deve exceder 127 caracteres considerando &quot;Custom\
\&quot;, separador de grupo &quot;\\&quot; e nome do s√≠mbolo se for indicado no final.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           CustomSymbolCreate.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, informamos no log
   if(!CustomSymbolCreate(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL_ORIGIN
     {
      Print(&quot;CustomSymbolCreate() failed. Error &quot;, GetLastError());
      return;
     }
//--- verificamos a exist√™ncia do s√≠mbolo criado e obtemos o grupo onde ele foi criado
   bool   custom= false;
   bool   exist = SymbolExist(CUSTOM_SYMBOL_NAME, custom);</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2144
</p>
<pre><code class="language-mql5">
   string path  = SymbolInfoString(CUSTOM_SYMBOL_NAME, SYMBOL_PATH);
//--- imprimimos no log o resultado da cria√ß√£o do s√≠mbolo e o nome do grupo, definido 
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; created\n&quot;+
               &quot;Symbol &#x27;%s&#x27; is exist: %s\n&quot;+
               &quot;Symbol &#x27;%s&#x27; is custom: %s\n&quot;+
               &quot;Path specified in the settings: &#x27;%s&#x27;\n&quot;+
               &quot;Path returned from the &#x27;SYMBOL_PATH&#x27; property: &#x27;%s&#x27;&quot;,
               CUSTOM_SYMBOL_NAME, 
               CUSTOM_SYMBOL_NAME, (string)exist, 
               CUSTOM_SYMBOL_NAME, (string)custom,
               CUSTOM_SYMBOL_PATH,
               path);
//--- aguardamos dois segundos e exclu√≠mos o s√≠mbolo criado com uma mensagem sobre o r
   Sleep(2000);
   ResetLastError();
   bool deleted = CustomSymbolDelete(CUSTOM_SYMBOL_NAME);
   Print(deleted ? StringFormat(&quot;Custom symbol &#x27;%s&#x27; removed&quot;, CUSTOM_SYMBOL_NAME) : St
   /*
¬†  resultado:
   Custom symbol &#x27;EURUSD.C&#x27; created
   Symbol &#x27;EURUSD.C&#x27; is exist: true
   Symbol &#x27;EURUSD.C&#x27; is custom: true
   Path specified in the settings: &#x27;Forex&#x27;
   Path returned from the &#x27;SYMBOL_PATH&#x27; property: &#x27;Custom\Forex\EURUSD.C&#x27;
   Custom symbol &#x27;EURUSD.C&#x27; removed
   */
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SymbolName, SymbolSelect, CustomSymbolDelete</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2145
<h3>CustomSymbolDelete</h3>
Remove o s√≠mbolo personalizado com o nome especificado.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolDelete(
   const string     symbol_name          // nome do s√≠mbolo personalizado
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do s√≠mbolo personalizado. N√£o deve corresponder ao nome do s√≠mbolo existente.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
O s√≠mbolo personalizado que aparece na observa√ß√£o do mercado (Market Watch) ou que abre o
gr√°fico n√£o pode ser exclu√≠do.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           CustomSymbolDelete.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, informamos no log
   if(!CustomSymbolCreate(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL_ORIGIN
     {
      Print(&quot;CustomSymbolCreate() failed. Error &quot;, GetLastError());
      return;
     }</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2146
</p>
<pre><code class="language-mql5">
//--- verificamos a exist√™ncia do s√≠mbolo criado e imprimimos no log o resultado
   bool custom= false;
   bool exist = SymbolExist(CUSTOM_SYMBOL_NAME, custom);
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; exists: %s&quot;, CUSTOM_SYMBOL_NAME, (string)exist);
   
//--- aguardamos dois segundos e exclu√≠mos o s√≠mbolo criado com uma mensagem sobre o r
   Sleep(2000);
   ResetLastError();
   bool deleted = CustomSymbolDelete(CUSTOM_SYMBOL_NAME);
   Print(deleted ? StringFormat(&quot;Custom symbol &#x27;%s&#x27; removed&quot;, CUSTOM_SYMBOL_NAME) : St
//--- verificamos a exist√™ncia do s√≠mbolo criado e imprimimos no log o resultado
   exist = SymbolExist(CUSTOM_SYMBOL_NAME, custom);
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; exists: %s&quot;, CUSTOM_SYMBOL_NAME, (string)exist);
   /*
¬†  resultado:
   Custom symbol &#x27;EURUSD.C&#x27; exists: true
   Custom symbol &#x27;EURUSD.C&#x27; removed
   Custom symbol &#x27;EURUSD.C&#x27; exists: false
   */
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SymbolName, SymbolSelect, CustomSymbolCreate</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2147
<h3>CustomSymbolSetInteger</h3>
Define o valor do tipo inteiro para o s√≠mbolo personalizado.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetInteger(
   const string¬†             symbol_name,¬†     // nome do s√≠mbolo
   ENUM_SYMBOL_INFO_INTEGER  property_id,      // identificador de propriedade
   long ¬†                    property_value    // valor de propriedade
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
property_id
[in]  Identificador da propriedade do s√≠mbolo. O valor pode ser um dos valores da enumera√ß√£o
ENUM_SYMBOL_INFO_INTEGER.
property_value
[in]  Vari√°vel de tipo long contendo o valor da propriedade.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Hist√≥rico de minuto e de ticks do s√≠mbolo personalizado √© completamente removido, se, na
especifica√ß√£o do s√≠mbolo, for alterada qualquer uma destas propriedades:
¬∑ SYMBOL_CHART_MODE ‚Äì tipo de pre√ßo usado para plotagem de barras (Bid ou Last)
¬∑ SYMBOL_DIGITS ‚Äì n√∫mero de casas decimais para exibi√ß√£o do pre√ßo
Ap√≥s a remo√ß√£o do hist√≥rico personalizado, o terminal tentar√° criar um novo hist√≥rico usando as
propriedades atualizadas. A mesma coisa acontece quando voc√™ altera manualmente as
propriedades do s√≠mbolo personalizado.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                       CustomSymbolSetInteger.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2148
</p>
<pre><code class="language-mql5">
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
      
//--- obtemos e imprimimos no log as propriedades do s√≠mbolo, com base no qual o s√≠mbo
//--- (modo de realiza√ß√£o de transa√ß√µes, n√≠vel de coloca√ß√£o de ordens Stop e dist√¢ncia
   ENUM_SYMBOL_TRADE_EXECUTION origin_exe_mode = (ENUM_SYMBOL_TRADE_EXECUTION)SymbolIn
   int origin_stops_level = (int)SymbolInfoInteger(CUSTOM_SYMBOL_ORIGIN, SYMBOL_TRADE_
   int origin_freeze_level= (int)SymbolInfoInteger(CUSTOM_SYMBOL_ORIGIN, SYMBOL_TRADE_
   
   PrintFormat(&quot;The &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was created:\n&quot;+
               &quot;  Deal execution mode: %s\n  Stops Level: %d\n  Freeze Level: %d&quot;,
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               StringSubstr(EnumToString(origin_exe_mode), 23), origin_stops_level, or
   
//--- definimos outros valores para essas propriedades do s√≠mbolo personalizado
   ResetLastError();
   bool res=true;
   res &amp;=CustomSymbolSetInteger(CUSTOM_SYMBOL_NAME, SYMBOL_TRADE_EXEMODE, SYMBOL_TRADE
   res &amp;=CustomSymbolSetInteger(CUSTOM_SYMBOL_NAME, SYMBOL_TRADE_STOPS_LEVEL, 10);
   res &amp;=CustomSymbolSetInteger(CUSTOM_SYMBOL_NAME, SYMBOL_TRADE_FREEZE_LEVEL, 3);
//--- se houver erro ao definir qualquer uma das propriedades, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetInteger() failed. Error &quot;, GetLastError());
   
//--- obtemos e imprimimos no log as propriedades alteradas do s√≠mbolo personalizado
//--- (modo de realiza√ß√£o de transa√ß√µes, n√≠vel de coloca√ß√£o de ordens Stop e dist√¢ncia
   ENUM_SYMBOL_TRADE_EXECUTION custom_exe_mode = (ENUM_SYMBOL_TRADE_EXECUTION)SymbolIn
   int custom_stops_level = (int)SymbolInfoInteger(CUSTOM_SYMBOL_NAME, SYMBOL_TRADE_ST
   int custom_freeze_level= (int)SymbolInfoInteger(CUSTOM_SYMBOL_NAME, SYMBOL_TRADE_FR
   
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;:\n&quot;+
               &quot;  Deal execution mode: %s\n  Stops Level: %d\n  Freeze Level: %d&quot;,
               CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_ORIGIN, 
               StringSubstr(EnumToString(custom_exe_mode), 23), custom_stops_level, cu
   
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2149
</p>
<pre><code class="language-mql5">
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   The &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created:
     Deal execution mode: INSTANT
     Stops Level: 0
     Freeze Level: 0
   Custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;:
     Deal execution mode: MARKET
     Stops Level: 10
     Freeze Level: 3
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2150
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SymbolInfoInteger</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2151
<h3>CustomSymbolSetDouble</h3>
Define o valor do tipo real para o s√≠mbolo personalizado.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetDouble(
   const string¬†             symbol_name,¬†     // nome do s√≠mbolo
   ENUM_SYMBOL_INFO_DOUBLE   property_id,      // identificador de propriedade
   double                    property_value    // valor da propriedade
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
property_id
[in]  Identificador da propriedade do s√≠mbolo. O valor pode ser um dos valores da enumera√ß√£o
ENUM_SYMBOL_INFO_DOUBLE.
property_value
[in]  Vari√°vel de tipo double contendo o valor da propriedade.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Hist√≥rico de minuto e de ticks do s√≠mbolo personalizado √© completamente removido, se, na
especifica√ß√£o do s√≠mbolo, for alterada qualquer uma destas propriedades:
¬∑ SYMBOL_POINT ‚Äì valor de um ponto
¬∑ SYMBOL_TRADE_TICK_SIZE ‚Äì valor do tick que define o varia√ß√£o m√≠nima permitida no pre√ßo
¬∑ SYMBOL_TRADE_TICK_VALUE ‚Äì custo quado o pre√ßo varia um tick para posi√ß√£o lucrativa
Ap√≥s a remo√ß√£o do hist√≥rico personalizado, o terminal tentar√° criar um novo hist√≥rico usando as
propriedades atualizadas. A mesma coisa acontece quando voc√™ altera manualmente as
propriedades do s√≠mbolo personalizado.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                        CustomSymbolSetDouble.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2152
</p>
<pre><code class="language-mql5">
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
      
//--- obtemos e imprimimos no log as propriedades do s√≠mbolo, com base no qual o s√≠mbo
//--- (volume m√≠nimo, volume m√°ximo, passo m√≠nimo de mudan√ßa de volume para a realiza√ß
   double origin_vol_min = SymbolInfoDouble(CUSTOM_SYMBOL_ORIGIN, SYMBOL_VOLUME_MIN);
   double origin_vol_max = SymbolInfoDouble(CUSTOM_SYMBOL_ORIGIN, SYMBOL_VOLUME_MAX);
   double origin_vol_step= SymbolInfoDouble(CUSTOM_SYMBOL_ORIGIN, SYMBOL_VOLUME_STEP);
   
   PrintFormat(&quot;The &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was created:\n&quot;+
               &quot;  Volume Min: %.2f\n  Volume Max: %.2f\n  Volume Step: %.2f&quot;,
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               origin_vol_min, origin_vol_max, origin_vol_step);
   
//--- definimos outros valores para essas propriedades do s√≠mbolo personalizado
   ResetLastError();
   bool res=true;
   res &amp;=CustomSymbolSetDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_MIN, 0.1);
   res &amp;=CustomSymbolSetDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_MAX, 1000);
   res &amp;=CustomSymbolSetDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_STEP, 0.1);
//--- se houver erro ao definir qualquer uma das propriedades, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetDouble() failed. Error &quot;, GetLastError());
   
//--- obtemos e imprimimos no log as propriedades alteradas do s√≠mbolo personalizado
//--- (volume m√≠nimo, volume m√°ximo, passo m√≠nimo de mudan√ßa de volume para a realiza√ß
   double custom_vol_min = SymbolInfoDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_MIN);
   double custom_vol_max = SymbolInfoDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_MAX);
   double custom_vol_step= SymbolInfoDouble(CUSTOM_SYMBOL_NAME, SYMBOL_VOLUME_STEP);
   
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;:\n&quot;+
               &quot;  Volume Min: %.2f\n  Volume Max: %.2f\n  Volume Step: %.2f&quot;,
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               custom_vol_min, custom_vol_max, custom_vol_step);
   
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2153
</p>
<pre><code class="language-mql5">
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   The &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created:
     Volume Min: 0.01
     Volume Max: 500.00
     Volume Step: 0.01
   Custom symbol &#x27;EURUSD&#x27; based on &#x27;EURUSD.C&#x27;:
     Volume Min: 0.10
     Volume Max: 1000.00
     Volume Step: 0.10
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2154
</p>
<pre><code class="language-mql5">
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SymbolInfoDouble</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2155
<h3>CustomSymbolSetString</h3>
Define o valor do tipo cadeia de caracteres para o s√≠mbolo personalizado.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetString(
   const string¬†             symbol_name,¬†     // nome do s√≠mbolo
   ENUM_SYMBOL_INFO_STRING   property_id,      // identificador de propriedade
   string                    property_value    // valor de propriedade
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
property_id
[in]  Identificador da propriedade do s√≠mbolo. O valor pode ser um dos valores da enumera√ß√£o
ENUM_SYMBOL_INFO_STRING.
property_value
[in]  Vari√°vel de tipo string contendo o valor da propriedade.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Hist√≥rico de minuto e de ticks do s√≠mbolo personalizado √© completamente removido, se, na
especifica√ß√£o do s√≠mbolo, for alterada a propriedade SYMBOL_FORMULA, ela define a f√≥rmula para
plotagem do pre√ßo do s√≠mbolo personalizado. Ap√≥s a remo√ß√£o do hist√≥rico personalizado, o terminal
tentar√° criar um novo hist√≥rico com base na nova f√≥rmula. A mesma coisa acontece quando voc√™
altera manualmente a f√≥rmula do s√≠mbolo personalizado.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                        CustomSymbolSetString.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2156
</p>
<pre><code class="language-mql5">
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
      
//--- obtemos e imprimimos no log as propriedades do s√≠mbolo, com base no qual o s√≠mbo
//--- (volume m√≠nimo, volume m√°ximo, passo m√≠nimo de mudan√ßa de volume para a realiza√ß
   string origin_basis    = SymbolInfoString(CUSTOM_SYMBOL_ORIGIN, SYMBOL_BASIS);
   string origin_category = SymbolInfoString(CUSTOM_SYMBOL_ORIGIN, SYMBOL_CATEGORY);
   string origin_formula  = SymbolInfoString(CUSTOM_SYMBOL_ORIGIN, SYMBOL_FORMULA);
   
   PrintFormat(&quot;The &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was created:\n&quot;+
               &quot;  Basis: %s\n  Category: %s\n  Formula: %s&quot;,
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               origin_basis, origin_category, origin_formula);
   
//--- definimos outros valores para essas propriedades do s√≠mbolo personalizado
   ResetLastError();
   bool res=true;
   res &amp;=CustomSymbolSetString(CUSTOM_SYMBOL_NAME, SYMBOL_BASIS, CUSTOM_SYMBOL_ORIGIN)
   res &amp;=CustomSymbolSetString(CUSTOM_SYMBOL_NAME, SYMBOL_CATEGORY, &quot;FX&quot;);
   res &amp;=CustomSymbolSetString(CUSTOM_SYMBOL_NAME, SYMBOL_FORMULA, (&quot;1.0 / &quot;+CUSTOM_SY
//--- se houver erro ao definir qualquer uma das propriedades, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetString() failed. Error &quot;, GetLastError());
   
//--- obtemos e imprimimos no log as propriedades alteradas do s√≠mbolo personalizado
//--- (volume m√≠nimo, volume m√°ximo, passo m√≠nimo de mudan√ßa de volume para a realiza√ß
   string custom_basis    = SymbolInfoString(CUSTOM_SYMBOL_NAME, SYMBOL_BASIS);
   string custom_category = SymbolInfoString(CUSTOM_SYMBOL_NAME, SYMBOL_CATEGORY);
   string custom_formula  = SymbolInfoString(CUSTOM_SYMBOL_NAME, SYMBOL_FORMULA);
   
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;:\n&quot;+
               &quot;  Basis: %s\n  Category: %s\n  Formula: %s&quot;,
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               custom_basis, custom_category, custom_formula);
   
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2157
</p>
<pre><code class="language-mql5">
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   The &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created:
     Basis: 
     Category: 
     Formula: 
   Custom symbol &#x27;EURUSD&#x27; based on &#x27;EURUSD.C&#x27;:
     Basis: EURUSD
     Category: FX
     Formula: 1.0 / EURUSD
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2158
</p>
<pre><code class="language-mql5">
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>SymbolInfoString</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2159
<h3>CustomSymbolSetMarginRate</h3>
Define o coeficiente de cobran√ßa da margem - dependendo do tipo e dire√ß√£o da ordem - para o s√≠mbolo
personalizado.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetMarginRate(
   const string       symbol_name,¬†             // nome do s√≠mbolo
   ENUM_ORDER_TYPE¬†   order_type,               // tipo de ordem
   double             initial_margin_rate,      // coeficiente de cobran√ßa da margem i
   double ¬†           maintenance_margin_rate¬†  // coeficiente de cobran√ßa da margem d
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
order_type
[in]  Tipo de ordem.
initial_margin_rate
[in] Vari√°vel de tipo double com o valor de coeficiente de cobran√ßa da margem inicial. A margem
inicial √© o tamanho da soma de garantia (margem) das transa√ß√µes conclu√≠das com volume de um
lote para a dire√ß√£o correspondente. Ao multiplicar o coeficiente pela margem inicial, n√≥s podemos
obter o montante que ser√° reservado na conta ao colocar a ordem do tipo especificado.
maintenance_margin_rate
[in] Vari√°vel do tipo double com o valor de coeficiente de cobran√ßa da margem de manuten√ß√£o. A
margem de manuten√ß√£o √© a quantidade m√≠nima para manter uma posi√ß√£o aberta com volume de
um lote para a dire√ß√£o correspondente. Ao multiplicar o coeficiente pela margem de manuten√ß√£o,
n√≥s podemos obter o montante que ser√° reservado na conta ap√≥s a ativa√ß√£o da ordem do tipo
especificado.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                    CustomSymbolSetMarginRate.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2160
</p>
<pre><code class="language-mql5">
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   INITIAL_MARGIN_RATE       1.5         // coeficiente de cobran√ßa da margem i
#define   MAINTENANCE_MARGIN_RATE   1.5         // coeficiente de cobran√ßa da margem d
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
      
//--- obtemos e imprimimos no log as propriedades do s√≠mbolo, com base no qual o s√≠mbo
//--- (coeficientes de cobran√ßa da margem inicial e de manuten√ß√£o para ordens Buy e Se
   double initial_margin_rate_buy=0;
   double maintenance_margin_rate_buy=0;
   double initial_margin_rate_sell=0;
   double maintenance_margin_rate_sell=0;
   
   if(!GetSymbolMarginRate(CUSTOM_SYMBOL_ORIGIN, ORDER_TYPE_BUY, initial_margin_rate_b
      return;
   if(!GetSymbolMarginRate(CUSTOM_SYMBOL_ORIGIN, ORDER_TYPE_SELL,initial_margin_rate_s
      return;
   
   PrintFormat(&quot;The &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was created:\n&quot;+
               &quot;  Buy order initial margin rate: %f\n  Buy order maintenance margin ra
               &quot;  Sell order initial margin rate: %f\n  Sell order maintenance margin 
               CUSTOM_SYMBOL_ORIGIN, CUSTOM_SYMBOL_NAME,
               initial_margin_rate_buy, maintenance_margin_rate_buy, initial_margin_ra
   
//--- definimos outros valores para essas propriedades do s√≠mbolo personalizado
   ResetLastError();
   bool res=true;
   res &amp;=CustomSymbolSetMarginRate(CUSTOM_SYMBOL_NAME, ORDER_TYPE_BUY, INITIAL_MARGIN_
   res &amp;=CustomSymbolSetMarginRate(CUSTOM_SYMBOL_NAME, ORDER_TYPE_SELL,INITIAL_MARGIN_
//--- se houver erro ao definir qualquer uma das propriedades, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetMarginRate() failed. Error &quot;, GetLastError());
   
//--- obtemos e imprimimos no log as propriedades alteradas do s√≠mbolo personalizado
//--- (coeficientes de cobran√ßa da margem inicial e de manuten√ß√£o para ordens Buy e Se
   if(!GetSymbolMarginRate(CUSTOM_SYMBOL_NAME, ORDER_TYPE_BUY, initial_margin_rate_buy</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2161
</p>
<pre><code class="language-mql5">
      return;
   if(!GetSymbolMarginRate(CUSTOM_SYMBOL_NAME, ORDER_TYPE_SELL,initial_margin_rate_sel
      return;
   
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;:\n&quot;+
               &quot;  Buy order initial margin rate: %f\n  Buy order maintenance margin ra
               &quot;  Sell order initial margin rate: %f\n  Sell order maintenance margin 
               CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_ORIGIN, 
               initial_margin_rate_buy, maintenance_margin_rate_buy, initial_margin_ra
   
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   The &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created:
     Buy order initial margin rate: 1.000000
     Buy order maintenance margin rate: 0.000000
     Sell order initial margin rate: 1.000000
     Sell order maintenance margin rate: 0.000000
   Custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;:
     Buy order initial margin rate: 1.500000
     Buy order maintenance margin rate: 1.500000
     Sell order initial margin rate: 1.500000
     Sell order maintenance margin rate: 1.500000
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2162
</p>
<pre><code class="language-mql5">
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Retorna os coeficientes de cobran√ßa da margem                    |
//+------------------------------------------------------------------+
bool GetSymbolMarginRate(const string symbol, const ENUM_ORDER_TYPE order_type, double
  {
   ResetLastError();
   if(!SymbolInfoMarginRate(symbol, order_type, initial_margin_rate, maintenance_margi
     {
      PrintFormat(&quot;%s: SymbolInfoMarginRate(%s, %s) failed. Error %d&quot;,__FUNCTION__, sy
      return false;
     }
   return true;
</code></pre>
<p>
  }</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2163
<h3>Veja tamb√©m</h3>
<h3>SymbolInfoMarginRate</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2164
<h3>CustomSymbolSetSessionQuote</h3>
Define a hora de in√≠cio e fim da sess√£o de cota√ß√£o especificada para o s√≠mbolo especificado e dia da
semana.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetSessionQuote(
   const string¬†     symbol_name,         // nome do s√≠mbolo
   ENUM_DAY_OF_WEEK¬† day_of_week,         // dia da semana
   uint¬†             session_index,¬†      // n√∫mero de sess√£o
   datetime ¬†        from,¬†               // hora de in√≠cio da sess√£o
   datetime ¬†        to¬†                  // hora de fim da sess√£o
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
<h3>ENUM_DAY_OF_WEEK</h3>
[in]  Dia da semana toma um valor da enumera√ß√£o ENUM_DAY_OF_WEEK.
uint
[in] N√∫mero de ordem da sess√£o para a qual √© necess√°rio definir a hora de in√≠cio e fim. Indexa√ß√£o
de sess√µes come√ßa por 0.
from
[in]  Hora de in√≠cio de sess√£o em segundos - a partir de 00:00 -, o valor da data ser√° ignorado na
vari√°vel.
to
[in]  Hora de fim de sess√£o em segundos - a partir de 00:00 -, o valor da data ser√° ignorado na
vari√°vel.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Se a sess√£o com o session_index definido j√° existir, a fun√ß√£o simplesmente editar√° o in√≠cio e fim da
sess√£o.
Se transferidos par√¢metros nulos de in√≠cio e fim para a sess√£o, isto √©, especificados from=0 e to=0,
a sess√£o correspondente com √≠ndice session_index ser√° removida, enquanto a numera√ß√£o das
sess√µes ser√° deslocada para baixo.
√â poss√≠vel adicionar sess√µes s√≥ sequencialmente, isto √©, a sess√£o com √≠ndice session_index=1 pode
ser adicionada apenas se j√° existir uma sess√£o com um √≠ndice igual a 0. Ao violar esta regra, n√£o √©
criada uma nova sess√£o, e a fun√ß√£o retornar√° false.
<h3>Exemplo:</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2165
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                  CustomSymbolSetSessionQuote.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   SESSION_0_FROM         D&#x27;1970.01.01 00:15:00&#x27;  // hora de in√≠cio da sess√£o 0
#define   SESSION_0_TO           D&#x27;1970.01.01 11:59:00&#x27;  // hora de t√©rmino da sess√£o 
#define   SESSION_1_FROM         D&#x27;1970.01.01 12:15:00&#x27;  // hora de in√≠cio da sess√£o 1
#define   SESSION_1_TO           D&#x27;1970.01.01 23:59:00&#x27;  // hora de t√©rmino da sess√£o 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
    
//--- imprimimos o cabe√ßalho com o s√≠mbolo base e o √≠ndice da sess√£o e
//--- no loop pelos dias da semana de SEG a SEX, imprimimos no log a hora de in√≠cio e 
   for(int session=0; session&lt;2; session++)
     {
      PrintFormat(&quot;Quote session %d of &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was crea
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++) 
         SymbolInfoSessionQuotePrint(CUSTOM_SYMBOL_ORIGIN, (ENUM_DAY_OF_WEEK)day_of_we
     }
     
//--- no loop por duas sess√µes
   bool res=true;
   for(int session=0; session&lt;2; session++)
     {
      datetime from = SESSION_0_FROM;
      datetime to   = SESSION_0_TO;
      if(session&gt;0)
        {
         from = SESSION_1_FROM;
         to   = SESSION_1_TO;</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2166
</p>
<pre><code class="language-mql5">
        }
      //--- para o s√≠mbolo personalizado, definimos o hor√°rio das sess√µes de cota√ß√£o p
      ResetLastError();
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++)
         res &amp;=CustomSymbolSetSessionQuote(CUSTOM_SYMBOL_NAME, (ENUM_DAY_OF_WEEK)day_o
     }
//--- se houver erro ao definir qualquer uma das sess√µes, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetSessionQuote() failed. Error &quot;, GetLastError());
   
//--- imprimimos o cabe√ßalho com o s√≠mbolo personalizado e o √≠ndice da sess√£o e
//--- no loop pelos dias da semana de SEG a SEX, imprimimos no log a hora de in√≠cio e 
   for(int session=0; session&lt;2; session++)
     {
      PrintFormat(&quot;Quote session %d of custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;&quot;, session, CUS
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++) 
         SymbolInfoSessionQuotePrint(CUSTOM_SYMBOL_NAME, (ENUM_DAY_OF_WEEK)day_of_week
     }
     
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   Quote session 0 of &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created
   - Monday     00:15 - 23:55
   - Tuesday    00:15 - 23:55
   - Wednesday  00:15 - 23:55
   - Thursday   00:15 - 23:55
   - Friday     00:15 - 23:55
   Quote session 1 of &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created
   - Monday     Session not set
   - Tuesday    Session not set
   - Wednesday  Session not set
   - Thursday   Session not set</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2167
</p>
<pre><code class="language-mql5">
   - Friday     Session not set
   Quote session 0 of custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;
   - Monday     00:15 - 11:59
   - Tuesday    00:15 - 11:59
   - Wednesday  00:15 - 11:59
   - Thursday   00:15 - 11:59
   - Friday     00:15 - 11:59
   Quote session 1 of custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;
   - Monday     12:15 - 23:59
   - Tuesday    12:15 - 23:59
   - Wednesday  12:15 - 23:59
   - Thursday   12:15 - 23:59
   - Friday     12:15 - 23:59
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2168
</p>
<pre><code class="language-mql5">
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Imprime no log o hor√°rio de in√≠cio e t√©rmino da sess√£o |
//| de cota√ß√£o para o s√≠mbolo e dia da semana especificados |
//+------------------------------------------------------------------+ 
void SymbolInfoSessionQuotePrint(const string symbol, const ENUM_DAY_OF_WEEK day_of_we
  { 
//--- declaramos vari√°veis para armazenar o in√≠cio e t√©rmino da sess√£o de cota√ß√£o
   datetime date_from;  // hora de in√≠cio da sess√£o
   datetime date_to;    // hora de t√©rmino da sess√£o
    
//--- criamos o nome do dia da semana a partir da constante de enumera√ß√£o
   string week_day=EnumToString(day_of_week); 
   if(week_day.Lower()) 
      week_day.SetChar(0, ushort(week_day.GetChar(0)-32)); 
  
//--- obtemos os dados da sess√£o de cota√ß√£o para o s√≠mbolo e dia da semana
   if(!SymbolInfoSessionQuote(symbol, day_of_week, session_index, date_from, date_to))
     { 
      int err=GetLastError();
      string message=(err==4307 ? StringFormat(&quot;- %-10s Session not set&quot;, week_day) : 
                      StringFormat(&quot;SymbolInfoSessionQuote(%s, %s, session %d) failed.
      Print(message); 
      return; 
     } 
      
//--- imprimimos no log os dados da sess√£o de cota√ß√£o especificada
   PrintFormat(&quot;- %-10s %s - %s&quot;, week_day, TimeToString(date_from, TIME_MINUTES), Tim
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
SymbolInfoSessionQuote, Informa√ß√µes sobre o instrumento , TimeToStruct, Estrutura de data</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2169
<h3>CustomSymbolSetSessionTrade</h3>
Define a hora de in√≠cio e fim da sess√£o de negocia√ß√£o especificada para o s√≠mbolo especificado e dia
da semana.
</p>
<pre><code class="language-mql5">
bool¬† CustomSymbolSetSessionTrade(
   constg¬†           symbol_name,¬†        // nome do s√≠mbolo
   ENUM_DAY_OF_WEEK¬† day_of_week,         // dia da semana
   uint¬†             session_index,¬†      // n√∫mero de sess√£o
   datetime ¬†        from,¬†               // hora de in√≠cio da sess√£o
   datetime ¬†        to¬†                  // hora de fim da sess√£o
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol_name
[in]  Nome do s√≠mbolo personalizado.
<h3>ENUM_DAY_OF_WEEK</h3>
[in]  Dia da semana toma um valor da enumera√ß√£o ENUM_DAY_OF_WEEK.
uint
[in] N√∫mero de ordem da sess√£o para a qual √© necess√°rio definir a hora de in√≠cio e fim. Indexa√ß√£o
de sess√µes come√ßa por 0.
from
[in]  Hora de in√≠cio de sess√£o em segundos - a partir de 00:00 -, o valor da data ser√° ignorado na
vari√°vel.
to
[in]  Hora de fim de sess√£o em segundos - a partir de 00:00 -, o valor da data ser√° ignorado na
vari√°vel.
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Observa√ß√£o</h3>
Se a sess√£o com o session_index definido j√° existir, a fun√ß√£o simplesmente editar√° o in√≠cio e fim da
sess√£o.
Se transferidos par√¢metros nulos de in√≠cio e fim para a sess√£o, isto √©, especificados from=0 e to=0,
a sess√£o correspondente com √≠ndice session_index ser√° removida, enquanto a numera√ß√£o das
sess√µes ser√° deslocada para baixo.
√â poss√≠vel adicionar sess√µes s√≥ sequencialmente, isto √©, a sess√£o com √≠ndice session_index=1 pode
ser adicionada apenas se j√° existir uma sess√£o com um √≠ndice igual a 0. Ao violar esta regra, n√£o √©
criada uma nova sess√£o, e a fun√ß√£o retornar√° false.
<h3>Exemplo:</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2170
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                  CustomSymbolSetSessionTrade.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   SESSION_0_FROM         D&#x27;1970.01.01 00:15:00&#x27;  // hora de in√≠cio da sess√£o 0
#define   SESSION_0_TO           D&#x27;1970.01.01 11:59:00&#x27;  // hora de t√©rmino da sess√£o 
#define   SESSION_1_FROM         D&#x27;1970.01.01 12:15:00&#x27;  // hora de in√≠cio da sess√£o 1
#define   SESSION_1_TO           D&#x27;1970.01.01 23:59:00&#x27;  // hora de t√©rmino da sess√£o 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
    
//--- imprimimos o cabe√ßalho com o s√≠mbolo base e o √≠ndice da sess√£o e
//--- no loop pelos dias da semana de SEG a SEX, imprimimos no log a hora de in√≠cio e 
   for(int session=0; session&lt;2; session++)
     {
      PrintFormat(&quot;Trade session %d of the &#x27;%s&#x27; symbol from which the custom &#x27;%s&#x27; was 
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++) 
         SymbolInfoSessionQuotePrint(CUSTOM_SYMBOL_ORIGIN, (ENUM_DAY_OF_WEEK)day_of_we
     }
     
//--- no loop por duas sess√µes
   bool res=true;
   for(int session=0; session&lt;2; session++)
     {
      datetime from = SESSION_0_FROM;
      datetime to   = SESSION_0_TO;
      if(session&gt;0)
        {
         from = SESSION_1_FROM;
         to   = SESSION_1_TO;</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2171
</p>
<pre><code class="language-mql5">
        }
      //--- para o s√≠mbolo personalizado, definimos o hor√°rio das sess√µes de cota√ß√£o p
      ResetLastError();
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++)
         res &amp;=CustomSymbolSetSessionQuote(CUSTOM_SYMBOL_NAME, (ENUM_DAY_OF_WEEK)day_o
     }
//--- se houver erro ao definir qualquer uma das sess√µes, informamos no log
   if(!res)
      Print(&quot;CustomSymbolSetSessionTrade() failed. Error &quot;, GetLastError());
   
//--- imprimimos o cabe√ßalho com o s√≠mbolo personalizado e o √≠ndice da sess√£o e
//--- no loop pelos dias da semana de SEG a SEX, imprimimos no log a hora de in√≠cio e 
   for(int session=0; session&lt;2; session++)
     {
      PrintFormat(&quot;Trade session %d of a custom symbol &#x27;%s&#x27; based on &#x27;%s&#x27;&quot;, session, C
      for(int day_of_week=MONDAY; day_of_week&lt;SATURDAY; day_of_week++) 
         SymbolInfoSessionQuotePrint(CUSTOM_SYMBOL_NAME, (ENUM_DAY_OF_WEEK)day_of_week
     }
     
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   Trade session 0 of the &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created
   - Monday     00:15 - 23:55
   - Tuesday    00:15 - 23:55
   - Wednesday  00:15 - 23:55
   - Thursday   00:15 - 23:55
   - Friday     00:15 - 23:55
   Trade session 1 of the &#x27;EURUSD&#x27; symbol from which the custom &#x27;EURUSD.C&#x27; was created
   - Monday     Session not set
   - Tuesday    Session not set
   - Wednesday  Session not set
   - Thursday   Session not set</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2172
</p>
<pre><code class="language-mql5">
   - Friday     Session not set
   Trade session 0 of a custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;
   - Monday     00:15 - 11:59
   - Tuesday    00:15 - 11:59
   - Wednesday  00:15 - 11:59
   - Thursday   00:15 - 11:59
   - Friday     00:15 - 11:59
   Trade session 1 of a custom symbol &#x27;EURUSD.C&#x27; based on &#x27;EURUSD&#x27;
   - Monday     12:15 - 23:59
   - Tuesday    12:15 - 23:59
   - Wednesday  12:15 - 23:59
   - Thursday   12:15 - 23:59
   - Friday     12:15 - 23:59
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2173
</p>
<pre><code class="language-mql5">
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Imprime no log o hor√°rio de in√≠cio e t√©rmino da sess√£o |
//| de negocia√ß√£o para o s√≠mbolo e dia da semana especificados |
//+------------------------------------------------------------------+ 
void SymbolInfoSessionTradePrint(const string symbol, const ENUM_DAY_OF_WEEK day_of_we
  { 
//--- declaramos vari√°veis para armazenar o in√≠cio e t√©rmino da sess√£o de cota√ß√£o
   datetime date_from;  // hora de in√≠cio da sess√£o
   datetime date_to;    // hora de t√©rmino da sess√£o
    
//--- criamos o nome do dia da semana a partir da constante de enumera√ß√£o
   string week_day=EnumToString(day_of_week); 
   if(week_day.Lower()) 
      week_day.SetChar(0, ushort(week_day.GetChar(0)-32)); 
  
//--- obtemos os dados da sess√£o de cota√ß√£o para o s√≠mbolo e dia da semana
   if(!SymbolInfoSessionTrade(symbol, day_of_week, session_index, date_from, date_to))
     { 
      int err=GetLastError();
      string message=(err==4307 ? StringFormat(&quot;- %-10s Session not set&quot;, week_day) : 
                      StringFormat(&quot;SymbolInfoSessionTrade(%s, %s, session %d) failed.
      Print(message); 
      return; 
     } 
      
//--- imprimimos no log os dados da sess√£o de negocia√ß√£o especificada
   PrintFormat(&quot;- %-10s %s - %s&quot;, week_day, TimeToString(date_from, TIME_MINUTES), Tim
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
SymbolInfoSessionTrade, Informa√ß√µes sobre o instrumento, TimeToStruct, Estrutura de data</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2174
<h3>CustomRatesDelete</h3>
Exclui todas as barras do hist√≥rico de pre√ßo do instrumento personalizado no intervalo de tempo
selecionado.
</p>
<pre><code class="language-mql5">
int¬† CustomRatesDelete(
   const string¬†    symbol,¬†      // nome do s√≠mbolo
   datetime¬†        from,¬†        // a partir de qual data
   datetime¬†        to¬†           // at√© qual data
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
from
[in]  Tempo da primeira barra no hist√≥rico de pre√ßo dentro do intervalo a ser exclu√≠do.
to
[in]  Tempo da √∫ltima barra no hist√≥rico de pre√ßo dentro do intervalo a ser exclu√≠do.
<h3>Valor de retorno</h3>
N√∫mero de barras removidas ou -1 em caso de erro.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            CustomRatesDelete.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATARATES_COUNT        4                 // n√∫mero de barras a serem exibida
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2175
</p>
<pre><code class="language-mql5">
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos o n√∫mero de barras do s√≠mbolo padr√£o
   int bars=Bars(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1);
      
//--- obtemos os dados de todas as barras do timeframe de minutos de um s√≠mbolo padr√£o
   MqlRates rates[]={};
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1, 0, bars, rates)!=bars)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_OR
      return;
     }
//--- definimos os dados copiados para o hist√≥rico de minutos do s√≠mbolo personalizado
   ResetLastError();
   if(CustomRatesUpdate(CUSTOM_SYMBOL_NAME, rates)&lt;0)
     {
      PrintFormat(&quot;CustomRatesUpdate(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas
      return;
     }
     
//--- ap√≥s atualizar os dados hist√≥ricos, obtemos o n√∫mero de barras do s√≠mbolo person
   bars=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   
//--- obtemos os dados de todas as barras do timeframe de minutos do s√≠mbolo personali
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars, rates)!=bars)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }
//--- imprimimos no log as √∫ltimas barras DATARATES_COUNT do hist√≥rico de minutos do s
   int digits=(int)SymbolInfoInteger(CUSTOM_SYMBOL_NAME, SYMBOL_DIGITS);
   PrintFormat(&quot;Last %d bars of the custom symbol&#x27;s minute history:&quot;, DATARATES_COUNT)
   ArrayPrint(rates, digits, NULL, bars-DATARATES_COUNT, DATARATES_COUNT);
   
//--- exclu√≠mos as duas pen√∫ltimas barras de dados presentes no hist√≥rico de minutos d
   datetime time_from= rates[bars-3].time;
   datetime time_to  = rates[bars-2].time;
   ResetLastError();
   int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, time_from, time_to);
   if(deleted&lt;0)
     {
      PrintFormat(&quot;CustomRatesDelete(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2176
</p>
<pre><code class="language-mql5">
      return;
     }
     
 //--- ap√≥s excluir duas barras dos dados hist√≥ricos, obtemos novamente o n√∫mero de ba
   bars=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   
//--- obtemos novamente os dados de todas as barras restantes do timeframe de minutos 
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars, rates)!=bars)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }
//--- imprimimos no log as √∫ltimas barras DATARATES_COUNT do hist√≥rico de minutos atua
   PrintFormat(&quot;\nLast %d bars after applying CustomRatesDelete() with %d deleted bars
   ArrayPrint(rates, digits, NULL, bars-DATARATES_COUNT, DATARATES_COUNT);
     
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   Last 4 bars of the custom symbol&#x27;s minute history:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2177
</p>
<pre><code class="language-mql5">
   [0] 2024.06.18 20:53:00 1.07341 1.07347 1.07336 1.07343            38        0     
   [1] 2024.06.18 20:54:00 1.07344 1.07354 1.07344 1.07353            21        0     
   [2] 2024.06.18 20:55:00 1.07353 1.07362 1.07351 1.07356            32        0     
   [3] 2024.06.18 20:56:00 1.07356 1.07358 1.07352 1.07354            24        0     
   
   Last 4 bars after applying CustomRatesDelete() with 2 deleted bars:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea
   [0] 2024.06.18 20:51:00 1.07357 1.07358 1.07347 1.07349            25        0     
   [1] 2024.06.18 20:52:00 1.07349 1.07350 1.07336 1.07341            31        0     
   [2] 2024.06.18 20:53:00 1.07341 1.07347 1.07336 1.07343            38        0     
   [3] 2024.06.18 20:56:00 1.07356 1.07358 1.07352 1.07354            24        0     
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2178
</p>
<pre><code class="language-mql5">
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>CustomRatesReplace, CustomRatesUpdate, CopyRates</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2179
<h3>CustomRatesReplace</h3>
Substitui todo o hist√≥rico de pre√ßo do instrumento personalizado pelos dados na matriz do tipo
MqlRates, no intervalo de tempo definido.
</p>
<pre><code class="language-mql5">
int¬† CustomRatesReplace(
   const string¬†    symbol,¬†            // nome do s√≠mbolo
   datetime¬†        from,¬†              // a partir de qual data
   datetime¬†        to,¬†                // at√© qual data
   const MqlRates&amp;  rates[],¬†           // matriz com dados que √© necess√°rio aplicar a
   uint¬†            count=WHOLE_ARRAY¬†  // n√∫mero de elementos a serem usados na matri
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
from
[in]  Tempo da primeira barra no hist√≥rico de pre√ßo, na faixa definida a ser atualizada.
to
[in]  Tempo da √∫ltima barra no hist√≥rico de pre√ßo, na faixa definida a ser atualizada.
rates[]
[in]   Matriz de dados hist√≥ricos do tipo MqlRates para o per√≠odo M1.
count=WHOLE_ARRAY
[in]  N√∫mero de elementos da matriz rates[] a serem usados para substitui√ß√£o. O valor
WHOLE_ARRAY indica que para substitui√ß√£o √© necess√°rio usar todos os elementos da matriz
rates[].
<h3>Valor de retorno</h3>
N√∫mero de barras atualizadas ou -1 em caso de erro.
<h3>Geral</h3>
Se a barra na matriz rates[] ficar fora do intervalo definido, ela ser√° ignorada. Se essa barra existir
no hist√≥rico de pre√ßo e ficar dentro do intervalo definido, ela ser√° substitu√≠da. Todas as outras
barras - no hist√≥rico de pre√ßo atual - fora do intervalo definido permanecem inalteradas. Os dados
da matriz rates[] devem estar corretas em rela√ß√£o aos pre√ßos OHLC, enquanto o tempo de abertura
de barras deve corresponder ao per√≠odo M1.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           CustomRatesReplace.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2180
</p>
<pre><code class="language-mql5">
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATARATES_COUNT        4                 // n√∫mero de barras a serem exibida
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos o n√∫mero de barras do s√≠mbolo padr√£o
   int bars=Bars(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1);
      
//--- obtemos os dados de todas as barras do timeframe de minutos de um s√≠mbolo padr√£o
   MqlRates rates[]={};
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1, 0, bars, rates)!=bars)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_OR
      return;
     }
//--- definimos os dados copiados para o hist√≥rico de minutos do s√≠mbolo personalizado
   ResetLastError();
   if(CustomRatesUpdate(CUSTOM_SYMBOL_NAME, rates)&lt;0)
     {
      PrintFormat(&quot;CustomRatesUpdate(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas
      return;
     }
     
//--- ap√≥s atualizar os dados hist√≥ricos, obtemos o n√∫mero de barras do s√≠mbolo person
   bars=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   
//--- obtemos os dados de todas as barras do timeframe de minutos do s√≠mbolo personali
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars, rates)!=bars)
     {</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2181
</p>
<pre><code class="language-mql5">
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }
//--- imprimimos no log as √∫ltimas barras DATARATES_COUNT do hist√≥rico de minutos do s
   int digits=(int)SymbolInfoInteger(CUSTOM_SYMBOL_NAME, SYMBOL_DIGITS);
   PrintFormat(&quot;Last %d bars of the custom symbol&#x27;s minute history:&quot;, DATARATES_COUNT)
   ArrayPrint(rates, digits, NULL, bars-DATARATES_COUNT, DATARATES_COUNT);
   
//--- alteramos as duas pen√∫ltimas barras de dados no hist√≥rico de minutos do s√≠mbolo 
   datetime time_from= rates[bars-3].time;
   datetime time_to  = rates[bars-2].time;
   
//--- no array rates, fazemos todos os pre√ßos das duas pen√∫ltimas barras iguais aos pr
   rates[bars-3].high=rates[bars-3].open;
   rates[bars-3].low=rates[bars-3].open;
   rates[bars-3].close=rates[bars-3].open;
   
   rates[bars-2].high=rates[bars-2].open;
   rates[bars-2].low=rates[bars-2].open;
   rates[bars-2].close=rates[bars-2].open;
   
//--- substitu√≠mos as barras existentes com os dados do array rates modificado
   ResetLastError();
   int replaced=CustomRatesUpdate(CUSTOM_SYMBOL_NAME, rates);
   if(replaced&lt;0)
     {
      PrintFormat(&quot;CustomRatesUpdate(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas
      return;
     }
     
//--- ap√≥s alterar duas barras de dados hist√≥ricos, obtemos novamente o n√∫mero de barr
   bars=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   
//--- obtemos novamente os dados de todas as barras do timeframe de minutos do s√≠mbolo
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars, rates)!=bars)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }
//--- imprimimos no log as √∫ltimas barras DATARATES_COUNT do hist√≥rico de minutos atua
   PrintFormat(&quot;\nLast %d bars after applying CustomRatesUpdate() with %d replaced bar
   ArrayPrint(rates, digits, NULL, bars-DATARATES_COUNT, DATARATES_COUNT);
     
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2182
</p>
<pre><code class="language-mql5">
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   Last 4 bars of the custom symbol&#x27;s minute history:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea
   [0] 2024.07.29 13:37:00 1.08394 1.08396 1.08388 1.08390            16        1     
   [1] 2024.07.29 13:38:00 1.08389 1.08400 1.08389 1.08398            35        1     
   [2] 2024.07.29 13:39:00 1.08398 1.08410 1.08394 1.08410            29        1     
   [3] 2024.07.29 13:40:00 1.08409 1.08414 1.08408 1.08414            14        1     
   
   Last 4 bars after applying CustomRatesUpdate() with 250820 replaced bars:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea
   [0] 2024.07.29 13:37:00 1.08394 1.08396 1.08388 1.08390            16        1     
   [1] 2024.07.29 13:38:00 1.08389 1.08389 1.08389 1.08389            35        1     
   [2] 2024.07.29 13:39:00 1.08398 1.08398 1.08398 1.08398            29        1     
   [3] 2024.07.29 13:40:00 1.08409 1.08414 1.08408 1.08414            14        1     
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2183
</p>
<pre><code class="language-mql5">
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>CustomRatesDelete, CustomRatesUpdate, CopyRates</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2184
<h3>CustomRatesUpdate</h3>
Adiciona ao hist√≥rico do instrumento personalizado as barras que faltam e substitui os dados
existentes na matriz do tipo MqlRates.
</p>
<pre><code class="language-mql5">
int¬† CustomRatesUpdate(
   const string¬†    symbol,¬†            // nome do s√≠mbolo personalizado
   const MqlRates&amp;  rates[],       ¬†    // matriz com dados que devem ser aplicadas ao
   uint¬†            count=WHOLE_ARRAY¬†  // n√∫mero de elementos a serem usados na matri
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
rates[]
[in]   Matriz de dados hist√≥ricos do tipo MqlRates para o per√≠odo M1.
count=WHOLE_ARRAY
[in]  N√∫mero de elementos da matriz rates[] a serem usados para atualiza√ß√£o. O valor
WHOLE_ARRAY indica que √© necess√°rio usar todos os elementos da matriz rates[].
<h3>Valor de retorno</h3>
N√∫mero de barras atualizadas ou -1 em caso de erro.
<h3>Geral</h3>
Se a barra na matriz rates[] n√£o existir no hist√≥rico atual do instrumento personalizado, ela ser√°
adicionada. Se essa barra j√° existir, ela ser√° √© substitu√≠da. Todas as outras barras no hist√≥rico de
pre√ßo atual permanecem inalteradas. Os dados da matriz rates[] devem estar corretas em rela√ß√£o
aos pre√ßos OHLC, enquanto o tempo de abertura de barras deve corresponder ao per√≠odo M1.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            CustomRatesUpdate.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATARATES_COUNT        4                 // n√∫mero de barras a serem exibida</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2185
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos e imprimimos no log o n√∫mero de barras do s√≠mbolo personalizado padr√£o
   int bars_origin=Bars(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1);
   PrintFormat(&quot;The symbol &#x27;%s&#x27; from which the custom &#x27;%s&#x27; was created has %d bars of 
      
//--- obtemos e imprimimos no log o n√∫mero de barras do s√≠mbolo personalizado
   int bars_custom=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   PrintFormat(&quot;Custom symbol &#x27;%s&#x27; created from symbol &#x27;%s&#x27; has %d bars of minute hist
      
//--- obtemos os dados de todas as barras do timeframe de minutos de um s√≠mbolo padr√£o
   MqlRates rates[]={};
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_ORIGIN, PERIOD_M1, 0, bars_origin, rates)!=bars_origin)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_OR
      return;
     }
//--- definimos os dados copiados para o hist√≥rico de minutos do s√≠mbolo personalizado
   ResetLastError();
   int updated=CustomRatesUpdate(CUSTOM_SYMBOL_NAME, rates);
   if(updated&lt;0)
     {
      PrintFormat(&quot;CustomRatesUpdate(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas
      return;
     }
//--- obtemos e imprimimos no log o n√∫mero de barras do s√≠mbolo personalizado ap√≥s adi
   bars_custom=Bars(CUSTOM_SYMBOL_NAME, PERIOD_M1);
   PrintFormat(&quot;\nAfter CustomRatesUpdate(), the custom symbol &#x27;%s&#x27; has %d bars of min
//--- obtemos os dados de todas as barras do timeframe de minutos do s√≠mbolo personali
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars_custom, rates)!=bars_custom)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2186
</p>
<pre><code class="language-mql5">
//--- imprimimos no log as √∫ltimas quatro barras do hist√≥rico de minutos do s√≠mbolo pe
   int digits=(int)SymbolInfoInteger(CUSTOM_SYMBOL_NAME, SYMBOL_DIGITS);
   PrintFormat(&quot;Last %d bars of the custom symbol&#x27;s minute history:&quot;, DATARATES_COUNT)
   ArrayPrint(rates, digits, NULL, bars_custom-DATARATES_COUNT, DATARATES_COUNT);
   
//--- alteramos os dados no array MqlRates para os calculados usando f√≥rmula 1.0 / Sym
   for(int i=0; i&lt;bars_custom; i++)
     {
      rates[i].open  =(rates[i].open !=0  ? 1.0 / rates[i].open  : rates[i].open);
      rates[i].high  =(rates[i].high !=0  ? 1.0 / rates[i].high  : rates[i].high);
      rates[i].low   =(rates[i].low  !=0  ? 1.0 / rates[i].low   : rates[i].low);
      rates[i].close =(rates[i].close!=0  ? 1.0 / rates[i].close : rates[i].close);
     }
//--- definimos os dados alterados no hist√≥rico de minutos do s√≠mbolo personalizado
   ResetLastError();
   updated=CustomRatesUpdate(CUSTOM_SYMBOL_NAME, rates);
   if(updated&lt;0)
     {
      PrintFormat(&quot;CustomRatesUpdate(%s) failed. Error %d&quot;, CUSTOM_SYMBOL_NAME, GetLas
      return;
     }
//--- obtemos novamente no array MqlRates os dados de todas as barras do timeframe de 
   ResetLastError();
   if(CopyRates(CUSTOM_SYMBOL_NAME, PERIOD_M1, 0, bars_custom, rates)!=bars_custom)
     {
      PrintFormat(&quot;CopyRates(%s, PERIOD_M1, 0, %d) failed. Error %d&quot;, CUSTOM_SYMBOL_NA
      return;
     }
//--- imprimimos no log as √∫ltimas quatro barras do hist√≥rico de minutos atualizado do
   Print(&quot;\nLast %d bars after changing the custom symbol calculation formula:&quot;, DATAR
   ArrayPrint(rates, digits, NULL, bars_custom-DATARATES_COUNT, DATARATES_COUNT);
   
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2187
</p>
<pre><code class="language-mql5">
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
¬†  resultado:
   The symbol &#x27;EURUSD&#x27; from which the custom &#x27;EURUSD.C&#x27; was created has 250488 bars of
   Custom symbol &#x27;EURUSD.C&#x27; created from symbol &#x27;EURUSD&#x27; has 0 bars of minute history
   
   After CustomRatesUpdate(), the custom symbol &#x27;EURUSD.C&#x27; has 250488 bars of minute h
   Last 4 bars of the custom symbol&#x27;s minute history:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea
   [0] 2024.06.18 11:14:00 1.07235 1.07239 1.07232 1.07239            24        0     
   [1] 2024.06.18 11:15:00 1.07238 1.07239 1.07232 1.07235            44        0     
   [2] 2024.06.18 11:16:00 1.07234 1.07238 1.07227 1.07234            37        0     
   [3] 2024.06.18 11:17:00 1.07234 1.07234 1.07217 1.07225            41        0     
   
   Last 4 bars after changing the custom symbol calculation formula:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [rea
   [0] 2024.06.18 11:14:00 0.93253 0.93250 0.93256 0.93250            24        0     
   [1] 2024.06.18 11:15:00 0.93251 0.93250 0.93256 0.93253            44        0     
   [2] 2024.06.18 11:16:00 0.93254 0.93251 0.93260 0.93254            37        0     
   [3] 2024.06.18 11:17:00 0.93254 0.93254 0.93269 0.93262            41        0     
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2188
</p>
<pre><code class="language-mql5">
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
<h3>CustomRatesReplace, CustomRatesDelete, CopyRates</h3></p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2189
<h3>CustomTicksAdd</h3>
Adds data from an array of the MqlTick type to the price history of a custom symbol. The custom
symbol must be selected in the Market Watch window. 
</p>
<pre><code class="language-mql5">
bool¬† CustomTicksAdd(
   const string¬†    symbol,¬†            // Symbol name
   const MqlTick&amp;   ticks[],            // The array with tick data that should be app
   uint¬†            count=WHOLE_ARRAY¬†  // n√∫mero de elementos a serem usados a partir
   );
</code></pre>
<p>
<h3>Parameters</h3>
symbol
[in]  The name of the custom symbol.
ticks[]
[in]   An array of tick data of the MqlTick type arranged in order of time from earlier data to more
recent ones, i.e. ticks[k].time_msc &lt;= ticks[n].time_msc, if k&lt;n.
count=WHOLE_ARRAY
[in]  N√∫mero de elementos da matriz ticks[] a serem utilizados para adi√ß√£o. O valor
WHOLE_ARRAY indica que √© necess√°rio usar todos os elementos da matriz ticks[].
<h3>Return Value</h3>
N√∫mero de ticks adicionados ou -1 em caso de erro.
<h3>Further Note</h3>
The CustomTicksAdd function only works for custom symbols opened in the Market Watch window. If
the symbol is not selected in Market Watch, then you should add ticks using CustomTicksReplace.
A fun√ß√£o CustomTicksAdd permite transmitir ticks como se chegassem desde o servidor da
corretora. Os dados n√£o s√£o salvos diretamente no banco de dados de ticks, em vez disso, s√£o
enviados para a janela &quot;Observa√ß√£o do mercado&quot;. √â a partir dela que o terminal armazena os ticks
em sua base. Quando a quantidade de dados transferidos por chamada √© grande, a fun√ß√£o altera seu
comportamento para poupar recursos. Se forem transferidos mais de 256 ticks, os dados ser√£o
divididos em duas partes. A primeira parte (grande) √© imediatamente carregada diretamente na
base de ticks (como faz a CustomTicksReplace). A segunda parte, que consiste nos √∫ltimos 128
ticks, √© transferida para a janela &quot;Observa√ß√£o do mercado&quot; e, em seguida, √© salva pelo terminal no
banco de dados de ticks.
A estrutura MqlTick possui dois valores de campo com valores temporais, isto √©, time (hora do tick
em segundos) e time_msc (hora de tick em milissegundos). Eles realizam o c√°lculo desde 01 de
janeiro de 1970. Nos ticks adicionados, o processamento destes campos √© realizado acordo com as
seguintes regras na ordem estabelecida:
1. se o valor for ticks[k].time_msc!=0, usamo-lo para preenchimento do campo ticks[k].time, quer
dizer, para o tick √© definido o tempo ticks[k].time=ticks[k].time_msc/1000 (divis√£o inteira)
2. se ticks[k].time_msc==0 e ticks[k].time!=0, a hora em milissegundos √© obtida pela multiplica√ß√£o
por 1000, isto √©,¬†ticks[k].time_msc=ticks[k].time*1000
3. se ticks[k].time_msc==0 e ticks[k].time==0, nestes campos √© registrado o tempo atual do
servidor de negocia√ß√£o em milissegundos quando chamada a fun√ß√£oCustomTicksAdd.</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2190
Se o valor dos campos ticks[k].bid, ticks[k].ask, ticks[k].last ou ticks[k].volume for maior do que
zero, no campo  ticks[k].flags, √© escrita a combina√ß√£o dos sinalizadores correspondentes:
¬∑ TICK_FLAG_BID ‚Äì tick alterou o pre√ßo Bid
¬∑ TICK_FLAG_ASK  ‚Äì tick alterou o pre√ßo Ask
¬∑ TICK_FLAG_LAST ‚Äì tick alterou o pre√ßo da √∫ltima transa√ß√£o
¬∑ TICK_FLAG_VOLUME ‚Äì tick mudou o volume
Se o valor de campo √© menor ou igual a zero, o sinalizador correspondente n√£o √© gravado nos campo
ticks[k].flags.
Sinalizadores TICK_FLAG_BUY e TICK_FLAG_SELL n√£o s√£o adicionados no hist√≥rico do instrumento
personalizado.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                               CustomTicksAdd.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATATICKS_TO_COPY      UINT_MAX          // quantidade de ticks copiados
#define   DATATICKS_TO_PRINT     20                // quantidade de ticks exibidos no 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos no array MqlTick os dados de ticks do s√≠mbolo padr√£o
   MqlTick array[]={};
   if(!GetTicksToArray(CUSTOM_SYMBOL_ORIGIN, DATATICKS_TO_COPY, array))
      return;
   </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2191
</p>
<pre><code class="language-mql5">
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo padr√£o
   int total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo padr√£o
   PrintFormat(&quot;\nThe last %d ticks for the standard symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }
   
//--- adicionamos o s√≠mbolo personalizado na janela MarketWatch (observa√ß√£o do mercado
   ResetLastError();
   if(!SymbolSelect(CUSTOM_SYMBOL_NAME, true))
     {
      Print(&quot;SymbolSelect() failed. Error &quot;, GetLastError());
      return;
     }
     
//--- adicionamos √† hist√≥ria de pre√ßos do s√≠mbolo personalizado os dados do array de t
   Print(&quot;...&quot;);
   uint start=GetTickCount();
   PrintFormat(&quot;Start of adding %u ticks to the history of the custom symbol &#x27;%s&#x27;&quot;, ar
   int added=CustomTicksAdd(CUSTOM_SYMBOL_NAME, array);
   PrintFormat(&quot;Added %u ticks to the history of the custom symbol &#x27;%s&#x27; in %u ms&quot;, add
   
//--- obtemos no array MqlTick os dados de ticks do s√≠mbolo personalizado
   Print(&quot;...&quot;);
   if(!GetTicksToArray(CUSTOM_SYMBOL_NAME, array.Size(), array))
      return;
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo personalizado
   total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo personalizado
   PrintFormat(&quot;\nThe last %d ticks for the custom symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT, 
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2192
</p>
<pre><code class="language-mql5">
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   Requested 4294967295 ticks to download tick history for the symbol &#x27;EURUSD&#x27;
   The tick history for the &#x27;EURUSD&#x27; symbol is received in the amount of 351183943 tic
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.20 21:18:12.010
   
   The last 20 ticks for the standard symbol &#x27;EURUSD&#x27;:
     351183923th Tick: 2024.06.20 21:17:46.380 Bid=1.07124 (Info tick)
     351183924th Tick: 2024.06.20 21:17:47.779 Ask=1.07125 Bid=1.07125 (Info tick)
     351183925th Tick: 2024.06.20 21:17:48.584 Ask=1.07124 Bid=1.07124 (Info tick)
     351183926th Tick: 2024.06.20 21:17:49.481 Ask=1.07125 (Info tick)
     351183927th Tick: 2024.06.20 21:17:49.985 Ask=1.07122 Bid=1.07122 (Info tick)
     351183928th Tick: 2024.06.20 21:17:50.482 Ask=1.07124 Bid=1.07124 (Info tick)
     351183929th Tick: 2024.06.20 21:17:51.584 Ask=1.07123 Bid=1.07123 (Info tick)
     351183930th Tick: 2024.06.20 21:17:52.786 Ask=1.07124 Bid=1.07124 (Info tick)
     351183931th Tick: 2024.06.20 21:17:53.487 Ask=1.07125 Bid=1.07125 (Info tick)
     351183932th Tick: 2024.06.20 21:17:53.989 Ask=1.07126 Bid=1.07126 (Info tick)
     351183933th Tick: 2024.06.20 21:17:55.789 Ask=1.07125 Bid=1.07125 (Info tick)
     351183934th Tick: 2024.06.20 21:17:58.495 Ask=1.07126 Bid=1.07126 (Info tick)
     351183935th Tick: 2024.06.20 21:18:00.102 Bid=1.07126 (Info tick)
     351183936th Tick: 2024.06.20 21:18:00.698 Ask=1.07129 Bid=1.07129 (Info tick)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2193
</p>
<pre><code class="language-mql5">
     351183937th Tick: 2024.06.20 21:18:03.699 Bid=1.07129 (Info tick)
     351183938th Tick: 2024.06.20 21:18:04.699 Ask=1.07128 Bid=1.07128 (Info tick)
     351183939th Tick: 2024.06.20 21:18:05.901 Ask=1.07129 Bid=1.07129 (Info tick)
     351183940th Tick: 2024.06.20 21:18:07.606 Ask=1.07128 Bid=1.07128 (Info tick)
     351183941th Tick: 2024.06.20 21:18:11.512 Ask=1.07127 Bid=1.07127 (Info tick)
     351183942th Tick: 2024.06.20 21:18:12.010 Ask=1.07126 Bid=1.07126 (Info tick)
   ...
   Start of adding 351183943 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27;
   Added 351183943 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27; in 269890 ms
   ...
   Requested 351183943 ticks to download tick history for the symbol &#x27;EURUSD.C&#x27;
   The tick history for the &#x27;EURUSD.C&#x27; symbol is received in the amount of 351183943 t
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.20 21:18:12.010
   
   The last 20 ticks for the custom symbol &#x27;EURUSD.C&#x27;:
     351183923th Tick: 2024.06.20 21:17:46.380 Ask=1.07124 Bid=1.07124 (Info tick)
     351183924th Tick: 2024.06.20 21:17:47.779 Ask=1.07125 Bid=1.07125 (Info tick)
     351183925th Tick: 2024.06.20 21:17:48.584 Ask=1.07124 Bid=1.07124 (Info tick)
     351183926th Tick: 2024.06.20 21:17:49.481 Ask=1.07125 Bid=1.07125 (Info tick)
     351183927th Tick: 2024.06.20 21:17:49.985 Ask=1.07122 Bid=1.07122 (Info tick)
     351183928th Tick: 2024.06.20 21:17:50.482 Ask=1.07124 Bid=1.07124 (Info tick)
     351183929th Tick: 2024.06.20 21:17:51.584 Ask=1.07123 Bid=1.07123 (Info tick)
     351183930th Tick: 2024.06.20 21:17:52.786 Ask=1.07124 Bid=1.07124 (Info tick)
     351183931th Tick: 2024.06.20 21:17:53.487 Ask=1.07125 Bid=1.07125 (Info tick)
     351183932th Tick: 2024.06.20 21:17:53.989 Ask=1.07126 Bid=1.07126 (Info tick)
     351183933th Tick: 2024.06.20 21:17:55.789 Ask=1.07125 Bid=1.07125 (Info tick)
     351183934th Tick: 2024.06.20 21:17:58.495 Ask=1.07126 Bid=1.07126 (Info tick)
     351183935th Tick: 2024.06.20 21:18:00.102 Ask=1.07126 Bid=1.07126 (Info tick)
     351183936th Tick: 2024.06.20 21:18:00.698 Ask=1.07129 Bid=1.07129 (Info tick)
     351183937th Tick: 2024.06.20 21:18:03.699 Ask=1.07129 Bid=1.07129 (Info tick)
     351183938th Tick: 2024.06.20 21:18:04.699 Ask=1.07128 Bid=1.07128 (Info tick)
     351183939th Tick: 2024.06.20 21:18:05.901 Ask=1.07129 Bid=1.07129 (Info tick)
     351183940th Tick: 2024.06.20 21:18:07.606 Ask=1.07128 Bid=1.07128 (Info tick)
     351183941th Tick: 2024.06.20 21:18:11.512 Ask=1.07127 Bid=1.07127 (Info tick)
     351183942th Tick: 2024.06.20 21:18:12.010 Ask=1.07126 Bid=1.07126 (Info tick)
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2194
</p>
<pre><code class="language-mql5">
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Obt√©m a quantidade especificada de ticks no array               |
//+------------------------------------------------------------------+
bool GetTicksToArray(const string symbol, const uint count, MqlTick &amp;array[])
  {
//--- informamos sobre o in√≠cio do carregamento dos dados hist√≥ricos
   PrintFormat(&quot;Requested %u ticks to get tick history for the symbol &#x27;%s&#x27;&quot;, count, sy
   
//--- fazemos 3 tentativas de obter ticks
   int attempts=0;
   while(attempts&lt;3)
     {
 //--- medimos o tempo de in√≠cio antes de obter ticks
      uint start=GetTickCount();
      
 //--- solicitamos a hist√≥ria de ticks desde 1970.01.01 00:00.001 (par√¢metro from=1 ms
      int received=CopyTicks(symbol, array, COPY_TICKS_ALL, 1, count);
      if(received!=-1)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2195
</p>
<pre><code class="language-mql5">
        {
 //--- informamos sobre a quantidade de ticks e o tempo gasto
         PrintFormat(&quot;The tick history for the &#x27;%s&#x27; symbol is received in the amount o
         
 //--- se a hist√≥ria de ticks estiver sincronizada, o c√≥digo de erro √© zero - retornam
         if(GetLastError()==0)
            return(true);
         PrintFormat(&quot;%s: Ticks are not synchronized yet, %d ticks received for %d ms.
                     symbol, received, GetTickCount()-start, GetLastError());
        }
 //--- contamos as tentativas
      attempts++; 
 //--- pausa de 1 segundo aguardando a conclus√£o da sincroniza√ß√£o da base de ticks
      Sleep(1000);
     }
//--- n√£o foi poss√≠vel copiar ticks em 3 tentativas
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+ 
//| retorna a descri√ß√£o do tick em formato string                    |
//+------------------------------------------------------------------+ 
string GetTickDescription(MqlTick &amp;tick) 
  { 
   string desc=StringFormat(&quot;%s.%03u &quot;, TimeToString(tick.time, TIME_DATE|TIME_MINUTES
   
//--- verificamos os flags do tick
   bool buy_tick   = ((tick.flags &amp;TICK_FLAG_BUY)   == TICK_FLAG_BUY); 
   bool sell_tick  = ((tick.flags &amp;TICK_FLAG_SELL)  == TICK_FLAG_SELL); 
   bool ask_tick   = ((tick.flags &amp;TICK_FLAG_ASK)   == TICK_FLAG_ASK); 
   bool bid_tick   = ((tick.flags &amp;TICK_FLAG_BID)   == TICK_FLAG_BID); 
   bool last_tick  = ((tick.flags &amp;TICK_FLAG_LAST)  == TICK_FLAG_LAST); 
   bool volume_tick= ((tick.flags &amp;TICK_FLAG_VOLUME)== TICK_FLAG_VOLUME); 
   
//--- verificamos primeiro os flags de negocia√ß√£o do tick (para CustomTicksAdd() n√£o h
   if(buy_tick || sell_tick) 
     { 
      //--- formatamos a sa√≠da para um tick de negocia√ß√£o
      desc += (buy_tick ? StringFormat(&quot;Buy Tick: Last=%G Volume=%d &quot;, tick.last, tick
      desc += (sell_tick? StringFormat(&quot;Sell Tick: Last=%G Volume=%d &quot;,tick.last, tick
      desc += (ask_tick ? StringFormat(&quot;Ask=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += (bid_tick ? StringFormat(&quot;Bid=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += &quot;(Trade tick)&quot;; 
     } 
   else 
     { 
      //--- para um tick de informa√ß√£o, formatamos a sa√≠da de forma um pouco diferente
      desc += (ask_tick   ? StringFormat(&quot;Ask=%G &quot;,  tick.ask)    : &quot;&quot;); 
      desc += (bid_tick   ? StringFormat(&quot;Bid=%G &quot;,  tick.ask)    : &quot;&quot;); </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2196
</p>
<pre><code class="language-mql5">
      desc += (last_tick  ? StringFormat(&quot;Last=%G &quot;, tick.last)   : &quot;&quot;); 
      desc += (volume_tick? StringFormat(&quot;Volume=%d &quot;,tick.volume): &quot;&quot;); 
      desc += &quot;(Info tick)&quot;; 
     } 
//--- retornamos a descri√ß√£o do tick
   return(desc); 
</code></pre>
<p>
  } 
<h3>Veja tamb√©m</h3>
CustomRatesDelete, CustomRatesUpdate, CustomTicksReplace, CopyTicks, CopyTicksRange</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2197
<h3>CustomTicksDelete</h3>
Exclui todos os ticks no hist√≥rico de pre√ßo do instrumento personalizado, no intervalo de tempo
selecionado.
</p>
<pre><code class="language-mql5">
int¬† CustomTicksDelete(
   const string¬†    symbol,¬†           // nome do s√≠mbolo
   long    ¬†        from_msc,          // a partir de qual data
   long    ¬†        to_msc             // at√© qual data
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
from_msc
[in]  Tempo do primeiro tick no hist√≥rico de pre√ßo, na faixa definida a ser removida. Tempo em
milissegundos desde 01.01.1970.
to_msc
[in]  Tempo do √∫ltimo tick no hist√≥rico de pre√ßo, na faixa definida a ser removida. Tempo em
milissegundos desde 01.01.1970.
<h3>Valor de retorno</h3>
N√∫mero de ticks removidos ou -1 em caso de erro.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            CustomTicksDelete.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATATICKS_TO_COPY      UINT_MAX          // quantidade de ticks copiados
#define DATATICKS_TO_DELETE 10 // quantidade de ticks a serem deletados
#define   DATATICKS_TO_PRINT     20                // quantidade de ticks exibidos no 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2198
</p>
<pre><code class="language-mql5">
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos no array MqlTick os dados de ticks do s√≠mbolo padr√£o
   MqlTick array[]={};
   if(!GetTicksToArray(CUSTOM_SYMBOL_ORIGIN, DATATICKS_TO_COPY, array))
      return;
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo padr√£o
   int total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time,TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo padr√£o
   PrintFormat(&quot;\nThe last %d ticks for the standard symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }
   
//--- adicionamos o s√≠mbolo personalizado na janela MarketWatch (observa√ß√£o do mercado
   ResetLastError();
   if(!SymbolSelect(CUSTOM_SYMBOL_NAME, true))
     {
      Print(&quot;SymbolSelect() failed. Error &quot;, GetLastError());
      return;
     }
     
//--- adicionamos √† hist√≥ria de pre√ßos do s√≠mbolo personalizado os dados do array de t
   Print(&quot;...&quot;);
   uint start=GetTickCount();
   PrintFormat(&quot;Start of adding %u ticks to the history of the custom symbol &#x27;%s&#x27;&quot;, ar
   int added=CustomTicksAdd(CUSTOM_SYMBOL_NAME, array);
   PrintFormat(&quot;Added %u ticks to the history of the custom symbol &#x27;%s&#x27; in %u ms&quot;, add
   
//--- obtemos no array MqlTick os dados de ticks rec√©m-adicionados do s√≠mbolo personal
   Print(&quot;...&quot;);
   if(!GetTicksToArray(CUSTOM_SYMBOL_NAME, array.Size(), array))
      return;
   </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2199
</p>
<pre><code class="language-mql5">
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo personalizado
   total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo personalizado
   PrintFormat(&quot;\nThe last %d ticks for the custom symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT, 
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }
//--- obtemos da hist√≥ria o hor√°rio do tick em milissegundos, a partir do qual iremos 
   long time_from=array[total-DATATICKS_TO_DELETE-1].time_msc;
     
//--- deletamos o intervalo de DATATICKS_TO_DELETE √∫ltimos ticks do s√≠mbolo personaliz
   Print(&quot;...&quot;);
   start=GetTickCount();
   PrintFormat(&quot;Start deleting %u ticks in the history of the custom symbol &#x27;%s&#x27;&quot;, DAT
   int deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, time_from, array[total-2].time_ms
   PrintFormat(&quot;Deleted %u ticks in the history of the custom symbol &#x27;%s&#x27; in %u ms&quot;, d
   
//--- obtemos no array MqlTick os dados de ticks rec√©m-alterados do s√≠mbolo personaliz
   Print(&quot;...&quot;);
   if(!GetTicksToArray(CUSTOM_SYMBOL_NAME, array.Size(), array))
      return;
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick do s√≠mbolo personalizado com o in
   total=(int)array.Size();
   PrintFormat(&quot;Time of the first tick from the changed history: %s.%03u, Time of the 
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo personalizado
   PrintFormat(&quot;\nThe last %d ticks of custom symbol &#x27;%s&#x27; with modified history:&quot;, DAT
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2200
</p>
<pre><code class="language-mql5">
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   Requested 4294967295 ticks to get tick history for the symbol &#x27;EURUSD&#x27;
   The tick history for the &#x27;EURUSD&#x27; symbol is received in the amount of 351199027 tic
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.21 10:10:40.392
   
   The last 20 ticks for the standard symbol &#x27;EURUSD&#x27;:
     351199007th Tick: 2024.06.21 10:10:23.045 Bid=1.07032 (Info tick)
     351199008th Tick: 2024.06.21 10:10:24.045 Ask=1.07031 Bid=1.07031 (Info tick)
     351199009th Tick: 2024.06.21 10:10:24.545 Ask=1.07032 (Info tick)
     351199010th Tick: 2024.06.21 10:10:25.146 Bid=1.07032 (Info tick)
     351199011th Tick: 2024.06.21 10:10:25.649 Ask=1.07037 Bid=1.07037 (Info tick)
     351199012th Tick: 2024.06.21 10:10:27.050 Ask=1.07036 Bid=1.07036 (Info tick)
     351199013th Tick: 2024.06.21 10:10:28.153 Ask=1.07039 Bid=1.07039 (Info tick)
     351199014th Tick: 2024.06.21 10:10:29.157 Ask=1.07037 Bid=1.07037 (Info tick)
     351199015th Tick: 2024.06.21 10:10:29.658 Ask=1.07036 Bid=1.07036 (Info tick)
     351199016th Tick: 2024.06.21 10:10:30.258 Bid=1.07036 (Info tick)
     351199017th Tick: 2024.06.21 10:10:30.872 Ask=1.07035 Bid=1.07035 (Info tick)
     351199018th Tick: 2024.06.21 10:10:31.358 Ask=1.07036 (Info tick)
     351199019th Tick: 2024.06.21 10:10:31.859 Ask=1.07037 Bid=1.07037 (Info tick)
     351199020th Tick: 2024.06.21 10:10:32.377 Ask=1.07039 Bid=1.07039 (Info tick)
     351199021th Tick: 2024.06.21 10:10:32.962 Ask=1.0704 Bid=1.0704 (Info tick)
     351199022th Tick: 2024.06.21 10:10:33.961 Ask=1.07039 Bid=1.07039 (Info tick)
     351199023th Tick: 2024.06.21 10:10:34.667 Ask=1.0704 (Info tick)
     351199024th Tick: 2024.06.21 10:10:35.170 Bid=1.0704 (Info tick)
     351199025th Tick: 2024.06.21 10:10:38.266 Ask=1.07041 Bid=1.07041 (Info tick)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2201
</p>
<pre><code class="language-mql5">
     351199026th Tick: 2024.06.21 10:10:40.392 Ask=1.07042 Bid=1.07042 (Info tick)
   ...
   Start of adding 351199027 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27;
   Added 351199027 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27; in 261594 ms
   ...
   Requested 351199027 ticks to get tick history for the symbol &#x27;EURUSD.C&#x27;
   The tick history for the &#x27;EURUSD.C&#x27; symbol is received in the amount of 351199027 t
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.21 10:10:40.392
   
   The last 20 ticks for the custom symbol &#x27;EURUSD.C&#x27;:
     351199007th Tick: 2024.06.21 10:10:23.045 Ask=1.07032 Bid=1.07032 (Info tick)
     351199008th Tick: 2024.06.21 10:10:24.045 Ask=1.07031 Bid=1.07031 (Info tick)
     351199009th Tick: 2024.06.21 10:10:24.545 Ask=1.07032 Bid=1.07032 (Info tick)
     351199010th Tick: 2024.06.21 10:10:25.146 Ask=1.07032 Bid=1.07032 (Info tick)
     351199011th Tick: 2024.06.21 10:10:25.649 Ask=1.07037 Bid=1.07037 (Info tick)
     351199012th Tick: 2024.06.21 10:10:27.050 Ask=1.07036 Bid=1.07036 (Info tick)
     351199013th Tick: 2024.06.21 10:10:28.153 Ask=1.07039 Bid=1.07039 (Info tick)
     351199014th Tick: 2024.06.21 10:10:29.157 Ask=1.07037 Bid=1.07037 (Info tick)
     351199015th Tick: 2024.06.21 10:10:29.658 Ask=1.07036 Bid=1.07036 (Info tick)
     351199016th Tick: 2024.06.21 10:10:30.258 Ask=1.07036 Bid=1.07036 (Info tick)
     351199017th Tick: 2024.06.21 10:10:30.872 Ask=1.07035 Bid=1.07035 (Info tick)
     351199018th Tick: 2024.06.21 10:10:31.358 Ask=1.07036 Bid=1.07036 (Info tick)
     351199019th Tick: 2024.06.21 10:10:31.859 Ask=1.07037 Bid=1.07037 (Info tick)
     351199020th Tick: 2024.06.21 10:10:32.377 Ask=1.07039 Bid=1.07039 (Info tick)
     351199021th Tick: 2024.06.21 10:10:32.962 Ask=1.0704 Bid=1.0704 (Info tick)
     351199022th Tick: 2024.06.21 10:10:33.961 Ask=1.07039 Bid=1.07039 (Info tick)
     351199023th Tick: 2024.06.21 10:10:34.667 Ask=1.0704 Bid=1.0704 (Info tick)
     351199024th Tick: 2024.06.21 10:10:35.170 Ask=1.0704 Bid=1.0704 (Info tick)
     351199025th Tick: 2024.06.21 10:10:38.266 Ask=1.07041 Bid=1.07041 (Info tick)
     351199026th Tick: 2024.06.21 10:10:40.392 Ask=1.07042 Bid=1.07042 (Info tick)
   ...
   Start deleting 10 ticks in the history of the custom symbol &#x27;EURUSD.C&#x27;
   Deleted 10 ticks in the history of the custom symbol &#x27;EURUSD.C&#x27; in 188 ms
   ...
   Requested 351199027 ticks to get tick history for the symbol &#x27;EURUSD.C&#x27;
   The tick history for the &#x27;EURUSD.C&#x27; symbol is received in the amount of 351199017 t
   Time of the first tick from the changed history: 2011.12.19 00:00:08.000, Time of t
   
   The last 20 ticks of custom symbol &#x27;EURUSD.C&#x27; with modified history:
     351198997th Tick: 2024.06.21 10:10:14.935 Ask=1.07036 Bid=1.07036 (Info tick)
     351198998th Tick: 2024.06.21 10:10:15.533 Ask=1.07035 Bid=1.07035 (Info tick)
     351198999th Tick: 2024.06.21 10:10:17.736 Ask=1.07036 Bid=1.07036 (Info tick)
     351199000th Tick: 2024.06.21 10:10:18.540 Ask=1.07037 Bid=1.07037 (Info tick)
     351199001th Tick: 2024.06.21 10:10:19.046 Ask=1.07038 Bid=1.07038 (Info tick)
     351199002th Tick: 2024.06.21 10:10:19.542 Ask=1.07036 Bid=1.07036 (Info tick)
     351199003th Tick: 2024.06.21 10:10:20.041 Ask=1.07035 Bid=1.07035 (Info tick)
     351199004th Tick: 2024.06.21 10:10:21.041 Ask=1.07035 Bid=1.07035 (Info tick)
     351199005th Tick: 2024.06.21 10:10:21.544 Ask=1.07032 Bid=1.07032 (Info tick)
     351199006th Tick: 2024.06.21 10:10:22.344 Ask=1.07032 Bid=1.07032 (Info tick)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2202
</p>
<pre><code class="language-mql5">
     351199007th Tick: 2024.06.21 10:10:23.045 Ask=1.07032 Bid=1.07032 (Info tick)
     351199008th Tick: 2024.06.21 10:10:24.045 Ask=1.07031 Bid=1.07031 (Info tick)
     351199009th Tick: 2024.06.21 10:10:24.545 Ask=1.07032 Bid=1.07032 (Info tick)
     351199010th Tick: 2024.06.21 10:10:25.146 Ask=1.07032 Bid=1.07032 (Info tick)
     351199011th Tick: 2024.06.21 10:10:25.649 Ask=1.07037 Bid=1.07037 (Info tick)
     351199012th Tick: 2024.06.21 10:10:27.050 Ask=1.07036 Bid=1.07036 (Info tick)
     351199013th Tick: 2024.06.21 10:10:28.153 Ask=1.07039 Bid=1.07039 (Info tick)
     351199014th Tick: 2024.06.21 10:10:29.157 Ask=1.07037 Bid=1.07037 (Info tick)
     351199015th Tick: 2024.06.21 10:10:29.658 Ask=1.07036 Bid=1.07036 (Info tick)
     351199016th Tick: 2024.06.21 10:10:40.392 Ask=1.07042 Bid=1.07042 (Info tick)
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2203
</p>
<pre><code class="language-mql5">
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Obt√©m a quantidade especificada de ticks no array               |
//+------------------------------------------------------------------+
bool GetTicksToArray(const string symbol, const uint count, MqlTick &amp;array[])
  {
//--- informamos sobre o in√≠cio do carregamento dos dados hist√≥ricos
   PrintFormat(&quot;Requested %u ticks to get tick history for the symbol &#x27;%s&#x27;&quot;, count, sy
   
//--- fazemos 3 tentativas de obter ticks
   int attempts=0;
   while(attempts&lt;3)
     {
 //--- medimos o tempo de in√≠cio antes de obter ticks
      uint start=GetTickCount();
      
 //--- solicitamos a hist√≥ria de ticks desde 1970.01.01 00:00.001 (par√¢metro from=1 ms
      int received=CopyTicks(symbol, array, COPY_TICKS_ALL, 1, count);
      if(received!=-1)
        {
 //--- informamos sobre a quantidade de ticks e o tempo gasto
         PrintFormat(&quot;The tick history for the &#x27;%s&#x27; symbol is received in the amount o
         
 //--- se a hist√≥ria de ticks estiver sincronizada, o c√≥digo de erro √© zero - retornam
         if(GetLastError()==0)
            return(true);
         PrintFormat(&quot;%s: Ticks are not synchronized yet, %d ticks received for %d ms.
                     symbol, received, GetTickCount()-start, GetLastError());
        }
 //--- contamos as tentativas
      attempts++; 
 //--- pausa de 1 segundo aguardando a conclus√£o da sincroniza√ß√£o da base de ticks
      Sleep(1000);
     }
//--- n√£o foi poss√≠vel copiar ticks em 3 tentativas
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+ 
//| retorna a descri√ß√£o do tick em formato string                    |
//+------------------------------------------------------------------+ 
string GetTickDescription(MqlTick &amp;tick) 
  { 
   string desc=StringFormat(&quot;%s.%03u &quot;, TimeToString(tick.time, TIME_DATE|TIME_MINUTES</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2204
</p>
<pre><code class="language-mql5">
   
//--- verificamos os flags do tick
   bool buy_tick   = ((tick.flags &amp;TICK_FLAG_BUY)   == TICK_FLAG_BUY); 
   bool sell_tick  = ((tick.flags &amp;TICK_FLAG_SELL)  == TICK_FLAG_SELL); 
   bool ask_tick   = ((tick.flags &amp;TICK_FLAG_ASK)   == TICK_FLAG_ASK); 
   bool bid_tick   = ((tick.flags &amp;TICK_FLAG_BID)   == TICK_FLAG_BID); 
   bool last_tick  = ((tick.flags &amp;TICK_FLAG_LAST)  == TICK_FLAG_LAST); 
   bool volume_tick= ((tick.flags &amp;TICK_FLAG_VOLUME)== TICK_FLAG_VOLUME); 
   
//--- verificamos primeiro os flags de negocia√ß√£o do tick (para CustomTicksAdd() n√£o h
   if(buy_tick || sell_tick) 
     { 
      //--- formatamos a sa√≠da para um tick de negocia√ß√£o
      desc += (buy_tick ? StringFormat(&quot;Buy Tick: Last=%G Volume=%d &quot;, tick.last, tick
      desc += (sell_tick? StringFormat(&quot;Sell Tick: Last=%G Volume=%d &quot;,tick.last, tick
      desc += (ask_tick ? StringFormat(&quot;Ask=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += (bid_tick ? StringFormat(&quot;Bid=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += &quot;(Trade tick)&quot;; 
     } 
   else 
     { 
      //--- para um tick de informa√ß√£o, formatamos a sa√≠da de forma um pouco diferente
      desc += (ask_tick   ? StringFormat(&quot;Ask=%G &quot;,  tick.ask)    : &quot;&quot;); 
      desc += (bid_tick   ? StringFormat(&quot;Bid=%G &quot;,  tick.ask)    : &quot;&quot;); 
      desc += (last_tick  ? StringFormat(&quot;Last=%G &quot;, tick.last)   : &quot;&quot;); 
      desc += (volume_tick? StringFormat(&quot;Volume=%d &quot;,tick.volume): &quot;&quot;); 
      desc += &quot;(Info tick)&quot;; 
     } 
//--- retornamos a descri√ß√£o do tick
   return(desc); 
</code></pre>
<p>
  } 
<h3>Veja tamb√©m</h3>
CustomRatesDelete, CustomRatesUpdate, CustomTicksReplace, CopyTicks, CopyTicksRange</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2205
<h3>CustomTicksReplace</h3>
Substitui todo o hist√≥rico de pre√ßo do instrumento personalizado pelos dados na matriz do tipo
MqlTick, no intervalo de tempo definido.
</p>
<pre><code class="language-mql5">
int¬† CustomTicksReplace(
   const string¬†    symbol,¬†           // nome do s√≠mbolo
   datetime¬†        from_msc,          // a partir de qual data
   datetime¬†        to_msc,            // at√© qual data
   const MqlTick&amp;   ticks[],           // matriz com dados de tick que se devem aplica
   uint¬†            count=WHOLE_ARRAY  // n√∫mero de elementos a serem usados a partir 
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
from_msc
[in]  Tempo do primeiro tick no hist√≥rico de pre√ßo, na faixa definida a ser removida. Tempo em
milissegundos desde 01.01.1970.
to_msc
[in]  Tempo do √∫ltimo tick no hist√≥rico de pre√ßo, na faixa definida a ser removida. Tempo em
milissegundos desde 01.01.1970.
ticks[]
[in]   Matriz dos dados de tick - de tipo MqlTick - classificados segundo o tempo em ordem
crescente.
count=WHOLE_ARRAY
[in]  N√∫mero de elementos da matriz ticks[] que ser√° usado para substituir no intervalo de tempo
especificado. O valor WHOLE_ARRAY indica que √© necess√°rio usar todos os elementos da matriz
ticks[].
<h3>Valor de retorno</h3>
true, em caso de sucesso, caso contr√°rio, false. Para obter informa√ß√µes sobre o erro, voc√™ deve
chamar a fun√ß√£o GetLastError().
<h3>Geral</h3>
Como, no canal de cota√ß√µes, muitas vezes alguns ticks podem ter o mesmo tempo com uma
precis√£o de milissegundos (a hora do tick √© armazenado no campo time_msc da estrutura MqlTick),
a fun√ß√£o CustomTicksReplace n√£o classifica automaticamente os elementos da matriz ticks[] de
acordo com o tempo. Portanto, a matriz de ticks deve ser pr√©-ordenada por tempo ascendente. 
Os ticks s√£o substitu√≠dos sequencialmente, dia ap√≥s dia, at√© a hora especificada em to_msc ou at√©
que ocorra um erro. Primeiro, √© processado o primeiro dia da faixa especificada, em seguida, o
seguinte, e assim por diante. Assim que encontrada uma discrep√¢ncia no tempo do tick quanto √†
ordem crescente (n√£o decrescente), √© interrompido o processo de substitui√ß√£o de ticks para o dia
atual. Ao acontecer isto, os ticks do dia anterior s√£o substitu√≠dos com sucesso, enquanto o dia atual</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2206
(no momento do tick errado) e todos os dias restantes no intervalo definido permanecer√£o
inalterados.
Se, na matriz ticks[], n√£o existirem dados de tick um certo dia (de um modo geral, um intervalo de
qualquer dura√ß√£o), ap√≥s serem implementados os ticks da ticks[], no hist√≥rico do instrumento
personalizado √© formado um &quot;buraco&quot;, que corresponde aos dados em falta. Em outras palavras, a
chamada de CustomTicksReplace com os ticks em falta para uma determinada faixa ser√°
equivalente √† remo√ß√£o da parte do hist√≥rico de negocia√ß√£o, como se fosse chamado
CustomTicksDelete com um intervalo &quot;buracado&quot;. 
Se n√£o houver dados no banco de dados de ticks no intervalo de tempo especificado, a
CustomTicksReplace simplesmente adicionar√° os ticks da matriz ticks[] a ele.
A fun√ß√£o CustomTicksReplace funciona diretamente com o banco de dados de ticks.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           CustomTicksReplace.mq5 |
//|                                  Copyright 2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#define   CUSTOM_SYMBOL_NAME     Symbol()+&quot;.C&quot;     // nome do s√≠mbolo personalizado
#define   CUSTOM_SYMBOL_PATH     &quot;Forex&quot;           // nome do grupo onde o s√≠mbolo ser
#define   CUSTOM_SYMBOL_ORIGIN   Symbol()          // nome do s√≠mbolo usado como base 
#define   DATATICKS_TO_COPY      UINT_MAX          // quantidade de ticks copiados
#define   DATATICKS_TO_PRINT     20                // quantidade de ticks exibidos no 
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos o c√≥digo de erro ao criar o s√≠mbolo personalizado
   int create=CreateCustomSymbol(CUSTOM_SYMBOL_NAME, CUSTOM_SYMBOL_PATH, CUSTOM_SYMBOL
   
//--- se o c√≥digo de erro n√£o for 0 (cria√ß√£o bem-sucedida do s√≠mbolo) e n√£o for 5304 
   if(create!=0 &amp;&amp; create!=5304)
      return;
//--- obtemos no array MqlTick os dados de ticks do s√≠mbolo padr√£o
   MqlTick array[]={};
   if(!GetTicksToArray(CUSTOM_SYMBOL_ORIGIN, DATATICKS_TO_COPY, array))
      return;</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2207
</p>
<pre><code class="language-mql5">
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo padr√£o
   int total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time,TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo padr√£o
   PrintFormat(&quot;\nThe last %d ticks for the standard symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));
     }
   
//--- adicionamos o s√≠mbolo personalizado na janela MarketWatch (observa√ß√£o do mercado
   ResetLastError();
   if(!SymbolSelect(CUSTOM_SYMBOL_NAME, true))
     {
      Print(&quot;SymbolSelect() failed. Error &quot;, GetLastError());
      return;
     }
     
//--- adicionamos √† hist√≥ria de pre√ßos do s√≠mbolo personalizado os dados do array de t
   Print(&quot;...&quot;);
   uint start=GetTickCount();
   PrintFormat(&quot;Start of adding %u ticks to the history of the custom symbol &#x27;%s&#x27;&quot;, ar
   int added=CustomTicksAdd(CUSTOM_SYMBOL_NAME, array);
   PrintFormat(&quot;Added %u ticks to the history of the custom symbol &#x27;%s&#x27; in %u ms&quot;, add
   
//--- obtemos no array MqlTick os dados de ticks rec√©m-adicionados do s√≠mbolo personal
   Print(&quot;...&quot;);
   if(!GetTicksToArray(CUSTOM_SYMBOL_NAME, array.Size(), array))
      return;
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick obtido do s√≠mbolo personalizado
   total=(int)array.Size();
   PrintFormat(&quot;First tick time: %s.%03u, Last tick time: %s.%03u&quot;,
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks do s√≠mbolo personalizado
   PrintFormat(&quot;\nThe last %d ticks for the custom symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO_PRINT, 
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Tick: %s&quot;, i, GetTickDescription(array[i]));</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2208
</p>
<pre><code class="language-mql5">
     }
//--- agora, alteramos os valores Ask e Bid dos ticks no array usando a f√≥rmula Ask(Sy
   for(int i=0; i&lt;total; i++)
     {
      array[i].ask = (array[i].ask !=0 ? 1.0 / array[i].ask : array[i].ask);
      array[i].bid = (array[i].bid !=0 ? 1.0 / array[i].bid : array[i].bid);
     }
   Print(&quot;\nNow the ticks are changed&quot;);
//--- substitu√≠mos a hist√≥ria de ticks do s√≠mbolo personalizado com os dados do array 
   Print(&quot;...&quot;);
   start=GetTickCount();
   PrintFormat(&quot;Start replacing %u changed ticks in the history of the custom symbol &#x27;
   int replaced=CustomTicksReplace(CUSTOM_SYMBOL_NAME, array[0].time_msc, array[total-
   PrintFormat(&quot;Replaced %u ticks in the history of the custom symbol &#x27;%s&#x27; in %u ms&quot;, 
   
//--- obtemos no array MqlTick os dados de ticks rec√©m-substitu√≠dos do s√≠mbolo persona
   Print(&quot;...&quot;);
   if(!GetTicksToArray(CUSTOM_SYMBOL_NAME, array.Size(), array))
      return;
   
//--- imprimimos o hor√°rio do primeiro e √∫ltimo tick alterado do s√≠mbolo personalizado
   total=(int)array.Size();
   PrintFormat(&quot;First changed tick time: %s.%03u, Last changed tick time: %s.%03u&quot;,
               TimeToString(array[0].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS), array
               TimeToString(array[total-1].time, TIME_DATE|TIME_MINUTES|TIME_SECONDS),
               
//--- imprimimos no log os √∫ltimos DATATICKS_TO_PRINT ticks alterados do s√≠mbolo perso
   PrintFormat(&quot;\nThe last %d changed ticks for the custom symbol &#x27;%s&#x27;:&quot;, DATATICKS_TO
   for(int i=total-DATATICKS_TO_PRINT; i&lt;total; i++)
     {
      if(i&lt;0)
         continue;
      PrintFormat(&quot;  %dth Changed tick: %s&quot;, i, GetTickDescription(array[i]));
     }
//--- no coment√°rio do gr√°fico exibimos a dica sobre as chaves de encerramento do scri
   Comment(StringFormat(&quot;Press &#x27;Esc&#x27; to exit or &#x27;Del&#x27; to delete the &#x27;%s&#x27; symbol and ex
//--- em um loop infinito, esperamos as teclas Esc ou Del para sair
   while(!IsStopped() &amp;&amp; TerminalInfoInteger(TERMINAL_KEYSTATE_ESCAPE)==0)
     {
      Sleep(16);
      //--- ao pressionar Del, exclu√≠mos o s√≠mbolo personalizado criado e seus dados
      if(TerminalInfoInteger(TERMINAL_KEYSTATE_DELETE)&lt;0)
        {
         //--- exclu√≠mos os dados das barras
         int deleted=CustomRatesDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2209
</p>
<pre><code class="language-mql5">
            PrintFormat(&quot;%d history bars of the custom symbol &#x27;%s&#x27; were successfully d
         
         //--- exclu√≠mos os dados de ticks
         deleted=CustomTicksDelete(CUSTOM_SYMBOL_NAME, 0, LONG_MAX);
         if(deleted&gt;0)
            PrintFormat(&quot;%d history ticks of the custom symbol &#x27;%s&#x27; were successfully 
         
         //--- exclu√≠mos o s√≠mbolo
         if(DeleteCustomSymbol(CUSTOM_SYMBOL_NAME))
            PrintFormat(&quot;Custom symbol &#x27;%s&#x27; deleted successfully&quot;, CUSTOM_SYMBOL_NAME)
         break;
        }
     }
//--- antes de sair, limpamos o gr√°fico
   Comment(&quot;&quot;);
   /*
   resultado:
   Requested 4294967295 ticks to get tick history for the symbol &#x27;EURUSD&#x27;
   The tick history for the &#x27;EURUSD&#x27; symbol is received in the amount of 351195822 tic
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.21 08:39:03.113
   
   The last 20 ticks for the standard symbol &#x27;EURUSD&#x27;:
     351195802th Tick: 2024.06.21 08:38:10.076 Ask=1.07194 (Info tick)
     351195803th Tick: 2024.06.21 08:38:13.162 Ask=1.07195 (Info tick)
     351195804th Tick: 2024.06.21 08:38:13.872 Bid=1.07195 (Info tick)
     351195805th Tick: 2024.06.21 08:38:14.866 Ask=1.07194 Bid=1.07194 (Info tick)
     351195806th Tick: 2024.06.21 08:38:17.374 Bid=1.07194 (Info tick)
     351195807th Tick: 2024.06.21 08:38:18.883 Bid=1.07194 (Info tick)
     351195808th Tick: 2024.06.21 08:38:19.771 Bid=1.07194 (Info tick)
     351195809th Tick: 2024.06.21 08:38:20.873 Ask=1.07195 Bid=1.07195 (Info tick)
     351195810th Tick: 2024.06.21 08:38:22.278 Ask=1.07196 Bid=1.07196 (Info tick)
     351195811th Tick: 2024.06.21 08:38:22.775 Bid=1.07196 (Info tick)
     351195812th Tick: 2024.06.21 08:38:23.477 Bid=1.07196 (Info tick)
     351195813th Tick: 2024.06.21 08:38:38.194 Ask=1.07197 (Info tick)
     351195814th Tick: 2024.06.21 08:38:38.789 Ask=1.07196 (Info tick)
     351195815th Tick: 2024.06.21 08:38:39.290 Ask=1.07197 (Info tick)
     351195816th Tick: 2024.06.21 08:38:43.695 Ask=1.07196 (Info tick)
     351195817th Tick: 2024.06.21 08:38:52.203 Ask=1.07195 Bid=1.07195 (Info tick)
     351195818th Tick: 2024.06.21 08:38:55.105 Ask=1.07196 Bid=1.07196 (Info tick)
     351195819th Tick: 2024.06.21 08:38:57.607 Ask=1.07195 Bid=1.07195 (Info tick)
     351195820th Tick: 2024.06.21 08:39:00.512 Ask=1.07196 Bid=1.07196 (Info tick)
     351195821th Tick: 2024.06.21 08:39:03.113 Ask=1.07195 Bid=1.07195 (Info tick)
   ...
   Start of adding 351195822 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27;
   Added 351195822 ticks to the history of the custom symbol &#x27;EURUSD.C&#x27; in 349407 ms
   ...
   Requested 351195822 ticks to get tick history for the symbol &#x27;EURUSD.C&#x27;
   The tick history for the &#x27;EURUSD.C&#x27; symbol is received in the amount of 351195822 t
   First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.21 08:39:03.113</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2210
</p>
<pre><code class="language-mql5">
   
   The last 20 ticks for the custom symbol &#x27;EURUSD.C&#x27;:
     351195802th Tick: 2024.06.21 08:38:10.076 Ask=1.07194 Bid=1.07194 (Info tick)
     351195803th Tick: 2024.06.21 08:38:13.162 Ask=1.07195 Bid=1.07195 (Info tick)
     351195804th Tick: 2024.06.21 08:38:13.872 Ask=1.07195 Bid=1.07195 (Info tick)
     351195805th Tick: 2024.06.21 08:38:14.866 Ask=1.07194 Bid=1.07194 (Info tick)
     351195806th Tick: 2024.06.21 08:38:17.374 Ask=1.07194 Bid=1.07194 (Info tick)
     351195807th Tick: 2024.06.21 08:38:18.883 Ask=1.07194 Bid=1.07194 (Info tick)
     351195808th Tick: 2024.06.21 08:38:19.771 Ask=1.07194 Bid=1.07194 (Info tick)
     351195809th Tick: 2024.06.21 08:38:20.873 Ask=1.07195 Bid=1.07195 (Info tick)
     351195810th Tick: 2024.06.21 08:38:22.278 Ask=1.07196 Bid=1.07196 (Info tick)
     351195811th Tick: 2024.06.21 08:38:22.775 Ask=1.07196 Bid=1.07196 (Info tick)
     351195812th Tick: 2024.06.21 08:38:23.477 Ask=1.07196 Bid=1.07196 (Info tick)
     351195813th Tick: 2024.06.21 08:38:38.194 Ask=1.07197 Bid=1.07197 (Info tick)
     351195814th Tick: 2024.06.21 08:38:38.789 Ask=1.07196 Bid=1.07196 (Info tick)
     351195815th Tick: 2024.06.21 08:38:39.290 Ask=1.07197 Bid=1.07197 (Info tick)
     351195816th Tick: 2024.06.21 08:38:43.695 Ask=1.07196 Bid=1.07196 (Info tick)
     351195817th Tick: 2024.06.21 08:38:52.203 Ask=1.07195 Bid=1.07195 (Info tick)
     351195818th Tick: 2024.06.21 08:38:55.105 Ask=1.07196 Bid=1.07196 (Info tick)
     351195819th Tick: 2024.06.21 08:38:57.607 Ask=1.07195 Bid=1.07195 (Info tick)
     351195820th Tick: 2024.06.21 08:39:00.512 Ask=1.07196 Bid=1.07196 (Info tick)
     351195821th Tick: 2024.06.21 08:39:03.113 Ask=1.07195 Bid=1.07195 (Info tick)
   
   Now the ticks are changed
   ...
   Start replacing 351195822 changed ticks in the history of the custom symbol &#x27;EURUSD
   Replaced 351195822 ticks in the history of the custom symbol &#x27;EURUSD.C&#x27; in 452266 m
   ...
   Requested 351195822 ticks to get tick history for the symbol &#x27;EURUSD.C&#x27;
   The tick history for the &#x27;EURUSD.C&#x27; symbol is received in the amount of 351195822 t
   First changed tick time: 2011.12.19 00:00:08.000, Last changed tick time: 2024.06.2
   
   The last 20 changed ticks for the custom symbol &#x27;EURUSD.C&#x27;:
     351195802th Changed tick: 2024.06.21 08:38:10.076 Ask=0.93289 Bid=0.93289 (Info t
     351195803th Changed tick: 2024.06.21 08:38:13.162 Ask=0.93288 Bid=0.93288 (Info t
     351195804th Changed tick: 2024.06.21 08:38:13.872 Ask=0.93288 Bid=0.93288 (Info t
     351195805th Changed tick: 2024.06.21 08:38:14.866 Ask=0.93289 Bid=0.93289 (Info t
     351195806th Changed tick: 2024.06.21 08:38:17.374 Ask=0.93289 Bid=0.93289 (Info t
     351195807th Changed tick: 2024.06.21 08:38:18.883 Ask=0.93289 Bid=0.93289 (Info t
     351195808th Changed tick: 2024.06.21 08:38:19.771 Ask=0.93289 Bid=0.93289 (Info t
     351195809th Changed tick: 2024.06.21 08:38:20.873 Ask=0.93288 Bid=0.93288 (Info t
     351195810th Changed tick: 2024.06.21 08:38:22.278 Ask=0.93287 Bid=0.93287 (Info t
     351195811th Changed tick: 2024.06.21 08:38:22.775 Ask=0.93287 Bid=0.93287 (Info t
     351195812th Changed tick: 2024.06.21 08:38:23.477 Ask=0.93287 Bid=0.93287 (Info t
     351195813th Changed tick: 2024.06.21 08:38:38.194 Ask=0.93286 Bid=0.93286 (Info t
     351195814th Changed tick: 2024.06.21 08:38:38.789 Ask=0.93287 Bid=0.93287 (Info t
     351195815th Changed tick: 2024.06.21 08:38:39.290 Ask=0.93286 Bid=0.93286 (Info t
     351195816th Changed tick: 2024.06.21 08:38:43.695 Ask=0.93287 Bid=0.93287 (Info t
     351195817th Changed tick: 2024.06.21 08:38:52.203 Ask=0.93288 Bid=0.93288 (Info t</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2211
</p>
<pre><code class="language-mql5">
     351195818th Changed tick: 2024.06.21 08:38:55.105 Ask=0.93287 Bid=0.93287 (Info t
     351195819th Changed tick: 2024.06.21 08:38:57.607 Ask=0.93288 Bid=0.93288 (Info t
     351195820th Changed tick: 2024.06.21 08:39:00.512 Ask=0.93287 Bid=0.93287 (Info t
     351195821th Changed tick: 2024.06.21 08:39:03.113 Ask=0.93288 Bid=0.93288 (Info t
   */
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Cria um s√≠mbolo personalizado, retorna o c√≥digo de erro         |
//+------------------------------------------------------------------+
int CreateCustomSymbol(const string symbol_name, const string symbol_path, const strin
  {
//--- definimos o nome do s√≠mbolo usado como base para criar o s√≠mbolo personalizado
   string origin=(symbol_origin==NULL ? Symbol() : symbol_origin);
   
//--- se n√£o for poss√≠vel criar o s√≠mbolo personalizado, e isso n√£o for um erro 5304, 
   ResetLastError();
   int error=0;
   if(!CustomSymbolCreate(symbol_name, symbol_path, origin))
     {
      error=GetLastError();
      if(error!=5304)
         PrintFormat(&quot;CustomSymbolCreate(%s, %s, %s) failed. Error %d&quot;, symbol_name, s
     }
//--- sucesso
   return(error);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Exclui o s√≠mbolo personalizado                                   |
//+------------------------------------------------------------------+
bool DeleteCustomSymbol(const string symbol_name)
  {
//--- ocultamos o s√≠mbolo da janela Observa√ß√£o do Mercado
   ResetLastError();
   if(!SymbolSelect(symbol_name, false))
     {
      PrintFormat(&quot;SymbolSelect(%s, false) failed. Error %d&quot;, GetLastError());
      return(false);
     }
      
//--- se n√£o for poss√≠vel excluir o s√≠mbolo personalizado, informamos no log e retorna
   ResetLastError();
   if(!CustomSymbolDelete(symbol_name))
     {
      PrintFormat(&quot;CustomSymbolDelete(%s) failed. Error %d&quot;, symbol_name, GetLastError
      return(false);
     }
//--- sucesso
   return(true);
</code></pre>
<p>
  }</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2212
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Obt√©m a quantidade especificada de ticks no array               |
//+------------------------------------------------------------------+
bool GetTicksToArray(const string symbol, const uint count, MqlTick &amp;array[])
  {
//--- informamos sobre o in√≠cio do carregamento dos dados hist√≥ricos
   PrintFormat(&quot;Requested %u ticks to get tick history for the symbol &#x27;%s&#x27;&quot;, count, sy
   
//--- fazemos 3 tentativas de obter ticks
   int attempts=0;
   while(attempts&lt;3)
     {
 //--- medimos o tempo de in√≠cio antes de obter ticks
      uint start=GetTickCount();
      
 //--- solicitamos a hist√≥ria de ticks desde 1970.01.01 00:00.001 (par√¢metro from=1 ms
      int received=CopyTicks(symbol, array, COPY_TICKS_ALL, 1, count);
      if(received!=-1)
        {
 //--- informamos sobre a quantidade de ticks e o tempo gasto
         PrintFormat(&quot;The tick history for the &#x27;%s&#x27; symbol is received in the amount o
         
 //--- se a hist√≥ria de ticks estiver sincronizada, o c√≥digo de erro √© zero - retornam
         if(GetLastError()==0)
            return(true);
         PrintFormat(&quot;%s: Ticks are not synchronized yet, %d ticks received for %d ms.
                     symbol, received, GetTickCount()-start, GetLastError());
        }
 //--- contamos as tentativas
      attempts++; 
 //--- pausa de 1 segundo aguardando a conclus√£o da sincroniza√ß√£o da base de ticks
      Sleep(1000);
     }
//--- n√£o foi poss√≠vel copiar ticks em 3 tentativas
   return(false);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+ 
//| retorna a descri√ß√£o do tick em formato string                    |
//+------------------------------------------------------------------+ 
string GetTickDescription(MqlTick &amp;tick) 
  { 
   string desc=StringFormat(&quot;%s.%03u &quot;, TimeToString(tick.time, TIME_DATE|TIME_MINUTES
   
//--- verificamos os flags do tick
   bool buy_tick   = ((tick.flags &amp;TICK_FLAG_BUY)   == TICK_FLAG_BUY); 
   bool sell_tick  = ((tick.flags &amp;TICK_FLAG_SELL)  == TICK_FLAG_SELL); 
   bool ask_tick   = ((tick.flags &amp;TICK_FLAG_ASK)   == TICK_FLAG_ASK); 
   bool bid_tick   = ((tick.flags &amp;TICK_FLAG_BID)   == TICK_FLAG_BID); </p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2213
</p>
<pre><code class="language-mql5">
   bool last_tick  = ((tick.flags &amp;TICK_FLAG_LAST)  == TICK_FLAG_LAST); 
   bool volume_tick= ((tick.flags &amp;TICK_FLAG_VOLUME)== TICK_FLAG_VOLUME); 
   
//--- verificamos primeiro os flags de negocia√ß√£o do tick (para CustomTicksAdd() n√£o h
   if(buy_tick || sell_tick) 
     { 
      //--- formatamos a sa√≠da para um tick de negocia√ß√£o
      desc += (buy_tick ? StringFormat(&quot;Buy Tick: Last=%G Volume=%d &quot;, tick.last, tick
      desc += (sell_tick? StringFormat(&quot;Sell Tick: Last=%G Volume=%d &quot;,tick.last, tick
      desc += (ask_tick ? StringFormat(&quot;Ask=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += (bid_tick ? StringFormat(&quot;Bid=%G &quot;, tick.ask) : &quot;&quot;); 
      desc += &quot;(Trade tick)&quot;; 
     } 
   else 
     { 
      //--- para um tick de informa√ß√£o, formatamos a sa√≠da de forma um pouco diferente
      desc += (ask_tick   ? StringFormat(&quot;Ask=%G &quot;,  tick.ask)    : &quot;&quot;); 
      desc += (bid_tick   ? StringFormat(&quot;Bid=%G &quot;,  tick.ask)    : &quot;&quot;); 
      desc += (last_tick  ? StringFormat(&quot;Last=%G &quot;, tick.last)   : &quot;&quot;); 
      desc += (volume_tick? StringFormat(&quot;Volume=%d &quot;,tick.volume): &quot;&quot;); 
      desc += &quot;(Info tick)&quot;; 
     } 
//--- retornamos a descri√ß√£o do tick
   return(desc); 
</code></pre>
<p>
  } 
<h3>Veja tamb√©m</h3>
CustomRatesDelete, CustomRatesUpdate, CustomTicksDelete, CopyTicks, CopyTicksRange</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2214
<h3>CustomBookAdd</h3>
Envia o estado do livro de ofertas do instrumento personalizado. A fun√ß√£o permite transmitir o livro
de ofertas como se ele viesse do servidor da corretora.
</p>
<pre><code class="language-mql5">
int¬† CustomBookAdd(
   const string¬†       symbol,            // nome do s√≠mbolo
   const MqlBookInfo&amp;  books[]¬†           // array com as descri√ß√µes dos elementos do 
   uint                count=WHOLE_ARRAY¬† // n√∫mero de elementos a serem usados
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
symbol
[in]  Nome do instrumento personalizado.
books[]
[in]   Array de dados do tipo MqlBookInfo descrevendo completamente o estado do livro de ofertas
‚Äî todos os pedidos de compra e de venda. O estado de livro de ofertas enviado substitui
completamente o anterior.
count=WHOLE_ARRAY
[in]   N√∫mero do elementos do array books que deve ser enviado para a fun√ß√£o. Por padr√£o, √©
usado o array inteiro.
<h3>Valor retornado</h3>
N√∫mero de ticks adicionados ou -1 no caso de erro.
<h3>Observa√ß√£o</h3>
Fun√ß√£o CustomBookAdd funciona apenas para s√≠mbolos personalizados em que o livro de ofertas
est√° aberto ‚Äî por meio da interface da plataforma ou fun√ß√£o MarketBookAdd.
Ao adicionar ao livro de ofertas, os pre√ßos Bid e Ask do instrumento n√£o s√£o atualizados. Voc√™ deve
controlar de forma independente a mudan√ßa dos melhores pre√ßos e adicionar ticks com a ajuda de
CustomTicksAdd.
√â verificada a exatid√£o dos dados transmitidos: para cada elemento devem ser indicados tipo, pre√ßo
e volume. Al√©m disso, MqlBookInfo.volume e MqlBookInfo.volume_real n√£o devem ser zero ou
negativos, se ambos os volumes forem negativos, isso ser√° considerado um erro.  Voc√™ pode
especificar qualquer um dos volumes ou ambos, sendo que ser√° tomado aquele que √© indicado ou √©
positivo:
volume=-1 &amp;&amp; volume_real=2 ‚Äî ser√° usado volume_real=2,
a volume=3 &amp;&amp; volume_real=0 ‚Äî ser√° usado volume=3.
O volume com maior precis√£o MqlBookInfo.volume_real tem uma prioridade mais alta que o habitual
MqlBookInfo.volume. Se, para o elemento do livro de ofertas, ambos os valores forem
especificados, ser√° usado volume_real.
A sequ√™ncia de elementos MqlBookInfo no array books n√£o importa. Ao salvar dados, o terminal os
classifica por pre√ßo independentemente.</p>
<p><h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2215
<h3>Ao</h3>
salvar 
dados, 
√© 
verificado 
o 
par√¢metro 
&quot;Profundidade 
do 
livro 
de
ofertas&quot; (SYMBOL_TICKS_BOOKDEPTH) recebendo o instrumentos personalizado. Se, no livro de
ofertas transmitido, o n√∫mero de pedidos de venda exceder esse valor, os n√≠veis excedentes s√£o
descartados. Da mesma forma, para pedidos de compra.
Veja como √© preenchido o array books:
<h3>Estado</h3>
do 
livro 
de
ofertas
<h3>Preenchimento de books[]</h3>
books[0].type=BOOK_TYPE_SELL;
books[0].price=1.14337;
books[0].volume=100;   
books[1].type=BOOK_TYPE_SELL;
books[1].price=1.14330;
books[1].volume=50;   
books[2].type=BOOK_TYPE_SELL;
books[2].price=1.14335;
books[2].volume=40;   
books[3].type=BOOK_TYPE_SELL;
books[3].price=1.14333;
books[3].volume=10;   
books[4].type=BOOK_TYPE_BUY;
books[4].price=1.14322;
books[4].volume=10;   
books[5].type=BOOK_TYPE_BUY;
books[5].price=1.14320;
books[5].volume=90;  
books[6].type=BOOK_TYPE_BUY;
books[6].price=1.14319;
books[6].volume=100;   
books[7].type=BOOK_TYPE_BUY;
books[7].price=1.14318;
books[7].volume=10;
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- ativamos o livro de ofertas para o instrumento a partir do qual vamos tomas dado
   MarketBookAdd(Symbol());
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Expert deinitialization function                                 |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Tick function                                                    |
//+------------------------------------------------------------------+
void OnTick(void)
  {
   MqlTick ticks[];
   ArrayResize(ticks,1);</p>
<p></code></pre>
<p>
<h3>S√≠mbolos personalizados</h3>
¬© 2000-2025, MetaQuotes Ltd.
2216
</p>
<pre><code class="language-mql5">
//--- copiamos os pre√ßos atuais a partir de um instrumento habitual para um instrument
   if(SymbolInfoTick(Symbol(),ticks[0]))
     {
      string symbol_name=Symbol()+&quot;.SYN&quot;;
      CustomTicksAdd(symbol_name,ticks);
     }
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Book function                                                    |
//+------------------------------------------------------------------+
void OnBookEvent(const string &amp;book_symbol)
  {
//--- copiamos o estado atual do livro de ofertas a partir de um instrumento habitual 
   if(book_symbol==Symbol())
     {
      MqlBookInfo book_array[];
      if(MarketBookGet(Symbol(),book_array))
        {
         string symbol_name=Symbol()+&quot;.SYN&quot;;
         CustomBookAdd(symbol_name,book_array);
        }
     }
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
</code></pre>
<p>
<h3>Veja tamb√©m</h3>
<h3>MarketBookAdd, CustomTicksAdd, OnBookEvent</h3>
</p>
        </article>
        
        <footer>
            <p>Documenta√ß√£o MQL5 - Fonte: MetaQuotes Ltd.</p>
        </footer>
    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
        
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }
        
        function filterNav() {
            const filter = document.getElementById('search').value.toLowerCase();
            const items = document.querySelectorAll('.nav-list li');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? '' : 'none';
            });
        }
    </script>
</body>
</html>