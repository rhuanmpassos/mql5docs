<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun√ß√µes de Arquivo - MQL5 Docs</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <h1>MQL5 Docs</h1>
            <p>Documenta√ß√£o Completa</p>
        </div>
        <div class="search-box">
            <input type="text" id="search" placeholder="Buscar..." onkeyup="filterNav()">
        </div>
        <ul class="nav-list" id="nav-list">
            <li class=""><a href="index.html">üìö √çndice</a></li>
            <li class=""><a href="introducao.html">Introducao</a></li>
<li class=""><a href="refer√™ncia_mql5.html">Refer√™ncia MQL5</a></li>
<li class=""><a href="elementos_b√°sicos_da_linguagem.html">Elementos B√°sicos da Linguagem</a></li>
<li class=""><a href="constantes,_enumeradores_e_estruturas.html">Constantes, Enumeradores e Estruturas</a></li>
<li class=""><a href="programas_mql5.html">Programas MQL5</a></li>
<li class=""><a href="vari√°veis_predefinidas.html">Vari√°veis Predefinidas</a></li>
<li class=""><a href="fun√ß√µes_comuns.html">Fun√ß√µes Comuns</a></li>
<li class=""><a href="fun√ß√µes_para_array.html">Fun√ß√µes para Array</a></li>
<li class=""><a href="m√©todos_matriciais_e_vetoriais.html">M√©todos matriciais e vetoriais</a></li>
<li class=""><a href="fun√ß√µes_de_convers√£o.html">Fun√ß√µes de Convers√£o</a></li>
<li class=""><a href="fun√ß√µes_matem√°ticas.html">Fun√ß√µes Matem√°ticas</a></li>
<li class=""><a href="fun√ß√µes_de_string.html">Fun√ß√µes de String</a></li>
<li class=""><a href="data_e_hora.html">Data e Hora</a></li>
<li class=""><a href="informa√ß√µes_de_conta.html">Informa√ß√µes de Conta</a></li>
<li class=""><a href="verificando_estado.html">Verificando Estado</a></li>
<li class=""><a href="manipula√ß√£o_de_eventos.html">Manipula√ß√£o de eventos</a></li>
<li class=""><a href="informa√ß√µes_de_mercado.html">Informa√ß√µes de Mercado</a></li>
<li class=""><a href="calend√°rio_econ√¥mico.html">Calend√°rio econ√¥mico</a></li>
<li class=""><a href="s√©ries_temporais_e_acesso_a_indicadores.html">S√©ries Temporais e Acesso a Indicadores</a></li>
<li class=""><a href="s√≠mbolos_personalizados.html">S√≠mbolos personalizados</a></li>
<li class=""><a href="opera√ß√µes_de_gr√°ficos.html">Opera√ß√µes de Gr√°ficos</a></li>
<li class=""><a href="fun√ß√µes_de_negocia√ß√£o.html">Fun√ß√µes de Negocia√ß√£o</a></li>
<li class=""><a href="gerenciamento_de_sinais.html">Gerenciamento de sinais</a></li>
<li class=""><a href="fun√ß√µes_de_rede.html">Fun√ß√µes de rede</a></li>
<li class=""><a href="vari√°veis_globais_do_terminal.html">Vari√°veis Globais do Terminal</a></li>
<li class="active"><a href="fun√ß√µes_de_arquivo.html">Fun√ß√µes de Arquivo</a></li>
<li class=""><a href="indicadores_customizados.html">Indicadores Customizados</a></li>
<li class=""><a href="fun√ß√µes_de_objeto.html">Fun√ß√µes de Objeto</a></li>
<li class=""><a href="indicadores_t√©cnicos.html">Indicadores T√©cnicos</a></li>
<li class=""><a href="trabalhando_com_resultados_de_otimiza√ß√£o.html">Trabalhando com Resultados de Otimiza√ß√£o</a></li>
<li class=""><a href="trabalhando_com_eventos.html">Trabalhando com Eventos</a></li>
<li class=""><a href="trabalhando_com_opencl.html">Trabalhando com OpenCL</a></li>
<li class=""><a href="trabalhar_com_bancos_de_dados.html">Trabalhar com bancos de dados</a></li>
<li class=""><a href="trabalho_com_directx.html">Trabalho com DirectX</a></li>
<li class=""><a href="metatrader_para_python.html">MetaTrader para Python</a></li>
<li class=""><a href="modelos_onnx.html">Modelos ONNX</a></li>
<li class=""><a href="biblioteca_padr√£o.html">Biblioteca Padr√£o</a></li>
<li class=""><a href="migrando_do_mql4.html">Migrando do MQL4</a></li>
<li class=""><a href="lista_de_fun√ß√µes_mql5.html">Lista de Fun√ß√µes MQL5</a></li>
<li class=""><a href="lista_de_constantes_mql5.html">Lista de Constantes MQL5</a></li>

        </ul>
    </nav>
    
    <main class="content">
        <header>
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <h1>Fun√ß√µes de Arquivo</h1>
        </header>
        
        <article>
            <p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2480
<h3>Fun√ß√µes de Arquivo</h3>
Este √© um grupo de fun√ß√µes para trabalhar com arquivos.
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5. Arquivos
com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar fora da
caixa de prote√ß√£o do arquivo.
Existem dois diret√≥rios(com subdiret√≥rios) onde os arquivos de trabalho est√£o localizados:
¬∑ terminal_data_folder\MQL5\FILES\ (no menu do terminal selecione para ver &quot;Arquivo&quot; - &quot;Abrir o
diret√≥rio de dados&quot;);
¬∑ na pasta comum para todos os terminais instalados no computador - geralmente no diret√≥rio C:
\Documents and Settings\All Users\Application Data\MetaQuotes\Terminal\Common\Files (C:
\Documentos e Configura√ß√µes\Todos Usu√°rios\Dados de Aplicativos\MetaQuotes\Comum\Files).
Existe um m√©todo de programa para obter nome destes cat√°logos usando a 
fun√ß√£o
TerminalInfoString(), usando a enumera√ß√£o ENUM_TERMINAL_INFO_STRING:
</p>
<pre><code class="language-mql5">
//--- Pasta que armazena os dados do terminal
   string terminal_data_path=TerminalInfoString(TERMINAL_DATA_PATH);
//--- Pasta comum para todos os terminais de clientes
   string common_data_path=TerminalInfoString(TERMINAL_COMMONDATA_PATH);
</code></pre>
<p>
Trabalhar com arquivos de outros diret√≥rios √© proibido.
Fun√ß√µes de arquivo permitem trabalhar com os assim chamados &quot;pipes nomeados&quot;. Para isto, chamar
simplesmente a fun√ß√£o FileOpen() com o par√¢metro apropriado.
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>FileSelectDialog</h3>
Cria uma caixa de di√°logo para abrir/criar um arquivo ou pasta
<h3>FileFindFirst</h3>
Come√ßa a busca de arquivos em um diret√≥rio de acordo com o filtro
especificado
<h3>FileFindNext</h3>
Continua a busca iniciada pela fun√ß√£o FileFindFirst()
<h3>FileFindClose</h3>
<h3>Fecha o manipulador de busca</h3>
<h3>FileOpen</h3>
Abre um arquivo com o nome e bandeira especificada
<h3>FileDelete</h3>
<h3>Deleta um arquivo especificado</h3>
<h3>FileFlush</h3>
Escreve para um disco todos os dados remanescentes dentro da
entrada/sa√≠da do arquivo buffer
<h3>FileGetInteger</h3>
Obt√©m uma propriedade inteira de um arquivo
<h3>FileIsEnding</h3>
Define o final do arquivo em processo de leitura
<h3>FileIsLineEnding</h3>
Define o final da linha do arquivo de texto em processo de leitura
<h3>FileClose</h3>
<h3>Fecha um arquivo aberto previamente</h3>
<h3>FileIsExist</h3>
Verifica a e exist√™ncia de um arquivo</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2481
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>FileCopy</h3>
Copia o arquivo original a partir de um local ou de uma pasta
compartilhada em outro arquivo
<h3>FileMove</h3>
<h3>Move ou renomeia um arquivo</h3>
<h3>FileReadArray</h3>
L√™ arrays de qualquer tipo, exceto para a seq√º√™ncia a partir do
arquivo do tipo BIN
<h3>FileReadBool</h3>
L√™ a partir de arquivo do tipo CSV uma seq√º√™ncia a partir da posi√ß√£o
atual at√© um delimitador (ou at√© o fim de uma linha de texto) e
converte a seq√º√™ncia de leitura para um valor do tipo bool
<h3>FileReadDatetime</h3>
L√™ a partir do arquivo do tipo CSV uma seq√º√™ncia de um dos
formatos: &quot;YYYY.MM.DD HH:MM:SS&quot;, &quot;YYYY.MM.DD&quot; or &quot;HH:MM:SS&quot; -
e converte-os dentro de valor de datetime
<h3>FileReadDouble</h3>
L√™ um valor double a partir da posi√ß√£o atual do ponteiro de arquivo
<h3>FileReadFloat</h3>
L√™ um valor float a partir da posi√ß√£o atual do ponteiro de arquivo
<h3>FileReadInteger</h3>
L√™ um valor int, short ou char a partir da posi√ß√£o atual do ponteiro
de arquivo
<h3>FileReadLong</h3>
L√™ um valor do tipo long a partir da posi√ß√£o atual do ponteiro de
arquivo
<h3>FileReadNumber</h3>
L√™ a partir de arquivo do tipo CSV uma seq√º√™ncia a partir da posi√ß√£o
atual at√© um delimitador (ou at√© o fim de uma linha de texto) e
converte a seq√º√™ncia de leitura em um valor double
<h3>FileReadString</h3>
L√™ uma seq√º√™ncia a partir da posi√ß√£o atual do ponteiro a partir de
um arquivo
<h3>FileReadStruct</h3>
L√™ o conte√∫do de um arquivo bin√°rio em uma estrutura passada
como um par√¢metro, a partir da posi√ß√£o atual do ponteiro do arquivo
<h3>FileSeek</h3>
Move a posi√ß√£o do ponteiro de arquivo por um determinado n√∫mero
de bytes em rela√ß√£o √† posi√ß√£o especificada
<h3>FileSize</h3>
Retorna o tamanho da abertura de um arquivo correspondente
<h3>FileTell</h3>
Retorna a posi√ß√£o atual do ponteiro de um arquivo da abertura de
arquivo correspondente
<h3>FileWrite</h3>
Escreve dados para um arquivo de CSV ou tipo TXT
<h3>FileWriteArray</h3>
Escreve arrays de qualquer tipo exceto para seq√º√™ncia em um
arquivo do tipo BIN
<h3>FileWriteDouble</h3>
Escreve valor do tipo double a partir da posi√ß√£o atual de um ponteiro
de arquivo em um arquivo bin√°rio
<h3>FileWriteFloat</h3>
Escreve o valor do tipo float a partir da posi√ß√£o atual de um ponteiro
de arquivo em um arquivo bin√°rio</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2482
<h3>Fun√ß√£o</h3>
<h3>A√ß√£o</h3>
<h3>FileWriteInteger</h3>
Escreve o valor do tipo int a partir da posi√ß√£o atual de um ponteiro de
arquivo em um arquivo bin√°rio
<h3>FileWriteLong</h3>
Escreve o valor do tipo long a partir da posi√ß√£o atual de um ponteiro
de arquivo em um arquivo bin√°rio
<h3>FileWriteString</h3>
Escreve o valor de um par√¢metro da string em um arquivo BIN ou
TXT iniciando a partir da posi√ß√£o atual do ponteiro de arquivo
<h3>FileWriteStruct</h3>
Escreve o conte√∫do de uma estrutura passada como um par√¢metro
em um arquivo bin√°rio, come√ßando a partir da posi√ß√£o atual do
ponteiro de arquivo
<h3>FileLoad</h3>
Ele l√™ todo o conte√∫do do arquivo bin√°rio especificado numa
variedade transferida de tipos num√©ricos ou estruturas simples
<h3>FileSave</h3>
Armazena no arquivo bin√°rio todos os elementos da matriz
transferida como par√¢metro
<h3>FolderCreate</h3>
Cria uma pasta dentro do diret√≥rio de arquivo
<h3>FolderDelete</h3>
Remove um diret√≥rio selecionado. Se a pasta n√£o estiver vazia,
ent√£o ele n√£o pode ser removido
<h3>FolderClean</h3>
Deleta todos os arquivos dentro da pasta especificada
Se o arquivo √© aberto para escrever usando FileOpen(),todas as sub-pastas especificadas no caminho
ser√£o criadas se elas n√£o existirem.</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2483
<h3>FileSelectDialog</h3>
Cria uma caixa de di√°logo para abrir/criar um arquivo ou pasta.
</p>
<pre><code class="language-mql5">
int¬† FileSelectDialog(
   string¬†  caption,¬†             // barra de t√≠tulo
   string¬†  initial_dir,¬†         // pasta inicial
   string¬†  filter,¬†              // filtro de extens√£o
   uint¬†    flags,¬†               // combina√ß√£o de sinalizadores
   string&amp;¬† filenames[],¬†         // matriz contendo os nomes dos arquivos
   string¬†  default_filename ¬†    // nome do arquivo por padr√£o
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
caption
[in]  T√≠tulo da caixa de di√°logo.
initial_dir
[in]  Nome da pasta inicial relativa √† pasta MQL5\Files, cujo conte√∫do ser√° exibido na caixa de
di√°logo. Se o valor for igual a NULL, na caixa de di√°logo ser√° mostrada a pasta MQL5\Files.
filter
[in]  Filtro de extens√µes de arquivos que ser√£o mostradas na caixa de di√°logo para serem
selecionadas. Arquivos de outros formatos ficar√£o ocultos.
flags
[in] Combina√ß√£o de sinalizadores que define o modo da caixa de di√°logo. Os sinalizadores s√£o
definidos da seguinte maneira:
FSD_WRITE_FILE ‚Äì di√°logo de abertura de arquivo
<h3>FSD_SELECT_FOLDER ‚Äì permite selecionar apenas pastas;</h3>
<h3>FSD_ALLOW_MULTISELECT ‚Äì permite selecionar alguns arquivos;</h3>
FSD_FILE_MUST_EXIST ‚Äì os arquivos selecionados devem existir;
FSD_COMMON_FOLDER ‚Äì o arquivo est√° localizado na pasta compartilhada de terminais do cliente
\Terminal\Common\Files.
filenames[]
[out]  Matriz de linhas na qual ser√£o colocados os nomes dos arquivos/pastas selecionados.
default_filename
[in]  Nome do arquivo/pasta por padr√£o. Se especificado, esse nome ser√° automaticamente
substitu√≠do no di√°logo de abertura e retornado na matriz filenames[] durante o teste.
<h3>Valor retornado</h3>
Se for bem-sucedida, a fun√ß√£o retornar√° o n√∫mero de arquivos selecionados cujos nomes podem ser
obtidos em filenames[]. Se o usu√°rio n√£o selecionar o arquivo e fechar a caixa de di√°logo, a fun√ß√£o
retornar√° 0. Em caso de execu√ß√£o mal sucedida retornar√° um valor menor que 0, c√≥digo de erro
poder√° ser obtido com a ajuda de GetLastError().
<h3>Observa√ß√£o</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2484
Por motivos de seguran√ßa, em MQL5 o trabalho com arquivos √© estritamente controlado. Os
arquivos com os quais s√£o executadas as opera√ß√µes de arquivo atrav√©s da linguagem MQL5 n√£o
podem estar localizados fora do arquivo &quot;√°rea restrita&quot;, isto √©, fora da pasta MQL5\Files.
O nome da pasta inicialinitial_dir √© procurado na pasta do terminal do cliente na subpasta
MQL5\Files (ou diret√≥rio_agente_teste\MQL5\Files em caso de teste). Se entre os sinalizadores for
especificado FSD_COMMON_FOLDER, a pasta inicial ser√° procurada na pasta compartilhada de
terminais do cliente \Terminal\Common\Files.
O par√¢metro filter indica arquivos v√°lidos e deve ser definido com o formato &quot;&lt;descri√ß√£o 1&gt;|
&lt;extens√£o 1&gt;|&lt;descri√ß√£o 2&gt;|&lt;extens√£o 2&gt;...&quot;. Por exemplo, &quot;Text files (*.txt)|*.txt|All files (*.*)|
*.*&quot;, al√©m disso, a primeira extens√£o &quot;Text files (*.txt)|*.txt&quot; ser√° selecionada como tipo de arquivo
por padr√£o.
Se filter=NULL, a m√°scara de sele√ß√£o de arquivos na caixa de di√°logo ser√° &quot;All Files (*.*)|*.*|&quot;
Se definido o par√¢metro default_filename, ent√£o durante o teste n√£o visual a chamada de
FileSelectDialog() retornar√° 1, e o valor de default_filename ser√° copiado na matriz filenames[].
A fun√ß√£o √© proibida em indicadores personalizados, uma vez que a chamada para FileSelectDialog()
interrompe o trabalho do thread de execu√ß√£o durante todo o tempo de espera pela resposta do
usu√°rio. Como todos os indicadores de cada s√≠mbolo s√£o executados num √∫nico thread, o
funcionamento de todos os gr√°ficos em todos os per√≠odos gr√°ficos do s√≠mbolo em quest√£o ser√°
interrompido.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- obtemos os nomes dos arquivos de texto para carregamento a partir da pasta compa
   string filenames[];
   if(FileSelectDialog(&quot;Selecionar arquivos para carregamento&quot;, NULL, 
                       &quot;Text files (*.txt)|*.txt|All files (*.*)|*.*&quot;, 
                       FSD_ALLOW_MULTISELECT|FSD_COMMON_FOLDER, filenames, &quot;data.txt&quot;)
     {
      //--- exibimos o nome de cada arquivo selecionado
      int total=ArraySize(filenames);
      for(int i=0; i&lt;total; i++)
         Print(i, &quot;: &quot;, filenames[i]);
     }
   else
     {
     Print(&quot;Files not selected&quot;);
     }
//---
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
FileOpen, FileIsExist, FileDelete, FileMove, FolderCreate, FolderDelete, FolderClean, Sinalizadores
de abertura de arquivos</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2485
<h3>FileFindFirst</h3>
A fun√ß√£o come√ßa a busca de arquivos e subdiret√≥rios em um diret√≥rio de acordo com o filtro
especificado.
long¬† FileFindFirst(
</p>
<pre><code class="language-mql5">
   const string¬†  file_filter,¬†         // String - filtro de pesquisa
   string&amp;¬†       returned_filename,    // Nome do arquivo ou subdiret√≥rio encontrado
   int¬†           common_flag=0         // Define a pesquisa
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_filter
[in]  Filtro de pesquisa. Um subdiret√≥rio (ou seq√º√™ncia de subdiret√≥rios aninhados) relativo ao
diret√≥rio \Files, em que os arquivos devem ser procurados, podem ser especificados no filtro.
returned_filename
[out]  O par√¢metro retornado, onde, em caso de sucesso, o nome do primeiro arquivo encontrado
ou subdiret√≥rio √© colocado. Only the file name is returned (including the extension), the directories
and subdirectories are not included no matter if they are specified or not in the search filter.
common_flag
[in]  Bandeira determinando a localiza√ß√£o do arquivo. Se common_flag = FILE_COMMON, ent√£o o
arquivo est√° localizado em uma pasta compartilhada para todos os terminais de cliente
\Terminal\Common\Files. Caso contr√°rio, o arquivo est√° localizado em uma pasta local.
<h3>Valor do Retorno</h3>
Retorna o manipulador do objeto pesquisado, que deve ser utilizado para posterior triagem dos
arquivos e subdiret√≥rios pela fun√ß√£o FileFindNext(), ou INVALID_HANDLE quando n√£o h√° nenhum
arquivo e subdiret√≥rio  correspondente ao filtro (no caso particular - quando o diret√≥rio est√° vazio.
Ap√≥s a pesquisa, o manipulador deve ser fechado usando a fun√ß√£o FileFindClose().
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
<h3>Exemplo:</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2486
</p>
<pre><code class="language-mql5">
//--- display the window of input parameters when launching the script
#property script_show_inputs
//--- filter
input string InpFilter=&quot;Dir1\\*&quot;;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   string file_name;
   string int_dir=&quot;&quot;;
   int    i=1,pos=0,last_pos=-1;
//--- search for the last backslash
   while(!IsStopped())
     {
      pos=StringFind(InpFilter,&quot;\\&quot;,pos+1);
      if(pos&gt;=0)
         last_pos=pos;
      else
         break;
     }
//--- the filter contains the folder name
   if(last_pos&gt;=0)
      int_dir=StringSubstr(InpFilter,0,last_pos+1);
//--- get the search handle in the root of the local folder
   long search_handle=FileFindFirst(InpFilter,file_name);
//--- check if the FileFindFirst() is executed successfully
   if(search_handle!=INVALID_HANDLE)
     {
      //--- in a cycle, check if the passed strings are the names of files or director
      do
        {
         ResetLastError();
         //--- if it&#x27;s a file, the function returns true, and if it&#x27;s a directory, it 
         FileIsExist(int_dir+file_name);
         PrintFormat(&quot;%d : %s name = %s&quot;,i,GetLastError()==ERR_FILE_IS_DIRECTORY ? &quot;Di
         i++;
        }
      while(FileFindNext(search_handle,file_name));
      //--- close the search handle
      FileFindClose(search_handle);
     }
   else
      Print(&quot;Files not found!&quot;);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileFindNext, FileFindClose</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2487
<h3>FileFindNext</h3>
A fun√ß√£o continua a busca iniciada por FileFindFirst().
</p>
<pre><code class="language-mql5">
bool¬† FileFindNext(
   long¬†     search_handle,¬†        // Manipular pesquisa
   string&amp;¬†  returned_filename¬†     // Nome do arquivo ou subdiret√≥rio encontrado
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
search_handle
[in]  Manipulador de pesquisa, recuperado por FileFindFirst().
returned_filename
[out] O nome do pr√≥ximo arquivo ou subdiret√≥rio encontrado. Only the file name is returned
(including the extension), the directories and subdirectories are not included no matter if they are
specified or not in the search filter.
<h3>Valor do Retorno</h3>
Se bem sucedido retorna verdadeiro, caso contr√°rio false.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- filtro
input string InpFilter=&quot;*&quot;;
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string file_name;
   int    i=1;
//--- receber o manipulador de pesquisa na raiz da pasta local
   long search_handle=FileFindFirst(InpFilter,file_name);
//--- verificar se FileFindFirst() √© executada com sucesso
   if(search_handle!=INVALID_HANDLE)
     {
      //--- verificar se as strings passadas s√£o nomes de arquivo ou diret√≥rio no loop
      do
        {
         ResetLastError();
         //--- se este √© um arquivo, a fun√ß√£o retornar√° verdadeiro, se √© um diret√≥rio,
         FileIsExist(file_name);
         PrintFormat(&quot;%d : %s nome = %s&quot;,i,GetLastError()==ERR_FILE_IS_DIRECTORY ? &quot;Di
         i++;
        }
      while(FileFindNext(search_handle,file_name));</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2488
</p>
<pre><code class="language-mql5">
      //--- Fechar manipulador de pesquisa
      FileFindClose(search_handle);
     }
   else
      Print(&quot;Arquivo n√£o encontrado!&quot;);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileFindFirst, FileFindClose</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2489
<h3>FileFindClose</h3>
A fun√ß√£o fecha o identificador pesquisa.
</p>
<pre><code class="language-mql5">
void¬† FileFindClose(
   long¬† search_handle¬†     //  Manipular pesquisa
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
search_handle
[in]  Manipulador de pesquisa, recuperado por FileFindFirst().
<h3>Valor do Retorno</h3>
Sem valor retornado.
<h3>Observa√ß√£o</h3>
Fun√ß√£o deve ser chamado para liberar recursos do sistema.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- filtro
input string InpFilter=&quot;*&quot;;
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string file_name;
   int    i=1;
//--- receber o manipulador de pesquisa na raiz da pasta local
   long search_handle=FileFindFirst(InpFilter,file_name);
//--- verificar se FileFindFirst() √© executada com sucesso
   if(search_handle!=INVALID_HANDLE)
     {
      //--- verificar se as strings passadas s√£o nomes de arquivo ou diret√≥rio no loop
      do
        {
         ResetLastError();
         //--- se este √© um arquivo, a fun√ß√£o retornar√° verdadeiro, se √© um diret√≥rio,
         FileIsExist(file_name);
         PrintFormat(&quot;%d : %s nome = %s&quot;,i,GetLastError()==5018 ? &quot;Diret√≥rio&quot; : &quot;Arqui
         i++;
        }
      while(FileFindNext(search_handle,file_name));
      //--- Fechar manipulador de pesquisa
      FileFindClose(search_handle);
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2490
</p>
<pre><code class="language-mql5">
   else
      Print(&quot;Arquivo n√£o encontrado!&quot;);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileFindFirst, FileFindNext</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2491
<h3>FileIsExist</h3>
Verifica a exist√™ncia de um arquivo.
</p>
<pre><code class="language-mql5">
bool¬† FileIsExist(
   const string¬† file_name,¬†      // Nome do arquivo
   int¬†          common_flag=0¬†   // √Årea de pesquisa
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_name
[in]  O nome do arquivo a ser verificado
common_flag=0
[in]  Bandeira determinando a localiza√ß√£o do arquivo. Se common_flag = FILE_COMMON, ent√£o o
arquivo est√° localizado em uma pasta compartilhada para todos os terminais de cliente
\Terminal\Common\Files. Caso contr√°rio, o arquivo est√° localizado em uma pasta local.
<h3>Valor do Retorno</h3>
Retorna true, se o arquivo especificado existe.
<h3>Observa√ß√£o</h3>
Arquivo verificado pode vir a ser um subdiret√≥rio. Neste caso, FileIsExist() fun√ß√£o retornar√° falso,
enquanto o erro 5018 ser√° registrada na vari√°vel _LastError - &quot;Este √© um diret√≥rio, n√£o √© um
arquivo&quot; (ver exemplo pela fun√ß√£o FileFindFirst).
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Se common_flag = FILE_COMMON, ent√£o a fun√ß√£o procura o arquivo em uma pasta compartilhada
por todos os terminais do cliente \Terminal\Common\Files, caso contr√°rio, a fun√ß√£o procura por um
arquivo em uma pasta local (MQL5\Files ou MQL5\Tester\Files no caso de testes).
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- data para arquivos antigos
input datetime InpFilesDate=D&#x27;2013.01.01 00:00&#x27;;
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string   file_name;      // vari√°vel para armazenar os nomes dos arquivos
   string   filter=&quot;*.txt&quot;; // filtrar parar pesquisar os arquivos
   datetime create_date;    // data de cria√ß√£o do arquivo
   string   files[];        // lista de nome dos arquivos
   int      def_size=25;    // tamanho do array por padr√£o</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2492
</p>
<pre><code class="language-mql5">
   int      size=0;         // n√∫mero de arquivos
//--- alocar mem√≥ria para o array
   ArrayResize(files,def_size);
//--- receber o manipulador de pesquisa na raiz da pasta local
   long search_handle=FileFindFirst(filter,file_name);
//--- verificar se FileFindFirst() √© executada com sucesso
   if(search_handle!=INVALID_HANDLE)
     {
      //--- pesquisando arquivos no loop
      do
        {
         files[size]=file_name;
         //--- aumentar o tamanho do array
         size++;
         if(size==def_size)
           {
            def_size+=25;
            ArrayResize(files,def_size);
           }
         //--- redefinir o valor de erro
         ResetLastError();
         //--- receber a data de cria√ß√£o do arquivo
         create_date=(datetime)FileGetInteger(file_name,FILE_CREATE_DATE,false);
         //--- verificar se o arquivo √© antigo
         if(create_date&lt;InpFilesDate)
           {
            PrintFormat(&quot;%s arquivo deletado!&quot;,file_name);
            //--- deletado o arquivo antigo
            FileDelete(file_name);
           }
        }
      while(FileFindNext(search_handle,file_name));
      //--- fechar o manipulador de pesquisa
      FileFindClose(search_handle);
     }
   else
     {
      Print(&quot;Arquivo n√£o encontrado!&quot;);
      return;
     }
//--- verificar quais os arquivos permanecem
   PrintFormat(&quot;Resultados:&quot;);
   for(int i=0;i&lt;size;i++)
     {
      if(FileIsExist(files[i]))
         PrintFormat(&quot;%s arquivo existe!&quot;,files[i]);
      else
         PrintFormat(&quot;%s arquivo deletado!&quot;,files[i]);
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2493
  }
<h3>Tamb√©m Veja</h3>
<h3>FileFindFirst</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2494
<h3>FileOpen</h3>
A fun√ß√£o abre o arquivo com o nome e a bandeira especificada.
</p>
<pre><code class="language-mql5">
int¬† FileOpen(
   string¬† file_name,¬†          // Nome do arquivo
   int¬†    open_flags,¬†         // Combina√ß√£o de bandeiras
   short¬†  delimiter=&#x27;\t&#x27;,      // Delimitador
   uint¬†   codepage=CP_ACP¬†     // P√°gina de c√≥digo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_name
[in]  O nome do arquivo pode conter sub-pastas. Se o arquivo √© aberto para escrita, estas sub-
pastas ser√£o criadas se elas n√£o existirem.
open_flags
[in]  combina√ß√£o de bandeiras que determinam o modo de opera√ß√£o para o arquivo. As bandeiras
s√£o definidas das seguintes formas:
<h3>FILE_READ arquivo √© aberto para leitura</h3>
FILE_WRITE arquivo √© aberto para a escrita
FILE_BIN modo bin√°rio de leitura e escrita(sem convers√£o de uma string e para uma string)
FILE_CSV arquivo do tipo csv (todos os itens registrados s√£o convertidos para as strings de tipo
unicode ou ansi, e s√£o separados por um delimitador)
FILE_TXT um arquivo de texto simples (o mesmo que csv, mas o delimitador n√£o √© levado em
conta)
FILE_ANSI linhas do tipo ANSI (s√≠mbolos de um byte)
FILE_UNICODE linhas do tipo UNICODE (caracteres de bytes duplos)
<h3>FILE_SHARE_READ leitura partilhada entre v√°rios programas</h3>
<h3>FILE_SHARE_WRITE escrita partilhada entre v√°rios programas</h3>
FILE_COMMON localiza√ß√£o do arquivo em uma pasta compartilhada para todos os terminais de
cliente \Terminal\Common\Files.
delimiter=&#x27;\t&#x27;
[in]  valor a ser usado como um separador em txt ou csv-file. Se o arquivo .csv delimitador n√£o for
especificado, o padr√£o √© uma tabula√ß√£o. Se o arquivo .txt delimitador n√£o for especificado, ent√£o
nenhum separador √© usado. Se o separador est√° claramente definido para 0, ent√£o nenhum
separador √© usado.
codepage=CP_ACP
[in]  O valor do c√≥digo de p√°gina. Para os mais usados c√≥digos de p√°gina forne√ßa as constantes
apropriadas.
<h3>Valor do Retorno</h3>
Se um arquivo foi aberto com sucesso, a fun√ß√£o retorna o manipulador de arquivo, que √© ent√£o
usado para acessar os dados do arquivo. Em caso de falha retorna INVALID_HANDLE.
<h3>Observa√ß√£o</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2495
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Se o arquivo precisar ser lido em uma codifica√ß√£o espec√≠fica (o par√¢metro codepage √© especificado
com o valor da p√°gina de c√≥digos), dever√° ser definido o sinalizador FILE_ANSI. Se o sinalizador
FILE_ANSI n√£o for especificado, o arquivo de texto ser√° lido em Unicode, sem nenhuma convers√£o.
O arquivo √© aberto na pasta do terminal do cliente na 
subpasta 
<h3>MQL5\files</h3>
(ou
testing_agent_directory\MQL5\files em caso de testes). Se FILE_COMMON √© especificado entre
bandeiras, o arquivo √© aberto em uma pasta compartilhada para todos os MetaTrader 5 terminais de
cliente.
&quot;Pipes nomeados&quot; pode ser aberta de acordo com as seguintes regras:
¬∑ Nome do pipe √© uma string, que deve ter o seguinte aspecto: &quot;\\servername\pipe\pipeName&quot;,
onde servername - nome do servidor na rede, enquanto pipename √© um nome de tubo. Se os
tubos s√£o utilizados no mesmo computador, o nome do servidor pode ser omitido, mas num ponto
devem ser inseridos em vez do mesmo: &quot;\\.\pipe\pipename&quot;. Um cliente tenta conectar o tubo
deve saber o seu nome.
¬∑ FileFlush() e FileSeek() deve ser chamado para o in√≠cio de um arquivo entre as opera√ß√µes
seq√ºenciais de leitura do tubo e grav√°-lo.
Um s√≠mbolo &#x27;\&#x27; especial √© usado em strings expostas. Portanto, &#x27;\&#x27; deve ser redobrada quando se
escreve um nome na aplica√ß√£o MQL5. Isso significa que o exemplo acima deve ter o seguinte
aspecto no c√≥digo: &quot;\\\\servername\\pipe\\pipename&quot;.
Mais informa√ß√µes sobre como trabalhar com pipes nomeados pode ser encontrada no artigo
&quot;Communicating With MetaTrader 5 Using Named Pipes Without Using DLLs&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Programa Script da fun–∑–≥o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- m–πtodo de abertura de arquivo incorreto
   string terminal_data_path=TerminalInfoString(TERMINAL_DATA_PATH);
   string filename=terminal_data_path+&quot;\\MQL5\\Files\\&quot;+&quot;fractals.csv&quot;;
   int filehandle=FileOpen(filename,FILE_WRITE|FILE_CSV);
   if(filehandle&lt;0)
     {
      Print(&quot;Falha para abrir o arquivo pelo caminho absoluto &quot;);
      Print(&quot;C—Édigo de erro &quot;,GetLastError());
     }
//--- maneira correta de trabalhar no &quot;sandbox arquivo&quot;
   ResetLastError();
   filehandle=FileOpen(&quot;fractals.csv&quot;,FILE_WRITE|FILE_CSV);
   if(filehandle!=INVALID_HANDLE)
     {
      FileWrite(filehandle,TimeCurrent(),Symbol(), EnumToString(_Period));
      FileClose(filehandle);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2496
</p>
<pre><code class="language-mql5">
      Print(&quot;FileOpen OK&quot;);
     }
   else Print(&quot;Opera–∑–≥o FileOpen falhou, erro &quot;,GetLastError());
//--- outro exemplo com a cria–∑–≥o de um diret—Ério fechado em MQL5\Files\
   string subfolder=&quot;Research&quot;;
   filehandle=FileOpen(subfolder+&quot;\\fractals.txt&quot;,FILE_WRITE|FILE_CSV);
      if(filehandle!=INVALID_HANDLE)
     {
      FileWrite(filehandle,TimeCurrent(),Symbol(), EnumToString(_Period));
      FileClose(filehandle);
      Print(&quot;O arquivo ser–± criado na pasta &quot;+terminal_data_path+&quot;\\&quot;+subfolder);
     }
   else Print(&quot;Falha ao abrir arquivo, erro &quot;,GetLastError());
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
Utiliza√ß√£o de uma p√°gina de c√≥digo (Codepage), FileFindFirst, FolderCreate,  Bandeiras de abertura
de arquivos</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2497
<h3>FileClose</h3>
Feche o arquivo previamente aberto por FileOpen().
</p>
<pre><code class="language-mql5">
void¬† FileClose(
   int¬† file_handle¬†     // Manipulador de arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Sem valor retornado.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;file.txt&quot;;    // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;;   // nome do diret√≥rio
input int    InpEncodingType=FILE_ANSI; // ANSI=32 ou UNICODE=64
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- Imprimir o caminho para o arquivo que vamos usar
   PrintFormat(&quot;Trabalhando %s\\Arquivos\\ pasta&quot;,TerminalInfoString(TERMINAL_DATA_PAT
//--- redefine o valor de erro
   ResetLastError();
//--- abrir um arquivo para leitura(se n√£o existe arquivo, ocorrer√° um erro)
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_TXT|InpEn
   if(file_handle!=INVALID_HANDLE)
     {
      //--- imprimir o conte√∫do do arquivo
      while(!FileIsEnding(file_handle))
         Print(FileReadString(file_handle));
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
      PrintFormat(&quot;Erro, c√≥digo = %d&quot;,GetLastError());
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2498
<h3>FileCopy</h3>
A fun√ß√£o copia o arquivo original a partir de uma pasta local ou compartilhada para outro arquivo.
</p>
<pre><code class="language-mql5">
bool¬† FileCopy(
   const string¬† src_file_name,¬†    // Nome de um arquivo fonte 
   int¬†          common_flag,¬†      // Localiza√ß√£o
   const string¬† dst_file_name,¬†    // Nome do arquivo de destino
   int¬†          mode_flags¬†        // Modo de acesso
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
src_file_name
[in]  O nome do arquivo para c√≥pia.
common_flag
[in]  Bandeira determinando a localiza√ß√£o do arquivo. Se common_flag = FILE_COMMON, ent√£o o
arquivo est√° localizado em uma pasta compartilhada para todos os terminais de cliente
\Terminal\Common\Files. Caso contr√°rio, o arquivo est√° localizado em uma pasta local (por
exemplo, common_flag=0).
dst_file_name
[in]  Resultado nome do arquivo.
mode_flags
[in]  Bandeiras de acesso. O par√¢metro pode conter apenas duas bandeiras: FILE_REWRITE e/ou
FILE_COMMON - outras bandeiras s√£o ignoradas. Se o arquivo j√° existe, e a bandeira
FILE_REWRITE n√£o foi especificado, ent√£o o arquivo n√£o ser√° reescrito e a fun√ß√£o retornar√° false.
<h3>Valor do Retorno</h3>
Em caso de falha a fun√ß√£o retornar√° false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Se o novo arquivo j√° existe, a c√≥pia ser√° feita dependendo da disponibilidade da bandeira
FILE_REWRITE dentro do par√¢metro mode_flags.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpSrc=&quot;source.txt&quot;;       // source
input string InpDst=&quot;destination.txt&quot;;  // copy
input int    InpEncodingType=FILE_ANSI; // ANSI=32 ou UNICODE=64
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2499
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
void OnStart()
  {
//--- exibir o conte√∫do de origem (que deve existir)
   if(!FileDisplay(InpSrc))
      return;
//--- verifique se a c√≥pia do arquivo j√° existe (n√£o pode ser criado)
   if(!FileDisplay(InpDst))
     {
      //--- a c√≥pia de arquivo n√£o existe, copiando sem a bandeira FILE_REWRITE (c√≥pia
      if(FileCopy(InpSrc,0,InpDst,0))
         Print(&quot;Arquivo est√° copiado!&quot;);
      else
         Print(&quot;Arquivo n√£o est√° copiado!&quot;);
     }
   else
     {
      //--- c√≥pia do arquivo j√° existe, tente copiar sem a bandeira FILE_REWRITE (c√≥pi
      if(FileCopy(InpSrc,0,InpDst,0))
         Print(&quot;Arquivo est√° copiado!&quot;);
      else
         Print(&quot;Arquivo n√£o est√° copiado!&quot;);
      //--- conte√∫do do arquivo InpDst continua o mesmo
      FileDisplay(InpDst);
      //--- copiar mais uma vez com a bandeira FILE_REWRITE (copiando correto, se o ar
      if(FileCopy(InpSrc,0,InpDst,FILE_REWRITE))
         Print(&quot;Arquivo est√° copiado!&quot;);
      else
         Print(&quot;Arquivo n√£o est√° copiado!&quot;);
     }
//--- receber c√≥pia de arquivo InpS
   FileDisplay(InpDst);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Ler coment√°rios do arquivo¬†                                      |
//+------------------------------------------------------------------+
bool FileDisplay(const string file_name)
  {
//--- redefine o valor de erro
   ResetLastError();
//--- abre o arquivo
   int file_handle=FileOpen(file_name,FILE_READ|FILE_TXT|InpEncodingType);
   if(file_handle!=INVALID_HANDLE)
     {
      //--- exibir o conte√∫do do arquivo no loop
      Print(&quot;+---------------------+&quot;);
      PrintFormat(&quot;Nome do arquivo = %s&quot;,file_name);
      while(!FileIsEnding(file_handle))
         Print(FileReadString(file_handle));</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2500
</p>
<pre><code class="language-mql5">
      Print(&quot;+---------------------+&quot;);
      //--- fechar o arquivo
      FileClose(file_handle);
      return(true);
     }
//--- falha para abrir o arquivo
   PrintFormat(&quot;%s n√£o est√° aberto, erro = %d&quot;,file_name,GetLastError());
   return(false);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2501
<h3>FileDelete</h3>
Deletar o arquivo especificado dentro da pasta local do terminal do cliente.
</p>
<pre><code class="language-mql5">
bool¬† FileDelete(
   const string¬† file_name,¬†    // Nome do arquivo para deletar
   int¬†          common_flag=0¬† // Localiza√ß√£o do arquivo para deletar
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_name
[in]  Nome do arquivo.
common_flag=0
[in]  Bandeira determinando a localiza√ß√£o do arquivo. Se common_flag = FILE_COMMON, ent√£o o
arquivo est√° localizado em uma pasta compartilhada para todos os terminais de cliente
\Terminal\Common\Files. Caso contr√°rio, o arquivo est√° localizado em uma pasta local.
<h3>Valor do Retorno</h3>
Em caso de falha a fun√ß√£o retornar√° false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Exclui o arquivo especificado a partir de uma pasta local do terminal do cliente (MQL5\Files ou
MQL5\Tester\Files em caso de testes). Se common_flag = FILE_COMMON, ent√£o a fun√ß√£o remove o
arquivo da pasta compartilhada para todos os terminais do cliente.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- data para arquivos antigos
input datetime InpFilesDate=D&#x27;2013.01.01 00:00&#x27;;
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string   file_name;      // vari√°vel para armazenar os nomes dos arquivos
   string   filter=&quot;*.txt&quot;; // filtrar parar pesquisar os arquivos
   datetime create_date;    // data de cria√ß√£o do arquivo
   string   files[];        // lista de nome dos arquivos
   int      def_size=25;    // tamanho do array por padr√£o
   int      size=0;         // n√∫mero de arquivos
//--- alocar mem√≥ria para o array
   ArrayResize(files,def_size);
//--- receber o manipulador de pesquisa na raiz da pasta local</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2502
</p>
<pre><code class="language-mql5">
   long search_handle=FileFindFirst(filter,file_name);
//--- verificar se FileFindFirst() √© executada com sucesso
   if(search_handle!=INVALID_HANDLE)
     {
      //--- pesquisando arquivos no loop
      do
        {
         files[size]=file_name;
         //--- aumentar o tamanho do array
         size++;
         if(size==def_size)
           {
            def_size+=25;
            ArrayResize(files,def_size);
           }
         //--- redefinir o valor de erro
         ResetLastError();
         //--- receber a data de cria√ß√£o do arquivo
         create_date=(datetime)FileGetInteger(file_name,FILE_CREATE_DATE,false);
         //--- verificar se o arquivo √© antigo
         if(create_date&lt;InpFilesDate)
           {
            PrintFormat(&quot;%s arquivo deletado!&quot;,file_name);
            //--- deletado o arquivo antigo
            FileDelete(file_name);
           }
        }
      while(FileFindNext(search_handle,file_name));
      //--- fechar o manipulador de pesquisa
      FileFindClose(search_handle);
     }
   else
     {
      Print(&quot;Arquivo n√£o encontrado!&quot;);
      return;
     }
//--- verificar quais os arquivos permanecem
   PrintFormat(&quot;Resultados:&quot;);
   for(int i=0;i&lt;size;i++)
     {
      if(FileIsExist(files[i]))
         PrintFormat(&quot;%s arquivo existe!&quot;,files[i]);
      else
         PrintFormat(&quot;%s arquivo deletado!&quot;,files[i]);
     }
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2503
<h3>FileMove</h3>
Move um arquivo a partir de um local ou a partir de pasta compartilhada para outra pasta.
</p>
<pre><code class="language-mql5">
bool¬† FileMove(
   const string¬† src_file_name,¬†   // O nome do arquivo para a opera√ß√£o de movimenta√ß√£
   int¬†          common_flag,¬†     // Loca√ß√£o
   const string¬† dst_file_name,¬†   // Nome do arquivo de destino
   int¬†          mode_flags¬†       // Modo de acesso
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
src_file_name
[in]  O nome do arquivo para mover/renomear.
common_flag
[in]  Bandeira determinando a localiza√ß√£o do arquivo. Se common_flag = FILE_COMMON, ent√£o o
arquivo est√° localizado em uma pasta compartilhada para todos os terminais de cliente
\Terminal\Common\Files. Caso contr√°rio, o arquivo est√° localizado em uma pasta local
(common_flag=0).
dst_file_name
[in]  O nome do arquivo ap√≥s a opera√ß√£o
mode_flags
[in]  Bandeiras de acesso. O par√¢metro pode conter apenas duas bandeiras: FILE_REWRITE e/ou
FILE_COMMON - outras bandeiras s√£o ignoradas. Se o arquivo j√° existe e a bandeira
FILE_REWRITE n√£o for especificada, o arquivo n√£o ser√° reescrito, e a fun√ß√£o retornar√° false.
<h3>Valor do Retorno</h3>
Em caso de falha a fun√ß√£o retornar√° false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Se o novo arquivo j√° existe, a c√≥pia ser√° feita dependendo da disponibilidade da bandeira
FILE_REWRITE dentro do par√¢metro mode_flags.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpSrcName=&quot;data.txt&quot;;
input string InpDstName=&quot;newdata.txt&quot;;
input string InpSrcDirectory=&quot;SomeFolder&quot;;
input string InpDstDirectory=&quot;OtherFolder&quot;;
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2504
</p>
<pre><code class="language-mql5">
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string local=TerminalInfoString(TERMINAL_DATA_PATH);
   string common=TerminalInfoString(TERMINAL_COMMONDATA_PATH);
//--- receber caminhos de arquivo
   string src_path;
   string dst_path;
   StringConcatenate(src_path,InpSrcDirectory,&quot;//&quot;,InpSrcName);
   StringConcatenate(dst_path,InpDstDirectory,&quot;//&quot;,InpDstName);
//--- verifica se o arquivo de origem existe (se n√£o - sa√≠da)
   if(FileIsExist(src_path))
      PrintFormat(&quot;%s file arquivo existe no %s\\Files\\%s pasta&quot;,InpSrcName,local,Inp
   else
     {
      PrintFormat(&quot;Erro, %s arquivo de origem n√£o encontrado&quot;,InpSrcName);
      return;
     }
//--- verifica se o arquivo do resultado j√° existe
   if(FileIsExist(dst_path,FILE_COMMON))
     {
      PrintFormat(&quot;%s arquivo existe no %s\\Files\\%s pasta&quot;,InpDstName,common,InpDstD
      //--- arquivo existe, movendo-se deve ser realizado com a flag FILE_REWRITE
      ResetLastError();
      if(FileMove(src_path,0,dst_path,FILE_COMMON|FILE_REWRITE))
         PrintFormat(&quot;%s arquivo movido&quot;,InpSrcName);
      else
         PrintFormat(&quot;Erro! C√≥digo = %d&quot;,GetLastError());
     }
   else
     {
      PrintFormat(&quot;%s arquivo n√£o existe no %s\\Files\\%s pasta&quot;,InpDstName,common,Inp
      //--- arquivo n√£o existe, movendo-se deve ser realizado sem a flag FILE_REWRITE
      ResetLastError();
      if(FileMove(src_path,0,dst_path,FILE_COMMON))
         PrintFormat(&quot;%s arquivo movido&quot;,InpSrcName);
      else
         PrintFormat(&quot;Erro! C√≥digo = %d&quot;,GetLastError());
     }
//--- o arquivo √© movido, vamos verificar-lo fora
   if(FileIsExist(dst_path,FILE_COMMON) &amp;&amp; !FileIsExist(src_path,0))
      Print(&quot;Sucesso!&quot;);
   else
      Print(&quot;Erro!&quot;);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2505
<h3>FileIsExist</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2506
<h3>FileFlush</h3>
Escreve para um disco todos os dados remanescentes dentro da entrada/sa√≠da do arquivo buffer.
</p>
<pre><code class="language-mql5">
void¬† FileFlush(
   int¬† file_handle¬†     // Manipulador de arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Sem valor retornado.
<h3>Observa√ß√£o</h3>
Ao escrever um arquivo, os dados podem ser realmente encontrados l√° s√≥ depois de algum tempo.
Para salvar os dados no arquivo instantaneamente, utilize a fun√ß√£o FileFlush(). Se a fun√ß√£o n√£o √©
utilizada, parte dos dados que n√£o tenham sido ainda armazenados no disco, ser√£o for√ßosamente
escritos l√° apenas quando o arquivo √© fechado com a fun√ß√£oFileClose().
A fun√ß√£o deve ser usada quando os dados gravados s√£o de um certo valor. Deve-se ter em mente
que freq√ºente chamada de fun√ß√£o podem afetar a velocidade de opera√ß√£o do programa.
Fun√ß√£o FileFlush() deve ser chamado entre as opera√ß√µes de leitura de um arquivo e grav√°-lo.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- Nome do arquivo para escrever
input string InpFileName=&quot;example.csv&quot;; // nome do arquivo
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- redefine o valor de erro
   ResetLastError();
//--- abre o arquivo
   int file_handle=FileOpen(InpFileName,FILE_READ|FILE_WRITE|FILE_CSV);
   if(file_handle!=INVALID_HANDLE)
     {
      //--- gravar dados no arquivo
      for(int i=0;i&lt;1000;i++)
        {
         //--- chamar fun√ß√£o de escrever
         FileWrite(file_handle,TimeCurrent(),SymbolInfoDouble(Symbol(),SYMBOL_BID),Sym
         //--- salvar os dados no disco a cada itera√ß√£o (repeti√ß√£o) 128
         if((i &amp; 127)==127)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2507
</p>
<pre><code class="language-mql5">
           {
            //--- agora, os dados ser√£o localizados no arquivo e n√£o ser√£o perdidos no
            FileFlush(file_handle);
            PrintFormat(&quot;i = %d, OK&quot;,i);
           }
         //--- 0.01 segunda pausa
         Sleep(10);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
      PrintFormat(&quot;Erro, c√≥digo = %d&quot;,GetLastError());
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileClose</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2508
<h3>FileGetInteger</h3>
Obt√©m uma propriedade inteira de um arquivo. Existem duas variantes da fun√ß√£o.
1. Obt√©m a propriedade pelo manipulador de um arquivo.
long¬† FileGetInteger(
</p>
<pre><code class="language-mql5">
   int¬†                        file_handle,   // Manipular arquivo
   ENUM_FILE_PROPERTY_INTEGER¬† property_id    // ID Propriedade
   );
</code></pre>
<p>
2. Obt√©m a propriedade pelo nome do arquivo.
long¬† FileGetInteger(
</p>
<pre><code class="language-mql5">
   const string                file_name,            // Nome do arquivo
   ENUM_FILE_PROPERTY_INTEGER¬† property_id,          // ID Propriedade
   bool¬†                       common_folder=false   // O arquivo √© visto em uma pasta
   );                                                // ou uma pasta comum de todos os
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
file_name
[in]  Nome do arquivo.
property_id
[in]  Propriedade ID do arquivo. O valor pode ser um dos valores da enumera√ß√£o
ENUM_FILE_PROPERTY_INTEGER. Se a segunda variante da fun√ß√£o √© usada, voc√™ pode receber
apenas 
os 
valores 
das 
 
seguintes 
propriedades: 
<h3>FILE_EXISTS,</h3>
<h3>FILE_CREATE_DATE,</h3>
FILE_MODIFY_DATE, FILE_ACCESS_DATE e FILE_SIZE.
common_folder=false
[in]  Pontos para localiza√ß√£o de arquivo. Se o par√¢metro √© false, pasta de dados do terminal √©
visualizada. Caso contr√°rio, presume-se que o arquivo est√° na pasta compartilhada por todos os
terminais \Terminal\Common\Files(FILE_COMMON).
<h3>Valor do Retorno</h3>
O valor da propriedade. Em caso de erro, -1 √© retornado. Para obter um c√≥digo de erro usar a fun√ß√£o
GetLastError().
Se uma pasta est√° especificada quando obtida a propriedade pelo nome, a fun√ß√£o ter√° erro 5018
(ERR_MQL_FILE_IS_DIRECTORY) em qualquer caso, embora o valor de retorno ser√° correto.
<h3>Observa√ß√£o</h3>
A fun√ß√£o sempre altera o c√≥digo de erro. Em caso de conclus√£o bem sucedida, o c√≥digo de erro √©
redefinido para NULL.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2509
</p>
<pre><code class="language-mql5">
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;data.csv&quot;;
input string InpDirectoryName=&quot;SomeFolder&quot;;
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string path=InpDirectoryName+&quot;//&quot;+InpFileName;
   long   l=0;
//--- abre o arquivo
   ResetLastError();
   int handle=FileOpen(path,FILE_READ|FILE_CSV);
   if(handle!=INVALID_HANDLE)
     {
      //--- imprimir todas as informa√ß√µes sobre o arquivo
      Print(InpFileName,&quot; informa√ß√£o de arquivo:&quot;);
      FileInfo(handle,FILE_EXISTS,l,&quot;bool&quot;);
      FileInfo(handle,FILE_CREATE_DATE,l,&quot;data&quot;);
      FileInfo(handle,FILE_MODIFY_DATE,l,&quot;data&quot;);
      FileInfo(handle,FILE_ACCESS_DATE,l,&quot;data&quot;);
      FileInfo(handle,FILE_SIZE,l,&quot;outros&quot;);
      FileInfo(handle,FILE_POSITION,l,&quot;outros&quot;);
      FileInfo(handle,FILE_END,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_COMMON,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_TEXT,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_BINARY,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_CSV,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_ANSI,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_READABLE,l,&quot;bool&quot;);
      FileInfo(handle,FILE_IS_WRITABLE,l,&quot;bool&quot;);
      //--- fechar o arquivo
      FileClose(handle);
     }
   else
      PrintFormat(&quot;%s arquivo n√£o est√° aberto, ErrorCode = %d&quot;,InpFileName,GetLastErro
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Mostrar o valor da propriedade de arquivo¬†                       |
//+------------------------------------------------------------------+
void FileInfo(const int handle,const ENUM_FILE_PROPERTY_INTEGER id,
              long l,const string type)
  {
//--- receber o valor da propriedade
   ResetLastError();
   if((l=FileGetInteger(handle,id))!=-1)
     {
      //--- o valor recebido, exibi-lo no formato correto</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2510
</p>
<pre><code class="language-mql5">
      if(!StringCompare(type,&quot;bool&quot;))
         Print(EnumToString(id),&quot; = &quot;,l ? &quot;true&quot; : &quot;false&quot;);
      if(!StringCompare(type,&quot;date&quot;))
         Print(EnumToString(id),&quot; = &quot;,(datetime)l);
      if(!StringCompare(type,&quot;other&quot;))
         Print(EnumToString(id),&quot; = &quot;,l);
     }
   else
      Print(&quot;Error, Code = &quot;,GetLastError());
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Opera√ß√µes de Arquivos, Propriedades de Arquivos</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2511
<h3>FileIsEnding</h3>
Define o final do arquivo em processo de leitura.
</p>
<pre><code class="language-mql5">
bool¬† FileIsEnding(
   int¬† file_handle¬†     // Manipulador de arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
A fun√ß√£o retorna verdadeiro se o fim do arquivo foi alcan√ßado no processo de leitura ou em
movimento do ponteiro de arquivo.
<h3>Observa√ß√£o</h3>
Para definir o final do arquivo, a fun√ß√£o tenta ler a pr√≥xima string a partir dele. Se a string n√£o
existe, a fun√ß√£o retorna true, caso contr√°rio, retorna false.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;file.txt&quot;;    // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;;   // nome do diret√≥rio
input int    InpEncodingType=FILE_ANSI; // ANSI=32 ou UNICODE=64
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- Imprimir o caminho para o arquivo que vamos usar
   PrintFormat(&quot;Trabalhando %s\\Arquivos\\ pasta&quot;,TerminalInfoString(TERMINAL_DATA_PAT
//--- redefine o valor de erro
   ResetLastError();
//--- abrir um arquivo para leitura(se n√£o existe arquivo, ocorrer√° um erro)
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_TXT|InpEn
   if(file_handle!=INVALID_HANDLE)
     {
      //--- imprimir o conte√∫do do arquivo
      while(!FileIsEnding(file_handle))
         Print(FileReadString(file_handle));
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
      PrintFormat(&quot;Erro, c√≥digo = %d&quot;,GetLastError());</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2512
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2513
<h3>FileIsLineEnding</h3>
Define o final da linha do arquivo de texto em processo de leitura.
</p>
<pre><code class="language-mql5">
bool¬† FileIsLineEnding(
   int¬† file_handle¬†     // Manipulador de arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Retorna true se no processo de leitura do arquivo txt ou csv chegou ao fim da linha (os caracteres
CR-LF).
Exemplo (o arquivo obtido durante a execu√ß√£o de um exemplo para a fun√ß√£o FileWriteString √© usado
aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                        Demo_FileIsLineEnding.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 5
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;Sobre-compra &amp; Sobre-venda&quot;
#property indicator_type1   DRAW_COLOR_BARS
#property indicator_color1  clrRed, clrBlue
#property indicator_style1  STYLE_SOLID
#property indicator_width1  2
//--- param√™tros para leitura de dados
input string InpFileName=&quot;RSI.csv&quot;;   // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- buffers do indicador
double   open_buff[];
double   high_buff[];
double   low_buff[];
double   close_buff[];
double   color_buff[];
//--- vari√°veis sobre-comprado
int      ovb_ind=0;
int      ovb_size=0;
</code></pre>
<p>
datetime ovb_time[];</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2514
</p>
<pre><code class="language-mql5">
//--- vari√°veis sobre-vendido
int      ovs_ind=0;
int      ovs_size=0;
</code></pre>
<p>
datetime ovs_time[];
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- vari√°veis de tamanhos de array por padr√£o
   int ovb_def_size=100;
   int ovs_def_size=100;
//--- alocar mem√≥ria para arrays
   ArrayResize(ovb_time,ovb_def_size);
   ArrayResize(ovs_time,ovs_def_size);
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_CSV|FILE_
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      double value;
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- ler o primeiro valor na string
         value=FileReadNumber(file_handle);
         //--- ler diferentes arrays de acordo com o resultado da fun√ß√£o
         if(value&gt;=70)
            ReadData(file_handle,ovb_time,ovb_size,ovb_def_size);
         else
            ReadData(file_handle,ovs_time,ovs_size,ovs_def_size);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligando as arrays
   SetIndexBuffer(0,open_buff,INDICATOR_DATA);
   SetIndexBuffer(1,high_buff,INDICATOR_DATA);
   SetIndexBuffer(2,low_buff,INDICATOR_DATA);
   SetIndexBuffer(3,close_buff,INDICATOR_DATA);
   SetIndexBuffer(4,color_buff,INDICATOR_COLOR_INDEX);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2515
</p>
<pre><code class="language-mql5">
//---- definir os valores dos indicadores que n√£o ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Ler dados do arquivo da string¬†                                  |
//+------------------------------------------------------------------+
void ReadData(const int file_handle,datetime &amp;arr[],int &amp;size,int &amp;def_size)
  {
   bool flag=false;
//--- √© alcan√ßada a leitura at√© o final da string ou do arquivo
   while(!FileIsLineEnding(file_handle) &amp;&amp; !FileIsEnding(file_handle))
     {
      //--- deslocar o transporte ap√≥s a leitura do n√∫mero
      if(flag)
         FileReadNumber(file_handle);
      //--- armazenar a data atual
      arr[size]=FileReadDatetime(file_handle);
      size++;
      //--- aumentar tamanho da array, se necess√°rio
      if(size==def_size)
        {
         def_size+=100;
         ArrayResize(arr,def_size);
        }
      //--- passar despercebido a primeira itera√ß√£o
      flag=true;
     }
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
   ArraySetAsSeries(open,false);
   ArraySetAsSeries(high,false);
   ArraySetAsSeries(low,false);
   ArraySetAsSeries(close,false);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2516
</p>
<pre><code class="language-mql5">
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      open_buff[i]=0;
      high_buff[i]=0;
      low_buff[i]=0;
      close_buff[i]=0;
      color_buff[i]=0;
      //--- verificar se qualquer data continua presente
      if(ovb_ind&lt;ovb_size)
         for(int j=ovb_ind;j&lt;ovb_size;j++)
           {
            //--- se as datas coincidem, a barra est√° na zona de sobre-compra
            if(time[i]==ovb_time[j])
              {
               open_buff[i]=open[i];
               high_buff[i]=high[i];
               low_buff[i]=low[i];
               close_buff[i]=close[i];
               //--- 0 - cor vermelha
               color_buff[i]=0;
               //--- aumentar o contador
               ovb_ind=j+1;
               break;
              }
           }
      //--- verificar se todos os dados continuam a existir
      if(ovs_ind&lt;ovs_size)
         for(int j=ovs_ind;j&lt;ovs_size;j++)
           {
            //--- se as datas coincidem, a barra est√° na zona de sobre-venda
            if(time[i]==ovs_time[j])
              {
               open_buff[i]=open[i];
               high_buff[i]=high[i];
               low_buff[i]=low[i];
               close_buff[i]=close[i];
               //--- 1 - cor azul
               color_buff[i]=1;
               //--- aumentar o contador
               ovs_ind=j+1;
               break;
              }
           }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2517
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Manipulador de eventos ChartEvent¬†                               |
//+------------------------------------------------------------------+
void OnChartEvent(const int id,
                  const long &amp;lparam,
                  const double &amp;dparam,
                  const string &amp;sparam
                  )
  {
//---alterar a largura indicador de acordo com a escala
   if(ChartGetInteger(0,CHART_SCALE)&gt;3)
      PlotIndexSetInteger(0,PLOT_LINE_WIDTH,2);
   else
      PlotIndexSetInteger(0,PLOT_LINE_WIDTH,1);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileWriteString</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2518
<h3>FileReadArray</h3>
L√™ a partir de um arquivo do tipo arrays BIN de qualquer tipo, exceto string (pode ser uma array de
estruturas, n√£o contendo strings e arrays din√¢micas).
uint¬† FileReadArray(
</p>
<pre><code class="language-mql5">
   int¬†   file_handle,¬†              // Manipular arquivo
   void&amp;¬† array[],¬†                  // Array para gravar
   int¬†   start=0,¬†                  // Iniciar posi√ß√£o array para escrever
   int¬†   count=WHOLE_ARRAY          // contar para ler
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
array[]
[out] Uma array onde os dados ser√£o carregados.
start=0
[in]  Posi√ß√£o inicial para escrever para o array.
count=WHOLE_ARRAY
[in]  N√∫mero de elementos para ler. Pelo padr√£o, ler todo o array (count=WHOLE_ARRAY).
<h3>Valor do Retorno</h3>
N√∫mero de elementos para ler.
<h3>Observa√ß√£o</h3>
Array de seq√º√™ncias pode ser lido apenas a partir do arquivo do tipo TXT. Se necess√°rio, a fun√ß√£o
tenta aumentar o tamanho do array.
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWriteArray √© usado aqui)
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;data.bin&quot;;
input string InpDirectoryName=&quot;SomeFolder&quot;;
//+------------------------------------------------------------------+
//| Estrutura para armazenamento de dados de pre√ßos¬†                 |
//+------------------------------------------------------------------+
struct prices
  {
   datetime          date; // data
   double            bid;  // bid pre√ßo
   double            ask;  // ask pre√ßo
</code></pre>
<p>
  };
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2519
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
void OnStart()
  {
//--- estrutura array
   prices arr[];
//--- caminho do arquivo
   string path=InpDirectoryName+&quot;//&quot;+InpFileName;
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(path,FILE_READ|FILE_BIN);
   if(file_handle!=INVALID_HANDLE)
     {
      //--- ler todos os dados do arquivo para o array
      FileReadArray(file_handle,arr);
      //--- receber o tamanho do array
      int size=ArraySize(arr);
      //--- imprimir dados a partir do array
      for(int i=0;i&lt;size;i++)
         Print(&quot;Data = &quot;,arr[i].date,&quot; Bid = &quot;,arr[i].bid,&quot; Ask = &quot;,arr[i].ask);
      Print(&quot;Dados total = &quot;,size);
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
      Print(&quot;Abrir arquivo falhou, erro &quot;,GetLastError());
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Vari√°veis,FileWriteArray</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2520
<h3>FileReadBool</h3>
L√™ a partir do arquivo de CSV de tipo string a partir da posi√ß√£o atual para um delimitador (ou at√© o fim
da linha de texto) e converte a leitura string para um valor de tipo bool.
</p>
<pre><code class="language-mql5">
bool¬† FileReadBool(
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Linha de leitura pode ser definida como &quot;true&quot;, &quot;false&quot; ou a representa√ß√£o simb√≥lica de inteiros &quot;0&quot;
ou &quot;1&quot;. Um valor diferente de zero √© convertido para um true l√≥gico. A fun√ß√£o retorna o valor
convertido.
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWrite √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            Demo_FileReadBool.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 2
#property indicator_plots   2
//---- Plotar Etiqueta1
#property indicator_label1  &quot;UpSignal&quot;
#property indicator_type1   DRAW_ARROW
#property indicator_color1  clrRed
#property indicator_style1  STYLE_SOLID
#property indicator_width1  4
//---- plotar Label2
#property indicator_label2  &quot;DownSignal&quot;
#property indicator_type2   DRAW_ARROW
#property indicator_color2  clrRed
#property indicator_style2  STYLE_SOLID
#property indicator_width2  4
//--- param√™tros para leitura de dados
input string InpFileName=&quot;MACD.csv&quot;;  // file name
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- vari√°veis globais
int      ind=0;       // √≠ndice
double   upbuff[];    // buffers indicador de setas para cima</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2521
</p>
<pre><code class="language-mql5">
double   downbuff[];  // buffers indicador de setas para baix
bool     sign_buff[]; // sinal array (verdadeiro - comprar, falso - vender)
</code></pre>
<p>
datetime time_buff[]; // conjunto de chegada dos sinais time
</p>
<pre><code class="language-mql5">
int      size=0;      // tamanho de arrays de sinal
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_CSV);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo esta aberto para leitura&quot;,InpFileName);
      //--- em primeiro lugar, ler o n√∫mero de sinais
      size=(int)FileReadNumber(file_handle);
      //--- alocar mem√≥ria para os arrays
      ArrayResize(sign_buff,size);
      ArrayResize(time_buff,size);
      //--- ler dados de um arquivo
      for(int i=0;i&lt;size;i++)
        {
         //--- tempo de sinal
         time_buff[i]=FileReadDatetime(file_handle);
         //--- valor do sinal
         sign_buff[i]=FileReadBool(file_handle);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligando as arrays
   SetIndexBuffer(0,upbuff,INDICATOR_DATA);
   SetIndexBuffer(1,downbuff,INDICATOR_DATA);
//--- definir o c√≥digo s√≠mbolo para desenho em PLOT_ARROW
   PlotIndexSetInteger(0,PLOT_ARROW,241);
   PlotIndexSetInteger(1,PLOT_ARROW,242);
//---- definir os valores dos indicadores que n√£o ser√£o vistos no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
   PlotIndexSetDouble(1,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2522
</p>
<pre><code class="language-mql5">
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
   ArraySetAsSeries(low,false);
   ArraySetAsSeries(high,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      upbuff[i]=0;
      downbuff[i]=0;
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               //--- desenhar a seta de acordo com o sinal
               if(sign_buff[j])
                  upbuff[i]=high[i];
               else
                  downbuff[i]=low[i];
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipo bool, FileWrite</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2523
<h3>FileReadDatetime</h3>
L√™ a partir do arquivo do tipo CSV uma string de um dos formatos: &quot;YYYY.MM.DD HH:MM:SS&quot;,
&quot;YYYY.MM.DD&quot; ou &quot;HH:MM:SS&quot; - e converte-os dentro de valor do tipo datetime.
datetime¬† FileReadDatetime(
</p>
<pre><code class="language-mql5">
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
O valor do tipo datetime.
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWrite √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                        Demo_FileReadDateTime.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 2
#property indicator_plots   2
//---- Plotar Etiqueta1
#property indicator_label1  &quot;UpSignal&quot;
#property indicator_type1   DRAW_ARROW
#property indicator_color1  clrRed
#property indicator_style1  STYLE_SOLID
#property indicator_width1  4
//---- plotar Label2
#property indicator_label2  &quot;DownSignal&quot;
#property indicator_type2   DRAW_ARROW
#property indicator_color2  clrRed
#property indicator_style2  STYLE_SOLID
#property indicator_width2  4
//--- param√™tros para leitura de dados
input string InpFileName=&quot;MACD.csv&quot;;  // file name
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- vari√°veis globais
int      ind=0;       // √≠ndice
double   upbuff[];    // buffers indicador de setas para cima
double   downbuff[];  // buffers indicador de setas para baix
bool     sign_buff[]; // sinal array (verdadeiro - comprar, falso - vender)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2524
datetime time_buff[]; // conjunto de chegada dos sinais time
</p>
<pre><code class="language-mql5">
int      size=0;      // tamanho de arrays de sinal
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_CSV);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo esta aberto para leitura&quot;,InpFileName);
      //--- em primeiro lugar, ler o n√∫mero de sinais
      size=(int)FileReadNumber(file_handle);
      //--- alocar mem√≥ria para os arrays
      ArrayResize(sign_buff,size);
      ArrayResize(time_buff,size);
      //--- ler dados de um arquivo
      for(int i=0;i&lt;size;i++)
        {
         //--- tempo de sinal
         time_buff[i]=FileReadDatetime(file_handle);
         //--- valor do sinal
         sign_buff[i]=FileReadBool(file_handle);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligando as arrays
   SetIndexBuffer(0,upbuff,INDICATOR_DATA);
   SetIndexBuffer(1,downbuff,INDICATOR_DATA);
//--- definir o c√≥digo s√≠mbolo para desenho em PLOT_ARROW
   PlotIndexSetInteger(0,PLOT_ARROW,241);
   PlotIndexSetInteger(1,PLOT_ARROW,242);
//---- definir os valores dos indicadores que n√£o ser√£o vistos no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
   PlotIndexSetDouble(1,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2525
</p>
<pre><code class="language-mql5">
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
   ArraySetAsSeries(low,false);
   ArraySetAsSeries(high,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      upbuff[i]=0;
      downbuff[i]=0;
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               //--- desenhar a seta de acordo com o sinal
               if(sign_buff[j])
                  upbuff[i]=high[i];
               else
                  downbuff[i]=low[i];
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipo datetime, StringToTime, TimeToString, FileWrite</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2526
<h3>FileReadDouble</h3>
L√™ uma dupla precis√£o de n√∫mero de ponto (double) flutuante a partir da posi√ß√£o atual do arquivo
bin√°rio.
</p>
<pre><code class="language-mql5">
double¬† FileReadDouble(
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Valor de tipo double.
<h3>Observa√ß√£o</h3>
Para mais detalhes sobre erro, chamar GetLastError().
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo para a fun√ß√£o FileWriteDouble √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileReadDouble.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 1
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;MA&quot;
#property indicator_type1   DRAW_LINE
#property indicator_color1  clrGreen
#property indicator_style1  STYLE_SOLID
#property indicator_width1  2
#property indicator_separate_window
//--- leitura de dados de par√¢metros
input string InpFileName=&quot;MA.csv&quot;;    // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- vari√°veis globais
int      ind=0;
int      size=0;
double   ma_buff[];
</code></pre>
<p>
datetime time_buff[];
</p>
<pre><code class="language-mql5">
//--- buffer do indicador
double   buff[];</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2527
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- em primeiro lugar, ler a quantidade de dados no arquivo
      size=(int)FileReadDouble(file_handle);
      //--- alocar mem√≥ria para os arrays
      ArrayResize(ma_buff,size);
      ArrayResize(time_buff,size);
      //--- ler dados de um arquivo
      for(int i=0;i&lt;size;i++)
        {
         time_buff[i]=(datetime)FileReadDouble(file_handle);
         ma_buff[i]=FileReadDouble(file_handle);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- Associa o array ao buffer do indicador com √≠ndice 0
   SetIndexBuffer(0,buff,INDICATOR_DATA);
//---- definir os valores dos indicadores que n√£o ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2528
</p>
<pre><code class="language-mql5">
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      buff[i]=0;
      //--- verificar se todos os dados continuam a existir
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               buff[i]=ma_buff[j];
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
Tipos reais (double, float), StringToDouble, DoubleToString, FileWriteDouble</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2529
<h3>FileReadFloat</h3>
L√™ a precis√£o simples de um n√∫mero (float) de ponto a partir da posi√ß√£o atual do arquivo bin√°rio.
float¬† FileReadFloat(
</p>
<pre><code class="language-mql5">
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
O valor do tipo float.
<h3>Observa√ß√£o</h3>
Para mais detalhes sobre erro, chamar GetLastError().
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWriteFloat √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           Demo_FileReadFloat.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_separate_window
#property indicator_buffers 2
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;CloseLine&quot;
#property indicator_type1   DRAW_COLOR_LINE
#property indicator_color1  clrRed,clrBlue
#property indicator_style1  STYLE_SOLID
#property indicator_width1  2
//--- param√™tros para leitura de dados
input string InpFileName=&quot;Close.bin&quot;; // file name
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- vari√°veis globais
int      ind=0;
int      size=0;
double   close_buff[];
</code></pre>
<p>
datetime time_buff[];
</p>
<pre><code class="language-mql5">
//--- buffers do indicador
double   buff[];
double   color_buff[];
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2530
</p>
<pre><code class="language-mql5">
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
   int def_size=100;
//--- alocar mem√≥ria para os arrays
   ArrayResize(close_buff,def_size);
   ArrayResize(time_buff,def_size);
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- ler valores de tempo e pre√ßo
         time_buff[size]=(datetime)FileReadDouble(file_handle);
         close_buff[size]=(double)FileReadFloat(file_handle);
         size++;
         //--- aumentar o tamanho do array, se eles est√£o transbordados
         if(size==def_size)
           {
            def_size+=100;
            ArrayResize(close_buff,def_size);
            ArrayResize(time_buff,def_size);
           }
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Dados s√£o lidos, %s arquivo est√° fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligar arrays para os buffers de indicadores
   SetIndexBuffer(0,buff,INDICATOR_DATA);
   SetIndexBuffer(1,color_buff,INDICATOR_COLOR_INDEX);
//---- definir os valores dos indicadores que n√£o ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2531
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      buff[i]=0;
      color_buff[i]=0; // cor vermelha por padr√£o
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               //--- receber o pre√ßo
               buff[i]=close_buff[j];
               //--- se o pre√ßo atual excede o anterior, a cor √© azul
               if(buff[i-1]&gt;buff[i])
                  color_buff[i]=1;
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipos Reais (double, float), FileReadDouble, FileWriteFloat</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2532
<h3>FileReadInteger</h3>
A fun√ß√£o l√™ os valores int, short ou char a partir da posi√ß√£o atual do ponteiro do arquivo, dependendo
do comprimento especificado em bytes.
</p>
<pre><code class="language-mql5">
int¬† FileReadInteger(
   int¬† file_handle,¬†       // Manipular Arquivo
   int¬† size=INT_VALUE¬†     // Tamanho de um inteiro em bytes
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
size=INT_VALUE
[in]  N√∫mero de bytes (at√© 4 inclusive), que devem ser lidos. As constantes correspondentes s√£o
fornecidos: CHAR_VALUE = 1, SHORT_VALUE = 2 e INT_VALUE = 4, ent√£o a fun√ß√£o pode ler todo o
valor do tipo char, short ou int.
<h3>Valor do Retorno</h3>
Um valor do tipo int. O resultado desta fun√ß√£o deve ser explicitamente convertido para um tipo de
destino, ou seja, para o tipo de dados que voc√™ precisa ler. Uma vez que um valor do tipo int √©
retornado, ele pode ser facilmente convertido para qualquer valor inteiro. O ponteiro do arquivo √©
deslocado pelo n√∫mero de bytes lidos.
<h3>Observa√ß√£o</h3>
Quando ler menos do que 4 bytes, o resultado recebido √© sempre positivo. Se um ou dois bytes s√£o
lidos, o sinal do n√∫mero pode ser determinado por colagem expl√≠cita do tipo char (1 byte) ou short (2
bytes). Recebendo o sinal para um n√∫mero de tr√™s bytes n√£o √© simples, uma vez que n√£o h√°
nenhuma correspondente tipo subjacente.
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWriteInteger √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                         Demo_FileReadInteger.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 1
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;Trends&quot;
#property indicator_type1   DRAW_SECTION
#property indicator_color1  clrRed
#property indicator_style1  STYLE_SOLID</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2533
</p>
<pre><code class="language-mql5">
#property indicator_width1  1
//--- param√™tros para leitura de dados
input string InpFileName=&quot;Trend.bin&quot;; // file name
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- vari√°veis globais
int      ind=0;
int      size=0;
</code></pre>
<p>
datetime time_buff[];
</p>
<pre><code class="language-mql5">
//--- buffers do indicador
double   buff[];
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
   int def_size=100;
//--- alocar mem√≥ria para o array
   ArrayResize(time_buff,def_size);
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- vari√°veis ‚Äãadicionais
      int    arr_size;
      uchar  arr[];
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- descobrir quantos s√≠mbolos s√£o usados ‚Äãpara escrever o tempo
         arr_size=FileReadInteger(file_handle,INT_VALUE);
         ArrayResize(arr,arr_size);
         for(int i=0;i&lt;arr_size;i++)
            arr[i]=(char)FileReadInteger(file_handle,CHAR_VALUE);
         //--- armazenar o valor de tempo
         time_buff[size]=StringToTime(CharArrayToString(arr));
         size++;
         //--- aumentar as dimens√µes arrays, se s√£o transbordados
         if(size==def_size)
           {
            def_size+=100;
            ArrayResize(time_buff,def_size);
           }
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Dados s√£o lidos, %s arquivo est√° fechado&quot;,InpFileName);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2534
</p>
<pre><code class="language-mql5">
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligar array para buffer de indicador
   SetIndexBuffer(0,buff,INDICATOR_DATA);
//---- definir os valores dos indicadores que n√£o ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
   ArraySetAsSeries(close,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      buff[i]=0;
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               //--- receber o pre√ßo
               buff[i]=close[i];
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2535
</p>
<pre><code class="language-mql5">
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
IntegerToString, StringToInteger, Tipos inteiros, FileWriteInteger</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2536
<h3>FileReadLong</h3>
A fun√ß√£o l√™ um inteiro do tipo long (8 bytes) a partir da posi√ß√£o atual do arquivo bin√°rio.
long¬† FileReadLong(
</p>
<pre><code class="language-mql5">
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Valor de tipo long.
Exemplo (o arquivo obtido durante a execu√ß√£o de um exemplo para a fun√ß√£o FileWriteLong √© usado
aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            Demo_FileReadLong.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_buffers 1
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;Volume&quot;
#property indicator_type1   DRAW_LINE
#property indicator_color1  clrYellow
#property indicator_style1  STYLE_SOLID
#property indicator_width1  2
#property indicator_separate_window
//--- param√™tros para leitura de dados
input string InpFileName=&quot;Volume.bin&quot;; // file name
input string InpDirectoryName=&quot;Data&quot;;  // directory name
//--- vari√°veis globais
int      ind=0;
int      size=0;
</code></pre>
<p>
long     volume_buff[];
datetime time_buff[];
</p>
<pre><code class="language-mql5">
//--- buffers do indicador
double   buff[];
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2537
</p>
<pre><code class="language-mql5">
  {
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN);
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° aberto para escrita&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- em primeiro lugar, ler a quantidade de dados no arquivo
      size=(int)FileReadLong(file_handle);
      //--- alocar mem√≥ria para os arrays
      ArrayResize(volume_buff,size);
      ArrayResize(time_buff,size);
      //--- ler dados de um arquivo
      for(int i=0;i&lt;size;i++)
        {
         time_buff[i]=(datetime)FileReadLong(file_handle);
         volume_buff[i]=FileReadLong(file_handle);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Dados s√£o lidos, %s arquivo est√° fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- associa o array ao buffer do indicador com √≠ndice 0
   SetIndexBuffer(0,buff,INDICATOR_DATA);
//---- definir os valores dos indicadores que ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2538
</p>
<pre><code class="language-mql5">
   ArraySetAsSeries(time,false);
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      buff[i]=0;
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==time_buff[j])
              {
               buff[i]=(double)volume_buff[j];
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipos Inteiros, FileReadInteger, FileWriteLong</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2539
<h3>FileReadNumber</h3>
A fun√ß√£o l√™ do arquivo CSV uma string a partir da posi√ß√£o atual at√© um separador (ou at√© o fim de uma
seq√º√™ncia de texto) e converte a string de leitura para um valor do tipo double.
</p>
<pre><code class="language-mql5">
double¬† FileReadNumber(
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Valor de tipo double.
Exemplo (o arquivo obtido durante a execu√ß√£o de um exemplo para a fun√ß√£o FileWriteString √© usado
aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileReadNumber.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_chart_window
#property indicator_buffers 5
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;Sobre-compra &amp; Sobre-venda&quot;
#property indicator_type1   DRAW_COLOR_BARS
#property indicator_color1  clrRed, clrBlue
#property indicator_style1  STYLE_SOLID
#property indicator_width1  2
//--- param√™tros para leitura de dados
input string InpFileName=&quot;RSI.csv&quot;;   // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//--- buffers do indicador
double   open_buff[];
double   high_buff[];
double   low_buff[];
double   close_buff[];
double   color_buff[];
//--- vari√°veis sobre-comprado
int      ovb_ind=0;
int      ovb_size=0;
</code></pre>
<p>
datetime ovb_time[];</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2540
</p>
<pre><code class="language-mql5">
//--- vari√°veis sobre-vendido
int      ovs_ind=0;
int      ovs_size=0;
</code></pre>
<p>
datetime ovs_time[];
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- vari√°veis de tamanhos de array por padr√£o
   int ovb_def_size=100;
   int ovs_def_size=100;
//--- alocar mem√≥ria para arrays
   ArrayResize(ovb_time,ovb_def_size);
   ArrayResize(ovs_time,ovs_def_size);
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_CSV|FILE_
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      double value;
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- ler o primeiro valor na string
         value=FileReadNumber(file_handle);
         //--- ler diferentes arrays de acordo com o resultado da fun√ß√£o
         if(value&gt;=70)
            ReadData(file_handle,ovb_time,ovb_size,ovb_def_size);
         else
            ReadData(file_handle,ovs_time,ovs_size,ovs_def_size);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- ligando as arrays
   SetIndexBuffer(0,open_buff,INDICATOR_DATA);
   SetIndexBuffer(1,high_buff,INDICATOR_DATA);
   SetIndexBuffer(2,low_buff,INDICATOR_DATA);
   SetIndexBuffer(3,close_buff,INDICATOR_DATA);
   SetIndexBuffer(4,color_buff,INDICATOR_COLOR_INDEX);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2541
</p>
<pre><code class="language-mql5">
//---- definir os valores dos indicadores que n√£o ser√£o vis√≠veis no gr√°fico
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Ler dados do arquivo da string¬†                                  |
//+------------------------------------------------------------------+
void ReadData(const int file_handle,datetime &amp;arr[],int &amp;size,int &amp;def_size)
  {
   bool flag=false;
//--- √© alcan√ßada a leitura at√© o final da string ou do arquivo
   while(!FileIsLineEnding(file_handle) &amp;&amp; !FileIsEnding(file_handle))
     {
      //--- deslocar o transporte ap√≥s a leitura do n√∫mero
      if(flag)
         FileReadNumber(file_handle);
      //--- armazenar a data atual
      arr[size]=FileReadDatetime(file_handle);
      size++;
      //--- aumentar tamanho da array, se necess√°rio
      if(size==def_size)
        {
         def_size+=100;
         ArrayResize(arr,def_size);
        }
      //--- passar despercebido a primeira itera√ß√£o
      flag=true;
     }
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
   ArraySetAsSeries(open,false);
   ArraySetAsSeries(high,false);
   ArraySetAsSeries(low,false);
   ArraySetAsSeries(close,false);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2542
</p>
<pre><code class="language-mql5">
//---o loop para as barras que ainda n√£o foram manipuladas
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      open_buff[i]=0;
      high_buff[i]=0;
      low_buff[i]=0;
      close_buff[i]=0;
      color_buff[i]=0;
      //--- verificar se qualquer data continua presente
      if(ovb_ind&lt;ovb_size)
         for(int j=ovb_ind;j&lt;ovb_size;j++)
           {
            //--- se as datas coincidem, a barra est√° na zona de sobre-compra
            if(time[i]==ovb_time[j])
              {
               open_buff[i]=open[i];
               high_buff[i]=high[i];
               low_buff[i]=low[i];
               close_buff[i]=close[i];
               //--- 0 - cor vermelha
               color_buff[i]=0;
               //--- aumentar o contador
               ovb_ind=j+1;
               break;
              }
           }
      //--- verificar se todos os dados continuam a existir
      if(ovs_ind&lt;ovs_size)
         for(int j=ovs_ind;j&lt;ovs_size;j++)
           {
            //--- se as datas coincidem, a barra est√° na zona de sobre-venda
            if(time[i]==ovs_time[j])
              {
               open_buff[i]=open[i];
               high_buff[i]=high[i];
               low_buff[i]=low[i];
               close_buff[i]=close[i];
               //--- 1 - cor azul
               color_buff[i]=1;
               //--- aumentar o contador
               ovs_ind=j+1;
               break;
              }
           }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2543
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Manipulador de eventos ChartEvent¬†                               |
//+------------------------------------------------------------------+
void OnChartEvent(const int id,
                  const long &amp;lparam,
                  const double &amp;dparam,
                  const string &amp;sparam
                  )
  {
//---alterar a largura indicador de acordo com a escala
   if(ChartGetInteger(0,CHART_SCALE)&gt;3)
      PlotIndexSetInteger(0,PLOT_LINE_WIDTH,2);
   else
      PlotIndexSetInteger(0,PLOT_LINE_WIDTH,1);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileWriteString</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2544
<h3>FileReadString</h3>
A fun√ß√£o l√™ uma string a partir da posi√ß√£o atual do ponteiro de arquivo dentro de um arquivo.
</p>
<pre><code class="language-mql5">
string¬† FileReadString(
   int¬† file_handle,¬†    // Manipular arquivo
   int¬† length=-1¬†       // Comprimento string
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
length=-1
[in]  N√∫mero de caracteres para ler.
<h3>Valor do Retorno</h3>
Ler linha (string).
<h3>Observa√ß√£o</h3>
Quando ler a partir de um arquivo bin, o tamanho de uma string para ler deve ser especificada.
Quando ler a partir de um arquivo txt, o tamanho da string n√£o √© necess√°ria, e a string ser√° lida a
partir da posi√ß√£o atual para a alimenta√ß√£o da linha caractere &quot;\r\n&quot;. Quando ler a partir de um
arquivo CSV,o tamanho da string n√£o √© necess√°ria tamb√©m, a string ser√° lida a partir da posi√ß√£o
atual at√© o mais pr√≥ximo delimitador ou at√© string de texto caractere final.
Se o arquivo √© aberto com a bandeira FILE_ANSI, ent√£o a linha lida √© convertida para um Unicode.
Exemplo (o arquivo obtido ap√≥s a execu√ß√£o do exemplo pela fun√ß√£o FileWriteInteger √© usado aqui)
</p>
<pre><code class="language-mql5">
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- param√™tros para leitura de dados
input string InpFileName=&quot;Trend.bin&quot;; // file name
input string InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN|FILE_
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- vari√°veis ‚Äãadicionais
      int    str_size;
      string str;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2545
</p>
<pre><code class="language-mql5">
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- descobrir quantos s√≠mbolos s√£o usados ‚Äãpara escrever o tempo
         str_size=FileReadInteger(file_handle,INT_VALUE);
         //--- ler a string
         str=FileReadString(file_handle,str_size);
         //--- imprimir a string
         PrintFormat(str);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Dados s√£o lidos, %s arquivo est√° fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipo string, Convers√£o de Dados, FileWriteInteger</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2546
<h3>FileReadStruct</h3>
A fun√ß√£o l√™ o conte√∫do em uma estrutura passada como um par√¢metro a partir de um arquivo bin√°rio,
come√ßando com a posi√ß√£o atual do ponteiro de arquivo.
uint¬† FileReadStruct(
</p>
<pre><code class="language-mql5">
   int¬†         file_handle,¬†       // Manipular arquivo
   const void&amp;¬† struct_object,¬†     // estrutura alvo para o qual os conte√∫dos s√£o lid
   int¬†         size=-1¬†            // tamanho da estrutura em bytes
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in] Descritor de arquivo para abrir um arquivo bin.
struct_object
[out]  O objeto desta estrutura. A estrutura n√£o deve conter strings, arrays din√¢micas, fun√ß√µes
virtuais, objetos de classes, bem como ponteiros para objetos e fun√ß√µes.
size=-1
[in]  N√∫mero de bytes que devem ser lidos. Se a dimens√£o n√£o for especificado ou a indica√ß√£o do
valor √© maior do que o tamanho da estrutura, o tamanho exato da especificada estrutura √© usado.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes lidos. Ponteiro de arquivo √© movido pelo
mesmo n√∫mero de bytes.
Exemplo (o arquivo obtido ap√≥s a utiliza√ß√£o do exemplo para a fun√ß√£o FileWriteStruct √© usado aqui)
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileReadStruct.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property indicator_separate_window
#property indicator_buffers 4
#property indicator_plots   1
//---- Plotar Etiqueta1
#property indicator_label1  &quot;Candles&quot;
#property indicator_type1   DRAW_CANDLES
#property indicator_color1  clrOrange
#property indicator_style1  STYLE_SOLID
#property indicator_width1  1
#property indicator_separate_window
//--- par√¢metros para recebimento de dados
input string  InpFileName=&quot;EURUSD.txt&quot;; // nome do arquivo
input string  InpDirectoryName=&quot;Data&quot;;  // nome do diret√≥rio</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2547
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Estrutura para armazenar dados candlestick¬†                      |
//+------------------------------------------------------------------+
struct candlesticks
  {
   double            open;  // pre√ßo de abertura
   double            close; // pre√ßo de fechamento
   double            high;  // pre√ßo de m√°ximo
   double            low;   // pre√ßo de m√≠nimo
   datetime          date;  // data
</code></pre>
<p>
  };
</p>
<pre><code class="language-mql5">
//--- buffers do indicador
double       open_buff[];
double       close_buff[];
double       high_buff[];
double       low_buff[];
//--- vari√°veis globais
</code></pre>
<p>
candlesticks cand_buff[];
</p>
<pre><code class="language-mql5">
int          size=0;
int          ind=0;
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do indicador customizado¬†                |
//+------------------------------------------------------------------+
int OnInit()
  {
   int default_size=100;
   ArrayResize(cand_buff,default_size);
//--- abre o arquivo
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_BIN|FILE_
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      PrintFormat(&quot;File path: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_COMMONDATA_PATH
      //--- ler dados de um arquivo
      while(!FileIsEnding(file_handle))
        {
         //--- escrever dados para array
         FileReadStruct(file_handle,cand_buff[size]);
         size++;
         //--- verificar se array est√° transbordando
         if(size==default_size)
           {
            //--- aumentar a dimens√£o array
            default_size+=100;
            ArrayResize(cand_buff,default_size);
           }
        }
      //--- fechar o arquivo</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2548
</p>
<pre><code class="language-mql5">
      FileClose(file_handle);
      PrintFormat(&quot;Dados s√£o lidos, %s arquivo est√° fechado&quot;,InpFileName);
     }
   else
     {
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
      return(INIT_FAILED);
     }
//--- mapeamento de buffers do indicador
   SetIndexBuffer(0,open_buff,INDICATOR_DATA);
   SetIndexBuffer(1,high_buff,INDICATOR_DATA);
   SetIndexBuffer(2,low_buff,INDICATOR_DATA);
   SetIndexBuffer(3,close_buff,INDICATOR_DATA);
//--- valor vazio
   PlotIndexSetDouble(0,PLOT_EMPTY_VALUE,0);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de itera√ß√£o do indicador customizado¬†                     |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &amp;time[],
                const double &amp;open[],
                const double &amp;high[],
                const double &amp;low[],
                const double &amp;close[],
                const long &amp;tick_volume[],
                const long &amp;volume[],
                const int &amp;spread[])
  {
   ArraySetAsSeries(time,false);
//--- o loop para os casti√ßais que ainda n√£o foram manipulados
   for(int i=prev_calculated;i&lt;rates_total;i++)
     {
      //--- 0 por padr√£o
      open_buff[i]=0;
      close_buff[i]=0;
      high_buff[i]=0;
      low_buff[i]=0;
      //---verificar se todos os dados ainda est√£o presente
      if(ind&lt;size)
        {
         for(int j=ind;j&lt;size;j++)
           {
            //--- se as datas coincidem, usar o valor do arquivo
            if(time[i]==cand_buff[j].date)
              {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2549
</p>
<pre><code class="language-mql5">
               open_buff[i]=cand_buff[j].open;
               close_buff[i]=cand_buff[j].close;
               high_buff[i]=cand_buff[j].high;
               low_buff[i]=cand_buff[j].low;
               //--- aumentar o contador
               ind=j+1;
               break;
              }
           }
        }
     }
//--- valor retorno de prev_calculated para a pr√≥xima chamada
   return(rates_total);
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Estruturas e classes, FileWriteStruct</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2550
<h3>FileSeek</h3>
A fun√ß√£o move a posi√ß√£o do ponteiro de arquivo por um certo n√∫mero de bytes de informa√ß√£o em
rela√ß√£o √† posi√ß√£o especificada.
</p>
<pre><code class="language-mql5">
bool¬† FileSeek(
   int¬†                 file_handle,¬†    // Manipular arquivo
   long¬†                offset,¬†         // Em bytes
   ENUM_FILE_POSITION¬†  origin¬†          // Posi√ß√£o para refer√™ncia
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
offset
[in] A mudan√ßa de bytes (pode tomar um valor negativo).
origin
[in] O ponto de partida para o deslocamento. Pode ser um dos valores de ENUM_FILE_POSITION.
<h3>Valor do Retorno</h3>
Retorna true se bem sucedido, caso contr√°rio false. Para obter informa√ß√£o sobre o erro chamar
GetLastError().
<h3>Observa√ß√£o</h3>
Se a execu√ß√£o da fun√ß√£o FileSeek() resulta em uma mudan√ßa negativa (indo al√©m do &quot;n√≠vel limite&quot;
do arquivo), o ponteiro do arquivo ser√° definido para o arquivo de in√≠cio.
Se a posi√ß√£o for definido para al√©m do &quot;limite direito&quot; do arquivo (maior do que o tamanho do
arquivo),a pr√≥xima escrita para o arquivo ser√° executado n√£o a partir do final do arquivo, mas a
partir da posi√ß√£o definida. Neste caso, os valores indefinidos ser√£o escritos para o final do arquivo
anterior e a posi√ß√£o definida.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                Demo_FileSeek.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;file.txt&quot;;    // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;;   // nome do diret√≥rio
input int    InpEncodingType=FILE_ANSI; // ANSI=32 ou UNICODE=64</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2551
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- especificar o valor da vari√°vel para gerar n√∫meros aleat√≥rios
   _RandomSeed=GetTickCount();
//--- vari√°veis ‚Äãpara posi√ß√µes de pontos de in√≠cio das strings
   ulong pos[];
   int   size;
//--- redefine o valor de erro
   ResetLastError();
//--- abre o arquivo
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_TXT|InpEn
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      //--- receber a posi√ß√£o inicial para cada string no arquivo
      GetStringPositions(file_handle,pos);
      //--- definir o n√∫mero de strings no arquivo
      size=ArraySize(pos);
      if(!size)
        {
         //--- parar se o arquivo n√£o tem strings
         PrintFormat(&quot;%s arquivo est√° vazio!&quot;,InpFileName);
         FileClose(file_handle);
         return;
        }
      //--- fazer uma sele√ß√£o aleat√≥ria de um n√∫mero de string
      int ind=MathRand()%size;
      //--- deslocar posi√ß√£o de ponto de partida da string
      if(FileSeek(file_handle,pos[ind],SEEK_SET)==true)
        {
      //--- ler e imprimir a string com o n√∫mero ind
         PrintFormat(&quot;Texto string com %d n√∫mero: \&quot;%s\&quot;&quot;,ind,FileReadString(file_hand
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;%s arquivo est√° vazio&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+-------------------------------------------------------------------------------+
//| A fun√ß√£o define pontos de partida para cada uma das strings no arquivo e¬†     |
//| coloca-los em arr array¬†                                                      |
//+-------------------------------------------------------------------------------+
void GetStringPositions(const int handle,ulong &amp;arr[])
  {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2552
</p>
<pre><code class="language-mql5">
//--- array tamanho padr√£o
   int def_size=127;
//--- alocar mem√≥ria para o array
   ArrayResize(arr,def_size);
//--- contador string
   int i=0;
//--- se isto n√£o √© o fim do arquivo, ent√£o h√° pelo menos uma string
   if(!FileIsEnding(handle))
     {
      arr[i]=FileTell(handle);
      i++;
     }
   else
      return; // o arquivo est√° vazio, sair
//--- define o deslocamento em bytes, dependendo em codifica√ß√£o
   int shift;
   if(FileGetInteger(handle,FILE_IS_ANSI))
      shift=1;
   else
      shift=2;
//--- ir atrav√©s das strings no loop
   while(1)
     {
      //--- ler a string
      FileReadString(handle);
      //--- verificar o final do arquivo
      if(!FileIsEnding(handle))
        {
         //--- armazenar a pr√≥xima posi√ß√£o da string
         arr[i]=FileTell(handle)+shift;
         i++;
         //--- aumentar o tamanho da array, se ela √© transbordada
         if(i==def_size)
           {
            def_size+=def_size+1;
            ArrayResize(arr,def_size);
           }
        }
      else
         break; // final do arquivo, sair
     }
//--- definir o tamanho real de array
   ArrayResize(arr,i);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2553
<h3>FileSize</h3>
A fun√ß√£o retorna o tamanho do arquivo em bytes.
ulong¬† FileSize(
</p>
<pre><code class="language-mql5">
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
O valor do tipo int.
<h3>Observa√ß√£o</h3>
Para obter informa√ß√£o sobre o erro chamar GetLastError().
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros de entrada
input ulong  InpThresholdSize=20;        // tamanho limite do arquivo em kilobytes
input string InpBigFolderName=&quot;big&quot;;     // pasta para arquivos grandes
input string InpSmallFolderName=&quot;small&quot;; // pasta para arquivo pequeno
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string   file_name;      // vari√°vel para armazenar os nomes dos arquivos
   string   filter=&quot;*.csv&quot;; // filtro para pesquisar os arquivos
   ulong    file_size=0;    // tamanho do arquivo em bytes
   int      size=0;         // n√∫mero de arquivos
//--- imprimir o caminho para o arquivo que vamos trabalhar com
   PrintFormat(&quot;Trabalhando em pasta %s\\Files\\&quot;,TerminalInfoString(TERMINAL_COMMONDA
//--- receber o manipulador de pesquisa em comum na raiz da pasta de todos os terminai
   long search_handle=FileFindFirst(filter,file_name,FILE_COMMON);
//--- verificar se FileFindFirst() √© executada com sucesso
   if(search_handle!=INVALID_HANDLE)
     {
      //--- mover arquivos no loop de acordo com seus tamanhos
      do
        {
         //--- abrir o arquivo
         ResetLastError();
         int file_handle=FileOpen(file_name,FILE_READ|FILE_CSV|FILE_COMMON);
         if(file_handle!=INVALID_HANDLE)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2554
</p>
<pre><code class="language-mql5">
           {
            //--- receber o tamanho do arquivo
            file_size=FileSize(file_handle);
            //--- fechar o arquivo
            FileClose(file_handle);
           }
         else
           {
            PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,file_name,G
            continue;
           }
         //--- imprimir o tamanho do arquivo
         PrintFormat(&quot;Tamanho do %s arquivo √© igual para %d bytes&quot;,file_name,file_size
         //--- define o caminho para movimentar o arquivo
         string path;
         if(file_size&gt;InpThresholdSize*1024)
            path=InpBigFolderName+&quot;//&quot;+file_name;
         else
            path=InpSmallFolderName+&quot;//&quot;+file_name;
         //--- mover o arquivo
         ResetLastError();
         if(FileMove(file_name,FILE_COMMON,path,FILE_REWRITE|FILE_COMMON))
            PrintFormat(&quot;%s arquivo foi movido&quot;,file_name);
         else
            PrintFormat(&quot;Erro, c√≥digo = %d&quot;,GetLastError());
        }
      while(FileFindNext(search_handle,file_name));
      //--- fechar o manipulador de pesquisa
      FileFindClose(search_handle);
     }
   else
      Print(&quot;Arquivo n√£o encontrado!&quot;);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2555
<h3>FileTell</h3>
O arquivo retorna a posi√ß√£o atual do ponteiro de arquivo de um arquivo aberto.
ulong¬† FileTell(
</p>
<pre><code class="language-mql5">
   int¬† file_handle¬†   // Manipular arquivo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
<h3>Valor do Retorno</h3>
Posi√ß√£o atual do descritor de arquivo em bytes a partir do in√≠cio do arquivo.
<h3>Observa√ß√£o</h3>
Para obter informa√ß√£o sobre o erro chamar GetLastError().
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                Demo_FileTell.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mosta a janela dos par√¢metros de entrada quando lan√ßado o script
#property script_show_inputs
//--- par√¢metros de entrada
input string InpFileName=&quot;file.txt&quot;;    // nome do arquivo
input string InpDirectoryName=&quot;Data&quot;;   // nome do diret√≥rio
input int    InpEncodingType=FILE_ANSI; // ANSI=32 ou UNICODE=64
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- especificar o valor da vari√°vel para gerar n√∫meros aleat√≥rios
   _RandomSeed=GetTickCount();
//--- vari√°veis ‚Äãpara posi√ß√µes de pontos de in√≠cio das strings
   ulong pos[];
   int   size;
//--- redefine o valor de erro
   ResetLastError();
//--- abre o arquivo
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_TXT|InpEn
   if(file_handle!=INVALID_HANDLE)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2556
</p>
<pre><code class="language-mql5">
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para leitura&quot;,InpFileName);
      //--- receber a posi√ß√£o inicial para cada string no arquivo
      GetStringPositions(file_handle,pos);
      //--- definir o n√∫mero de strings no arquivo
      size=ArraySize(pos);
      if(!size)
        {
         //--- parar se o arquivo n√£o tem strings
         PrintFormat(&quot;%s arquivo est√° vazio!&quot;,InpFileName);
         FileClose(file_handle);
         return;
        }
      //--- fazer uma sele√ß√£o aleat√≥ria de um n√∫mero de string
      int ind=MathRand()%size;
      //--- deslocar posi√ß√£o de ponto de partida da string
      FileSeek(file_handle,pos[ind],SEEK_SET);
      //--- ler e imprimir a string com o n√∫mero ind
      PrintFormat(&quot;Texto string com %d n√∫mero: \&quot;%s\&quot;&quot;,ind,FileReadString(file_handle)
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;%s arquivo est√° vazio&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+-------------------------------------------------------------------------------+
//| A fun√ß√£o define pontos de partida para cada uma das strings no arquivo e¬†     |
//| coloca-los em arr array¬†                                                      |
//+-------------------------------------------------------------------------------+
void GetStringPositions(const int handle,ulong &amp;arr[])
  {
//--- array tamanho padr√£o
   int def_size=127;
//--- alocar mem√≥ria para o array
   ArrayResize(arr,def_size);
//--- contador string
   int i=0;
//--- se isto n√£o √© o fim do arquivo, ent√£o h√° pelo menos uma string
   if(!FileIsEnding(handle))
     {
      arr[i]=FileTell(handle);
      i++;
     }
   else
      return; // o arquivo est√° vazio, sair
//--- define o deslocamento em bytes, dependendo em codifica√ß√£o
   int shift;
   if(FileGetInteger(handle,FILE_IS_ANSI))</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2557
</p>
<pre><code class="language-mql5">
      shift=1;
   else
      shift=2;
//--- ir atrav√©s das strings no loop
   while(1)
     {
      //--- ler a string
      FileReadString(handle);
      //--- verificar o final do arquivo
      if(!FileIsEnding(handle))
        {
         //--- armazenar a pr√≥xima posi√ß√£o da string
         arr[i]=FileTell(handle)+shift;
         i++;
         //--- aumentar o tamanho da array, se ela √© transbordada
         if(i==def_size)
           {
            def_size+=def_size+1;
            ArrayResize(arr,def_size);
           }
        }
      else
         break; // final do arquivo, sair
     }
//--- definir o tamanho real de array
   ArrayResize(arr,i);
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2558
<h3>FileWrite</h3>
A fun√ß√£o destina-se a grava√ß√£o de dados em um arquivo CSV, delimitador sendo inserido
automaticamente a menos que seja igual a 0. Depois de escrever dentro do arquivo, o caractere de
final de linha &quot;\r\n&quot; ser√° adicionado.
uint¬† FileWrite(
</p>
<pre><code class="language-mql5">
   int¬† file_handle,¬†  // manipular arquivo
   ...                 // Lista de par√¢metros gravados
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
...
[in] A lista de par√¢metros separados por v√≠rgulas, para escrever no arquivo. O n√∫mero de
par√¢metros escritos pode ser de at√© 63.
<h3>Valor do Retorno</h3>
N√∫mero de bytes escritos.
<h3>Observa√ß√£o</h3>
Os n√∫meros ser√£o convertidos dentro de um texto na sa√≠da (veja a print() fun√ß√£o). Dados do tipo
</p>
<pre><code class="language-mql5">
double s√£o emitidos com a precis√£o de 16 d√≠gitos depois do ponto decimal, e os dados podem ser
</code></pre>
<p>
exibidos quer no formato tradicional ou no formato cient√≠fico - dependendo de qual formato ser√° o
mais compacto. Os dados do tipo float s√£o mostrados com cinco d√≠gitos depois do ponto decimal.
Para emitir n√∫meros reais com precis√£o diferente ou em um formato claramente especificado, use
DoubleToString(). 
N√∫meros do tipo bool s√£o exibidos como &quot;true&quot; ou &quot;false&quot; strings. N√∫meros do tipo datetime s√£o
apresentados como &quot;YYYY.MM.DD HH:MI:SS&quot;.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                               Demo_FileWrite.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string             InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES    InpSymbolPeriod=PERIOD_H1;        // per√≠odo de tempo
input int                InpFastEMAPeriod=12;              // per√≠odo r√°pido EMA
input int                InpSlowEMAPeriod=26;              // per√≠odo lento EMA</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2559
</p>
<pre><code class="language-mql5">
input int                InpSignalPeriod=9;                // diferen√ßa de per√≠odo m√©d
input ENUM_APPLIED_PRICE InpAppliedPrice=PRICE_CLOSE;      // tipo de pre√ßo
input datetime           InpDateStart=D&#x27;2012.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia 
//--- par√¢metros para a grava√ß√£o de dados ao arquivo
input string             InpFileName=&quot;MACD.csv&quot;;  // nome do arquivo
input string             InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date_finish; // copiando dados com a data final
   bool     sign_buff[]; // sinal array (verdadeiro - comprar, falso - vender)
   datetime time_buff[]; // array de chegada de tempo de sinais
   int      sign_size=0; // tamanho de array
   double   macd_buff[]; // array do valor do indicador
   datetime date_buff[]; // array da data do indicador
   int      macd_size=0; // tamanho de arrays de indicadores
//--- tempo final √© o tempo corrente
   date_finish=TimeCurrent();
//--- receber a manipula√ß√£o do indicador MACD
   ResetLastError();
   int macd_handle=iMACD(InpSymbolName,InpSymbolPeriod,InpFastEMAPeriod,InpSlowEMAPeri
   if(macd_handle==INVALID_HANDLE)
     {
      //--- falha para receber a manipula√ß√£o do indicador
      PrintFormat(&quot;Erro quando recebe a manipula√ß√£o do indicador. C√≥digo de erro = %d&quot;
      return;
     }
//--- estando no loop at√© que o indicador calcula todos os seus valores
   while(BarsCalculated(macd_handle)==-1)
      Sleep(10); // pausa para permitir que o indicador calcule os respectivos valores
//--- copiar os valores do indicador para um determinado per√≠odo de tempo
   ResetLastError();
   if(CopyBuffer(macd_handle,0,InpDateStart,date_finish,macd_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores do indicador. C√≥digo de erro = %d&quot;,GetLas
      return;
     }
//--- copiar o tempo apropriado para os valores do indicador
   ResetLastError();
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,date_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- libera a mem√≥ria ocupada pelo indicador
   IndicatorRelease(macd_handle);
//--- receber o tamanho do buffer</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2560
</p>
<pre><code class="language-mql5">
   macd_size=ArraySize(macd_buff);
//--- analisar os dados e salva os sinais do indicador para arrays
   ArrayResize(sign_buff,macd_size-1);
   ArrayResize(time_buff,macd_size-1);
   for(int i=1;i&lt;macd_size;i++)
     {
      //--- sinal comprar
      if(macd_buff[i-1]&lt;0 &amp;&amp; macd_buff[i]&gt;=0)
        {
         sign_buff[sign_size]=true;
         time_buff[sign_size]=date_buff[i];
         sign_size++;
        }
      //--- sinal vender
      if(macd_buff[i-1]&gt;0 &amp;&amp; macd_buff[i]&lt;=0)
        {
         sign_buff[sign_size]=false;
         time_buff[sign_size]=date_buff[i];
         sign_size++;
        }
     }
//--- abrir o arquivo para escrever os valores do indicador (se o arquivo estiver ause
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para ser escrito&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- primeiro, escreva o n√∫mero de sinais
      FileWrite(file_handle,sign_size);
      //--- escrever o tempo e os valores de sinais para o arquivo
      for(int i=0;i&lt;sign_size;i++)
         FileWrite(file_handle,time_buff[i],sign_buff[i]);
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Comment, Print, StringFormat</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2561
<h3>FileWriteArray</h3>
A fun√ß√£o escreve arrays de qualquer tipo, exceto para string de um arquivo bin (pode strings ou arrays
din√¢micas).
uint¬† FileWriteArray(
</p>
<pre><code class="language-mql5">
   int¬†         file_handle,¬†        // Manipular arquivo
   const void&amp;¬† array1[],¬†           // Array
   int¬†         start=0,¬†            // Iniciar √≠ndice array
   int¬†         count=WHOLE_ARRAY    // N√∫mero de elementos
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
array[]
[out] Array para grava√ß√£o.
start=0
[in]  In√≠cio do √≠ndice array (n√∫mero do primeiro elemento gravado).
count=WHOLE_ARRAY
[in]  N√∫mero de itens para gravar(WHOLE_ARRAY significa que as grava√ß√µes de todos os itens
come√ßam com o n√∫mero inicial at√© o final da array).
<h3>Valor do Retorno</h3>
N√∫mero de itens gravados.
<h3>Observa√ß√£o</h3>
String array pode ser gravada em arquivo TXT. Neste caso, strings s√£o automaticamente terminadas
pela linha final de caracteres &quot;\r\n&quot;. Dependendo sobre o arquivo tipo ANSI ou UNICODE, strings s√£o
ambas convertidas para ansi-codifica√ß√£o ou n√£o.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileWriteArray.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- par√¢metros de entrada
input string InpFileName=&quot;data.bin&quot;;
input string InpDirectoryName=&quot;SomeFolder&quot;;
//+------------------------------------------------------------------+
//| Estrutura para armazenamento de dados de pre√ßos¬†                 |
//+------------------------------------------------------------------+</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2562
</p>
<pre><code class="language-mql5">
struct prices
  {
   datetime          date; // data
   double            bid;  // bid pre√ßo
   double            ask;  // ask pre√ßo
</code></pre>
<p>
  };
</p>
<pre><code class="language-mql5">
//--- vari√°veis globais
int    count=0;
int    size=20;
string path=InpDirectoryName+&quot;//&quot;+InpFileName;
</code></pre>
<p>
prices arr[];
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de inicializa√ß√£o do Expert¬†                               |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- alocar mem√≥ria para o array
   ArrayResize(arr,size);
//---
   return(INIT_SUCCEEDED);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o de Desinicializa√ß√£o do Expert                             |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//--- escrever a contagem restante de strings se count &lt; n
   WriteData(count);
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Fun√ß√£o tick (ponto) de um Expert                                 |
//+------------------------------------------------------------------+
void OnTick()
  {
//--- salvar dados para array
   arr[count].date=TimeCurrent();
   arr[count].bid=SymbolInfoDouble(Symbol(),SYMBOL_BID);
   arr[count].ask=SymbolInfoDouble(Symbol(),SYMBOL_ASK);
//--- mostra dados correntes
   Print(&quot;Date = &quot;,arr[count].date,&quot; Bid = &quot;,arr[count].bid,&quot; Ask = &quot;,arr[count].ask);
//--- aumentar o contador
   count++;
//--- se array √© arquivada, gravar dados no arquivo e zer√°-lo
   if(count==size)
     {
      WriteData(size);
      count=0;
     }
</code></pre>
<p>
  }</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2563
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Escrever n elementos array para arquivo¬†                         |
//+------------------------------------------------------------------+
void WriteData(const int n)
  {
//--- abre o arquivo
   ResetLastError();
   int handle=FileOpen(path,FILE_READ|FILE_WRITE|FILE_BIN);
   if(handle!=INVALID_HANDLE)
     {
      //--- escrever os dados array para o final do arquivo
      FileSeek(handle,0,SEEK_END);
      FileWriteArray(handle,arr,0,n);
      //--- fechar o arquivo
      FileClose(handle);
     }
   else
      Print(&quot;Falha para abrir o arquivo, erro &quot;,GetLastError());
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Vari√°veis, FileSeek</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2564
<h3>FileWriteDouble</h3>
A fun√ß√£o escreve o valor de um par√¢metro duplo para um arquivo bin, a partir da posi√ß√£o atual do
ponteiro de arquivo.
uint¬† FileWriteDouble(
</p>
<pre><code class="language-mql5">
   int¬†    file_handle,¬†    // Manipular arquivo
   double¬† value¬†           // Valor para escrever
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
value
[in]   O valor do tipo double.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos (neste caso sizeof(double)=8). O
ponteiro do arquivo √© deslocado pelo mesmo n√∫mero de bytes.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                         Demo_FileWriteDouble.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string             InpSymbolName=&quot;EURJPY&quot;;           // par de moedas
input ENUM_TIMEFRAMES    InpSymbolPeriod=PERIOD_M15;       // per√≠odo de tempo
input int                InpMAPeriod=10;                   // per√≠odo suavizado
input int                InpMAShift=0;                     // deslocacamente de indica
input ENUM_MA_METHOD     InpMAMethod=MODE_SMA;             // tipo de suaviza√ß√£o
input ENUM_APPLIED_PRICE InpAppliedPrice=PRICE_CLOSE;      // tipo de pre√ßo
input datetime           InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia 
//--- par√¢metros para escrever dados no arquivo
input string             InpFileName=&quot;MA.csv&quot;;    // file name
input string             InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2565
</p>
<pre><code class="language-mql5">
   datetime date_finish=TimeCurrent();
   double   ma_buff[];
   datetime time_buff[];
   int      size;
//--- receber a manipulador do indicador MA
   ResetLastError();
   int ma_handle=iMA(InpSymbolName,InpSymbolPeriod,InpMAPeriod,InpMAShift,InpMAMethod,
   if(ma_handle==INVALID_HANDLE)
     {
      //--- falha para receber a manipula√ß√£o do indicador
      PrintFormat(&quot;Erro quando recebe a manipula√ß√£o do indicador. C√≥digo de erro = %d&quot;
      return;
     }
//--- estando no loop at√© que o indicador calcula todos os seus valores
   while(BarsCalculated(ma_handle)==-1)
      Sleep(20); // pausa para permitir que o indicador calcule os respectivos valores
   PrintFormat(&quot;Valores dos indicadores come√ßando a partir de %s ser√° escrita no arqui
//--- copiar os valores dos indicadores
   ResetLastError();
   if(CopyBuffer(ma_handle,0,InpDateStart,date_finish,ma_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores do indicador. C√≥digo de erro = %d&quot;,GetLas
      return;
     }
//--- copiar o tempo da apropriada chegada das barras
   ResetLastError();
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,time_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- receber o tamanho do buffer
   size=ArraySize(ma_buff);
//--- libera a mem√≥ria ocupada pelo indicador
   IndicatorRelease(ma_handle);
//--- abrir o arquivo para escrever os valores do indicador (se o arquivo estiver ause
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para ser escrito&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- em primeiro lugar, escrever o tamanho da amostra de dados
      FileWriteDouble(file_handle,(double)size);
      //--- escrever o tempo do indicador e valor para o arquivo
      for(int i=0;i&lt;size;i++)
        {
         FileWriteDouble(file_handle,(double)time_buff[i]);
         FileWriteDouble(file_handle,ma_buff[i]);</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2566
</p>
<pre><code class="language-mql5">
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipos reais (double, float)</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2567
<h3>FileWriteFloat</h3>
A fun√ß√£o escreve o valor do par√¢metro float para um arquivo bin, a partir da atual posi√ß√£o do ponteiro
de arquivo.
uint¬† FileWriteFloat(
</p>
<pre><code class="language-mql5">
   int¬†   file_handle,¬†    // Manipular arquivo
   float¬† value¬†           // Valor para ser escrito
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
value
[in] O valor do tipo float.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos (neste caso sizeof(float)=4). O
ponteiro do arquivo √© deslocado pelo mesmo n√∫mero de bytes.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileWriteFloat.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string          InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES InpSymbolPeriod=PERIOD_M15;       // per√≠odo de tempo
input datetime        InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia dos
//--- par√¢metros para escrever dados no arquivo
input string          InpFileName=&quot;Close.bin&quot;; // nome do arquivo
input string          InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date_finish=TimeCurrent();
   double   close_buff[];
   datetime time_buff[];
   int      size;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2568
</p>
<pre><code class="language-mql5">
//--- redefine o valor de erro
   ResetLastError();
//--- copiar o pre√ßo de fechamento de cada barra
   if(CopyClose(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,close_buff)==-1
     {
      PrintFormat(&quot;Falha ao copiar valores de pre√ßo de fechamento. C√≥digo de erro = %d
      return;
     }
//--- copiar o tempo para cada barra
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,time_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- receber o tamanho do buffer
   size=ArraySize(close_buff);
//--- abrir o arquivo para escrever os valores (se o arquivo estiver ausente, ele ser√°
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° aberto para escrita&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- escrever fechamento do tempo dos pre√ßos e os valores para o arquivo
      for(int i=0;i&lt;size;i++)
        {
         FileWriteDouble(file_handle,(double)time_buff[i]);
         FileWriteFloat(file_handle,(float)close_buff[i]);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipos reais (double, float), FileWriteDouble</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2569
<h3>FileWriteInteger</h3>
A fun√ß√£o escreve o valor do par√¢metro int para um arquivo bin, a partir da posi√ß√£o atual do ponteiro
de arquivo.
uint¬† FileWriteInteger(
</p>
<pre><code class="language-mql5">
   int¬† file_handle,¬†       // Manipular Arquivo
   int¬† value,¬†             // Valor para ser escrito
   int¬† size=INT_VALUE¬†     // Tamanho em bytes
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
value
[in] Valor inteiro.
size=INT_VALUE
[in] N√∫mero de bytes (at√© 4 inclusive), que deve ser escrito. As constantes correspondentes s√£o
fornecidos: CHAR_VALUE=1, SHORT_VALUE=2 e INT_VALUE=4, ent√£o a fun√ß√£o pode escrever o
valor inteiro do tipo char, uchar, short, ushort, int, ou uint.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos. O ponteiro do arquivo √©
deslocado pelo mesmo n√∫mero de bytes.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                        Demo_FileWriteInteger.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string             InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES    InpSymbolPeriod=PERIOD_H1;        // per√≠odo de tempo
input datetime           InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia 
//--- par√¢metros para escrever dados no arquivo
input string             InpFileName=&quot;Trend.bin&quot;; // nome do arquivo
input string             InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2570
</p>
<pre><code class="language-mql5">
  {
   datetime date_finish=TimeCurrent();
   double   close_buff[];
   datetime time_buff[];
   int      size;
//--- redefine o valor de erro
   ResetLastError();
//--- copiar o pre√ßo de fechamento de cada barra
   if(CopyClose(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,close_buff)==-1
     {
      PrintFormat(&quot;Falha ao copiar os valores dos pre√ßos de fechamento. C√≥digo de erro
      return;
     }
//--- copiar o tempo para cada barra
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,time_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- receber o tamanho do buffer
   size=ArraySize(close_buff);
//--- abrir o arquivo para escrever os valores (se o arquivo estiver ausente, ele ser√°
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para ser escrito&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- 
      int   up_down=0; // tend√™ncia flag
      int   arr_size;  // tamanho de array arr
      uchar arr[];     // array tipo uchar
      //--- escrever valores de tempo para o arquivo
      for(int i=0;i&lt;size-1;i++)
        {
         //--- comparar pre√ßos de fechamento das atuais e pr√≥ximas barras
         if(close_buff[i]&lt;=close_buff[i+1])
           {
            if(up_down!=1)
              {
               //--- escrever valor de data para o arquivo usando FileWriteInteger
               StringToCharArray(TimeToString(time_buff[i]),arr);
               arr_size=ArraySize(arr);
               //--- primeiro, escreva o n√∫mero de s√≠mbolos na array
               FileWriteInteger(file_handle,arr_size,INT_VALUE);
               //--- escrever os s√≠mbolos
               for(int j=0;j&lt;arr_size;j++)
                  FileWriteInteger(file_handle,arr[j],CHAR_VALUE);
               //--- mudar a flag de tend√™ncia</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2571
</p>
<pre><code class="language-mql5">
               up_down=1;
              }
           }
         else
           {
            if(up_down!=-1)
              {
               //--- escrever valor de data para o arquivo usando FileWriteInteger
               StringToCharArray(TimeToString(time_buff[i]),arr);
               arr_size=ArraySize(arr);
               //--- primeiro, escreva o n√∫mero de s√≠mbolos na array
               FileWriteInteger(file_handle,arr_size,INT_VALUE);
               //--- escrever os s√≠mbolos
               for(int j=0;j&lt;arr_size;j++)
                  FileWriteInteger(file_handle,arr[j],CHAR_VALUE);
               //--- mudar a flag de tend√™ncia
               up_down=-1;
              }
           }
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>IntegerToString, StringToInteger, Tipos Inteiros</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2572
<h3>FileWriteLong</h3>
A fun√ß√£o escreve o valor do par√¢metro de tipo long para um arquivo bin, a partir da posi√ß√£o atual do
ponteiro de arquivo.
uint¬† FileWriteLong(
</p>
<pre><code class="language-mql5">
   int¬†  file_handle,¬†    // Manipular arquivo
   long¬† value¬†           // Valor para ser escrito
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
value
[in] Valor do tipo long.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos (neste caso sizeof(long)=8). O
ponteiro do arquivo √© deslocado pelo mesmo n√∫mero de bytes.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                           Demo_FileWriteLong.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string          InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES InpSymbolPeriod=PERIOD_H1;        // time frame
input datetime        InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia dos
//--- par√¢metros para escrever dados no arquivo
input string          InpFileName=&quot;Volume.bin&quot;; // nome do arquivo
input string          InpDirectoryName=&quot;Data&quot;;  // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date_finish=TimeCurrent();
   long     volume_buff[];
   datetime time_buff[];
   int      size;</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2573
</p>
<pre><code class="language-mql5">
//--- redefine o valor de erro
   ResetLastError();
//--- copiar volumes de tick para cada bar
   if(CopyTickVolume(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,volume_buf
     {
      PrintFormat(&quot;Falha ao copiar valores do volume de tick. C√≥digo de erro = %d&quot;,Get
      return;
     }
//--- copiar o tempo para cada barra
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,time_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- receber o tamanho do buffer
   size=ArraySize(volume_buff);
//--- abrir o arquivo para escrever os valores do indicador (se o arquivo estiver ause
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para ser escrito&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- primeiro, escreva o tamanho da amostra de dados
      FileWriteLong(file_handle,(long)size);
      //--- escrever valores de tempo e de volume para o arquivo
      for(int i=0;i&lt;size;i++)
        {
         FileWriteLong(file_handle,(long)time_buff[i]);
         FileWriteLong(file_handle,volume_buff[i]);
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipos inteiros, FileWriteInteger</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2574
<h3>FileWriteString</h3>
A fun√ß√£o escreve o valor de um par√¢metro do tipo string em um arquivo BIN, CSV ou TXT come√ßando a
partir da posi√ß√£o atual do ponteiro de arquivo. Quando escrever para um arquivo CSV ou TXT: se
existe um s√≠mbolo na string &#x27;\n&#x27; (LF) sem caractere anterior &#x27;\r&#x27; (CR), ent√£o antes de &#x27;\n&#x27; desaparecer &#x27;\r&#x27;
√© adicionado.
uint¬† FileWriteString(
</p>
<pre><code class="language-mql5">
   int¬†          file_handle,¬†   // Manipular arquivo
   const string¬† text_string,    // string para escrever
   int¬†          length=-1¬†      // n√∫mero de s√≠mbolos
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
text_string
[in]  Seq√º√™ncia.
length=-1
[in] O n√∫mero de caracteres que voc√™ quer escrever. Esta op√ß√£o √© necess√°ria para escrever uma
</p>
<pre><code class="language-mql5">
string em um arquivo BIN. Se o tamanho n√£o for especificado, ent√£o a string inteira, sem o trailer
</code></pre>
<p>
0 (zero) √© escrita. Se voc√™ especificar um tamanho menor do que o comprimento da string, ent√£o
uma parte da string sem o trailer 0 (zero) √© escrita. Se voc√™ especificar um tamanho maior do que
o comprimento da string, a string √© preenchido por um n√∫mero apropriado de zeros. Para arquivos
do tipo CSV e TXT, este par√¢metro √© ignorado e a string √© escrita inteiramente.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos. O ponteiro do arquivo √©
deslocado pelo mesmo n√∫mero de bytes.
<h3>Observa√ß√£o</h3>
Note que quando se escreve para um arquivo aberto pela bandeira FILE_UNICODE (ou sem uma
bandeira FILE_ANSI), ent√£o o n√∫mero de bytes escrito ser√° duas vezes t√£o grande como o n√∫mero de
cadeia de string escritas. Quando gravar para um arquivo aberto com a bandeira FILE_ANSI, o
n√∫mero de bytes escritos ir√° coincidir com o n√∫mero de caracteres de string escritas.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                         Demo_FileWriteString.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2575
</p>
<pre><code class="language-mql5">
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string             InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES    InpSymbolPeriod=PERIOD_H1;        // per√≠odo de tempo
input int                InpMAPeriod=14;                   // per√≠odo de m√©dia m√≥vel
input ENUM_APPLIED_PRICE InpAppliedPrice=PRICE_CLOSE;      // tipo de pre√ßo
input datetime           InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia 
//--- par√¢metros para escrever dados no arquivo
input string             InpFileName=&quot;RSI.csv&quot;;   // nome do arquivo
input string             InpDirectoryName=&quot;Data&quot;; // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date_finish; // copiando dados com a data final
   double   rsi_buff[];  // array do valor do indicador
   datetime date_buff[]; // array da data do indicador
   int      rsi_size=0;  // tamanho de arrays de indicadores
//--- tempo final √© o atual
   date_finish=TimeCurrent();
//--- receber a manipula√ß√£o do indicador RSI
   ResetLastError();
   int rsi_handle=iRSI(InpSymbolName,InpSymbolPeriod,InpMAPeriod,InpAppliedPrice);
   if(rsi_handle==INVALID_HANDLE)
     {
      //--- falha para receber a manipula√ß√£o do indicador
      PrintFormat(&quot;Erro quando recebe a manipula√ß√£o do indicador. C√≥digo de erro = %d&quot;
      return;
     }
//--- fica no loop, at√© que o indicador calcula todos os seus valores
   while(BarsCalculated(rsi_handle)==-1)
      Sleep(10); // pausa para permitir que o indicador calcule os respectivos valores
//--- copiar os valores do indicador para um determinado per√≠odo de tempo
   ResetLastError();
   if(CopyBuffer(rsi_handle,0,InpDateStart,date_finish,rsi_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores do indicador. C√≥digo de erro = %d&quot;,GetLas
      return;
     }
//--- copiar o tempo apropriado para os valores do indicador
   ResetLastError();
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,date_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- libera a mem√≥ria ocupada pelo indicador
   IndicatorRelease(rsi_handle);
//--- receber o tamanho do buffer</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2576
</p>
<pre><code class="language-mql5">
   rsi_size=ArraySize(rsi_buff);
//--- abrir o arquivo para escrever os valores do indicador (se o arquivo estiver ause
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° dispon√≠vel para ser escrito&quot;,InpFileName);
      PrintFormat(&quot;Caminho do arquivo: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_DATA_P
      //--- preparar vari√°veis adicionais
      string str=&quot;&quot;;
      bool   is_formed=false;
      //--- escrever datas de forma√ß√£o das √°reas de sobre-compra e sobre-venda 
      for(int i=0;i&lt;rsi_size;i++)
        {
         //--- verifique os valores dos indicadores
         if(rsi_buff[i]&gt;=70 || rsi_buff[i]&lt;=30)
           {
            //--- se o valor √© o primeiro nesta √°rea
            if(!is_formed)
              {
               //--- adicionar o valor e a data
               str=(string)rsi_buff[i]+&quot;\t&quot;+(string)date_buff[i];
               is_formed=true;
              }
            else
               str+=&quot;\t&quot;+(string)rsi_buff[i]+&quot;\t&quot;+(string)date_buff[i];
            //--- mover para a pr√≥xima itera√ß√£o do loop
            continue;
           }
         //--- verificar a flag
         if(is_formed)
           {
            //--- a string √© formada, escrev√™-lo para o arquivo
            FileWriteString(file_handle,str+&quot;\r\n&quot;);
            is_formed=false;
           }
        }
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Tipo string, StringFormat</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2577
<h3>FileWriteStruct</h3>
A fun√ß√£o escreve em arquivo bin um conte√∫do de uma estrutura passada como um par√¢metro,
come√ßando a partir da posi√ß√£o atual do ponteiro de arquivo.
uint¬† FileWriteStruct(
</p>
<pre><code class="language-mql5">
   int¬†         file_handle,       // Manipular arquivo
   const void&amp;¬† struct_object,¬†    // link para um objeto
   int¬†         size=-1            // tamanho a ser escrito em bytes
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_handle
[in]  Descritor de arquivo retornado pelo FileOpen().
struct_object
[in] Refer√™ncia ao objeto desta estrutura. A estrutura n√£o deve conter strings, arrays din√¢micas,
fun√ß√µes virtuais, objetos de classes, bem como ponteiros para objetos e fun√ß√µes.
size=-1
[in] N√∫mero de bytes que voc√™ quer gravar. Se tamanho n√£o √© especificado ou o especificado
n√∫mero de bytes √© maior do que o tamanho da estrutura, a estrutura inteira √© escrita.
<h3>Valor do Retorno</h3>
Se for bem sucedido, a fun√ß√£o retorna o n√∫mero de bytes escritos. O ponteiro do arquivo √©
deslocado pelo mesmo n√∫mero de bytes.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                          Demo_FileWiteStruct.mq5 |
//|                        Copyright 2013, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2013, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- mostrar a janela de par√¢metros de entrada quando do lan√ßamento do script
#property script_show_inputs
//--- par√¢metros para a recep√ß√£o de dados a partir do terminal
input string          InpSymbolName=&quot;EURUSD&quot;;           // par de moedas
input ENUM_TIMEFRAMES InpSymbolPeriod=PERIOD_H1;        // time frame
input datetime        InpDateStart=D&#x27;2013.01.01 00:00&#x27;; // data de in√≠cio da c√≥pia dos
//--- par√¢metros para escrever dados no arquivo
input string          InpFileName=&quot;EURUSD.txt&quot;;         // nome do arquivo
input string          InpDirectoryName=&quot;Data&quot;;          // nome do diret√≥rio
//+------------------------------------------------------------------+
//| Estrutura para armazenar dados candlestick¬†                      |
//+------------------------------------------------------------------+
struct candlesticks</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2578
</p>
<pre><code class="language-mql5">
  {
   double            open;  // pre√ßo de abertura
   double            close; // pre√ßo de fechamento
   double            high;  // pre√ßo de m√°ximo
   double            low;   // pre√ßo de m√≠nimo
   datetime          date;  // data
</code></pre>
<p>
  };
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime     date_finish=TimeCurrent();
   int          size;
   datetime     time_buff[];
   double       open_buff[];
   double       close_buff[];
   double       high_buff[];
   double       low_buff[];
   candlesticks cand_buff[];
//--- redefine o valor de erro
   ResetLastError();
//--- receber o tempo da chegada das barras a partir do intervalo
   if(CopyTime(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,time_buff)==-1)
     {
      PrintFormat(&quot;Falha para copiar valores de tempo. C√≥digo de erro = %d&quot;,GetLastErr
      return;
     }
//--- receber os pre√ßos de m√°ximo das barras a partir do intervalo
   if(CopyHigh(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,high_buff)==-1)
     {
      PrintFormat(&quot;Falha ao copiar os valores dos pre√ßos de m√°ximo. C√≥digo de erro = %
      return;
     }
//--- receber os pre√ßos de m√≠nimo das barras a partir do intervalo
   if(CopyLow(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,low_buff)==-1)
     {
      PrintFormat(&quot;Falha ao copiar os valores dos pre√ßos de m√≠nimo. C√≥digo de erro = %
      return;
     }
//--- receber os pre√ßos de abertura das barras a partir do intervalo
   if(CopyOpen(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,open_buff)==-1)
     {
      PrintFormat(&quot;Falha ao copiar os valores dos pre√ßos de abertura. C√≥digo de erro =
      return;
     }
//--- receber os pre√ßos de fechamento das barras a partir do intervalo
   if(CopyClose(InpSymbolName,InpSymbolPeriod,InpDateStart,date_finish,close_buff)==-1
     {</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2579
</p>
<pre><code class="language-mql5">
      PrintFormat(&quot;Falha ao copiar os valores dos pre√ßos de fechamento. C√≥digo de erro
      return;
     }
//--- definir o tamanho de arrays
   size=ArraySize(time_buff);
//--- salvar todos os dados na estrutura array
   ArrayResize(cand_buff,size);
   for(int i=0;i&lt;size;i++)
     {
      cand_buff[i].open=open_buff[i];
      cand_buff[i].close=close_buff[i];
      cand_buff[i].high=high_buff[i];
      cand_buff[i].low=low_buff[i];
      cand_buff[i].date=time_buff[i];
     }
//--- abrir o arquivo para escrever a estrutura array para o arquivo (se o arquivo est
   ResetLastError();
   int file_handle=FileOpen(InpDirectoryName+&quot;//&quot;+InpFileName,FILE_READ|FILE_WRITE|FIL
   if(file_handle!=INVALID_HANDLE)
     {
      PrintFormat(&quot;%s arquivo est√° aberto para escrita&quot;,InpFileName);
      PrintFormat(&quot;File path: %s\\Files\\&quot;,TerminalInfoString(TERMINAL_COMMONDATA_PATH
      //--- preparar o contador do n√∫mero de bytes
      uint counter=0;
      //--- escrever valores array no loop
      for(int i=0;i&lt;size;i++)
         counter+=FileWriteStruct(file_handle,cand_buff[i]);
      PrintFormat(&quot;%d bytes de informa√ß√£o est√° escrito para %s arquivo&quot;,InpFileName,co
      PrintFormat(&quot;N√∫mero total de bytes: %d * %d * %d = %d, %s&quot;,size,5,8,size*5*8,siz
      //--- fechar o arquivo
      FileClose(file_handle);
      PrintFormat(&quot;Os dados s√£o escritos, %s arquivo esta fechado&quot;,InpFileName);
     }
   else
      PrintFormat(&quot;Falha para abrir %s arquivo, C√≥digo de erro = %d&quot;,InpFileName,GetLa
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>Estruturas e classes</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2580
<h3>FileLoad</h3>
Ele l√™ todo o conte√∫do do arquivo bin√°rio especificado numa variedade transferida de tipos num√©ricos
ou estruturas simples. A fun√ß√£o permite ler rapidamente os dados de um tipo conhecido na matriz
apropriada.
long¬† FileLoad(
</p>
<pre><code class="language-mql5">
   const string  file_name,¬†        // nome do arquivo
   void&amp;       ¬† buffer[],¬†         // matriz de tipos num√©ricos ou estruturas simples
   int¬†          common_flag=0      // sinalizador de arquivo, por padr√£o o arquivo √© 
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_name
[in]  Nome do arquivo a partir do qual ser√£o lidos os dados.
buffer
[out]  Matriz de tipos num√©ricos ou estruturas simples.
common_flag=0
[in]  Sinalizador de arquivo que indica o modo de trabalho. Se este par√¢metro n√£o for
especificado, 
o 
arquivo 
√© 
procurado 
na 
subpasta 
<h3>MQL5\Files</h3>
(ou
&lt;diret√≥rio_do_agente_de_teste&gt;\MQL5\Files em caso de teste). 
<h3>Valor de retorno</h3>
N√∫mero de elementos lidos ou -1 em caso de falha.
<h3>Observa√ß√£o</h3>
A fun√ß√£o FileLoad() l√™, a partir do arquivo, o n√∫mero de bytes m√∫ltiplo do tamanho da matriz. Por
exemplo, suponha que o tamanho do arquivo √© 10 bytes e a leitura de dados √© realizada numa matriz
do tipo double (sizeof(double)=8). Neste caso, voc√™ vai ler apenas 8 bytes, os restantes 2 bytes no
final do arquivo ser√£o simplesmente descartados e a fun√ß√£o FileLoad() retornar√° 1 (lido 1
elemento).
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                Demo_FileLoad.mq5 |
//|                        Copyright 2016, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property script_show_inputs
//--- input parameters
input int      bars_to_save=10; // n√∫mero de barras</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2581
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   string  filename=_Symbol+&quot;_rates.bin&quot;;
   MqlRates rates[];
//---
   int copied=CopyRates(_Symbol,_Period,0,bars_to_save,rates);
   if(copied!=-1)
     {
      PrintFormat(&quot; CopyRates(%s) copied %d bars&quot;,_Symbol,copied);
      //---  escrevemos as cota√ß√µes no arquivo
      if(!FileSave(filename,rates,FILE_COMMON))
         PrintFormat(&quot;FileSave() failed, error=%d&quot;,GetLastError());
     }
   else
      PrintFormat(&quot;Failed CopyRates(%s), error=&quot;,_Symbol,GetLastError());
//--- agora lemos estas cota√ß√µes de volta para o arquivo
   ArrayFree(rates);
   long count=FileLoad(filename,rates,FILE_COMMON);
   if(count!=-1)
     {
      Print(&quot;Time\tOpen\tHigh\tLow\tClose\tTick Voulme\tSpread\tReal Volume&quot;);
      for(int i=0;i&lt;count;i++)
        {
         PrintFormat(&quot;%s\t%G\t%G\t%G\t%G\t%I64u\t%d\t%I64u&quot;,
                     TimeToString(rates[i].time,TIME_DATE|TIME_SECONDS),
                     rates[i].open,rates[i].high,rates[i].low,rates[i].close,
                     rates[i].tick_volume,rates[i].spread,rates[i].real_volume);
        }
     }
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
Estruturas e classes, FileReadArray, FileReadStruct, FileSave</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2582
<h3>FileSave</h3>
Armazena no arquivo bin√°rio todos os elementos da matriz transferida como par√¢metro. A fun√ß√£o
permite armazenar rapidamente -numa cadeia de caracteres- matrizes de tipos num√©ricos ou
estruturas simples.
</p>
<pre><code class="language-mql5">
bool¬† FileSave(
   const string  file_name,¬†        // nome do arquivo
   void&amp;      ¬†  buffer[],¬†         // matriz de tipos num√©ricos ou estruturas simples
   int¬†          common_flag=0      // sinalizador de arquivo, por padr√£o os arquivos 
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
file_name
[in]  Nome do arquivo no qual ser√° armazenada a matriz de dados.
buffer
[in]  Matriz de tipos num√©ricos ou estruturas simples.
common_flag=0
[in]  Sinalizador de arquivo que indica o modo de trabalho. Se este par√¢metro n√£o for
especificado, 
o 
arquivo 
ser√° 
armazenado 
na 
subpasta 
<h3>MQL5\Files</h3>
(ou
&lt;diret√≥rio_do_agente_de_teste&gt;\MQL5\Files em caso de teste). 
<h3>Valor de retorno</h3>
Em caso de falha, a fun√ß√£o retorna false.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                                Demo_FileSave.mq5 |
//|                        Copyright 2016, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
#property script_show_inputs
//--- input parameters
input int      ticks_to_save=1000; // n√∫mero de¬†ticks
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
   string  filename=_Symbol+&quot;_ticks.bin&quot;;
   MqlTick ticks[];
//---
   int copied=CopyTicks(_Symbol,ticks,COPY_TICKS_ALL,0,ticks_to_save);
   if(copied!=-1)</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2583
</p>
<pre><code class="language-mql5">
     {
      PrintFormat(&quot; CopyTicks(%s) copied %d ticks&quot;,_Symbol,copied);
      //--- se o hist√≥rico de ticks estiver sincronizada, o c√≥digo de erro ser√° igual 
      if(!GetLastError()==0)
         PrintFormat(&quot;%s: Ticks are not synchronized, error=%d&quot;,_Symbol,copied,_LastEr
      //---  armazenamos os ticks no arquivo
      if(!FileSave(filename,ticks,FILE_COMMON))
         PrintFormat(&quot;FileSave() failed, error=%d&quot;,GetLastError());
     }
   else
      PrintFormat(&quot;Failed CopyTicks(%s), Error=&quot;,_Symbol,GetLastError());
//--- agora lemos estes ticks de volta para o arquivo
   ArrayFree(ticks);
   long count=FileLoad(filename,ticks,FILE_COMMON);
   if(count!=-1)
     {
      Print(&quot;Time\tBid\tAsk\tLast\tVolume\tms\tflags&quot;);
      for(int i=0;i&lt;count;i++)
        {
         PrintFormat(&quot;%s.%03I64u:\t%G\t%G\t%G\t%I64u\t0x%04x&quot;,
         TimeToString(ticks[i].time,TIME_DATE|TIME_SECONDS),ticks[i].time_msc%1000,
         ticks[i].bid,ticks[i].ask,ticks[i].last,ticks[i].volume,ticks[i].flags);
        }
     }
</code></pre>
<p>
  }
<h3>Veja tamb√©m</h3>
Estruturas e classes, FileWriteArray, FileWriteStruct, FileLoad, FileWrite</p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2584
<h3>FolderCreate</h3>
A fun√ß√£o cria uma pasta no diret√≥rio Arquivos (dependendo do valor de common_flag).
</p>
<pre><code class="language-mql5">
bool¬† FolderCreate(
   string¬† folder_name,¬†      // String com o nome da nova pasta
   int¬†    common_flag=0¬†     // escopo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
folder_name
[in] O nome do diret√≥rio que deseja criar. Cont√©m o caminho relativo para a pasta.
common_flag=0
[in]  Bandeira determinando a localiza√ß√£o do diret√≥rio. Se common_flag=FILE_COMMON, ent√£o o
diret√≥rio est√° na pasta compartilhada para todos os terminais do cliente \Terminal\Common\Files.
Caso contr√°rio, o diret√≥rio est√° em uma pasta local (MQL5\Files ou MQL5\Tester\Files na caso de
testes).
<h3>Valor do Retorno</h3>
Retorna true se bem-sucedida, caso contr√°rio - false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- descri√ß√£o
#property description &quot;O script mostra um exemplo de utiliza√ß√£o da FolderCreate().&quot;
#property description &quot;Par√¢metro externo define a pasta para cria√ß√£o de pastas.&quot;
#property description &quot;Ap√≥s a execu√ß√£o do script, ser√° criada a estrutura das pastas&quot;
//--- mostramos a janela de par√¢metros de entrada ao executar o script
#property script_show_inputs
//--- o par√¢metro de entrada define a pasta em que est√° sendo executado o script
input bool     common_folder=false; // pasta compartilhada de todos os terminais
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- pasta que criamos em MQL5\Files
   string root_folder=&quot;Folder_A&quot;;
   if(CreateFolder(root_folder,common_folder))</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2585
</p>
<pre><code class="language-mql5">
     {
      //--- nela, criamos uma pasta filha Child_Folder_B1
      string folder_B1=&quot;Child_Folder_B1&quot;;
      string path=root_folder+&quot;\\&quot;+folder_B1;          // criamos o nome da pasta com 
      if(CreateFolder(path,common_folder))
        {
         //--- nesta pasta, criamos mais 3 filhas
         string folder_C11=&quot;Child_Folder_C11&quot;;
         string child_path=root_folder+&quot;\\&quot;+folder_C11;// criamos o nome da pasta com 
         CreateFolder(child_path,common_folder);
         //--- segunda pasta filha
         string folder_C12=&quot;Child_Folder_C12&quot;;
         child_path=root_folder+&quot;\\&quot;+folder_C12;
         CreateFolder(child_path,common_folder);
         //--- terceira pasta filha
         string folder_C13=&quot;Child_Folder_C13&quot;;
         child_path=root_folder+&quot;\\&quot;+folder_C13;
         CreateFolder(child_path,common_folder);
        }
     }
//---
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Tenta criar a pasta e exibe uma mensagem sobre isto              |
//+------------------------------------------------------------------+
bool CreateFolder(string folder_path,bool common_flag)
  {
   int flag=common_flag?FILE_COMMON:0;
   string working_folder;
//--- definimos o caminho completo dependendo do par√¢metro common_flag
   if(common_flag)
      working_folder=TerminalInfoString(TERMINAL_COMMONDATA_PATH)+&quot;\\MQL5\\Files&quot;;
   else
      working_folder=TerminalInfoString(TERMINAL_DATA_PATH)+&quot;\\MQL5\\Files&quot;;
//--- mensagem de depura√ß√£o  
   PrintFormat(&quot;folder_path=%s&quot;,folder_path);
//--- tentativa de criar a pasta no caminho relativo MQL5\Files
   if(FolderCreate(folder_path,flag))
     {
      //--- exibimos o caminho completo para a pasta criada
      PrintFormat(&quot;Criamos a pasta %s&quot;,working_folder+&quot;\\&quot;+folder_path);
      //--- redefinimos o c√≥digo de erro
      ResetLastError();
      //--- execu√ß√£o bem-sucedida
      return true;
     }
   else
      PrintFormat(&quot;Falha ao cria a pasta %s. C√≥digo de erro %d&quot;,working_folder+folder_</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2586
</p>
<pre><code class="language-mql5">
//--- execu√ß√£o mal-sucedida
   return false;
</code></pre>
<p>
  }
<h3>Veja Tamb√©m</h3>
<h3>FileOpen(), FolderClean(), FileCopy()</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2587
<h3>FolderDelete</h3>
A fun√ß√£o remove o diret√≥rio especificado. Se a pasta n√£o estiver vazia, ent√£o ele n√£o pode ser
removida.
</p>
<pre><code class="language-mql5">
bool¬† FolderDelete(
   string¬† folder_name,¬†      // String com o nome da pasta para deletar
   int¬†    common_flag=0¬†     // escopo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
folder_name
[in] O nome do diret√≥rio que voc√™ deseja excluir. Cont√©m o caminho completo para a pasta.
common_flag=0
[in]  Bandeira determinando a localiza√ß√£o do diret√≥rio. Se common_flag=FILE_COMMON, ent√£o o
diret√≥rio est√° na pasta compartilhada para todos os terminais do cliente \Terminal\Common\Files.
Caso contr√°rio, o diret√≥rio est√° em uma pasta local (MQL5\Files ou MQL5\Tester\Files no caso de
testes).
<h3>Valor do Retorno</h3>
Retorna true se bem sucedido, caso contr√°rio false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Se o diret√≥rio contiver pelo menos um arquivo e / ou subdiret√≥rio, ent√£o este diret√≥rio n√£o pode ser
exclu√≠do, ele deve ser limpo primeiro. FolderClean() √© usado para limpar a pasta de todos os seus
arquivos ou sub-pastas.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                            Demo_FolderDelete.mq5 |
//|                        Copyright 2011, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- Descri√ß√£o
#property description &quot;O roteiro mostra um exemplo de uso FolderDelete().&quot;
#property description &quot;Primeiro duas pastas s√£o criados, um deles est√° vazia, a segund
#property description &quot;Quando se tenta excluir uma pasta n√£o-vazia, ser√° retornado um 
//--- Mostrar a caixa de di√°logo de par√¢metros de entrada quando se inicia o script
#property script_show_inputs
//--- Par√¢metros de entrada</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2588
</p>
<pre><code class="language-mql5">
input string   firstFolder=&quot;empty&quot;;    // Uma pasta vazia
input string   secondFolder=&quot;nonempty&quot;;// A pasta, em que um arquivo ser√° criado
string filename=&quot;delete_me.txt&quot;;       // O nome do arquivo que ser√° criado na pasta s
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- Escreva o manipulador de arquivo aqui
   int handle;
//--- Descubra em qual pasta estamos trabalhando
   string working_folder=TerminalInfoString(TERMINAL_DATA_PATH)+&quot;\\MQL5\\Files&quot;;
//--- Uma mensagem de depura√ß√£o  
   PrintFormat(&quot;working_folder=%s&quot;,working_folder);
//--- Tentando criar uma pasta vazia em rela√ß√£o ao caminho MQL5\Files
   if(FolderCreate(firstFolder,0)) // 0 (zero) significa que estamos trabalhando na pa
     {
      //--- Insira o caminho completo para a pasta criada
      PrintFormat(&quot;Pasta %s foi criada&quot;,working_folder+&quot;\\&quot;+firstFolder);
      //--- Redefine o c√≥digo de erro
      ResetLastError();
     }
   else
      PrintFormat(&quot;Falha ao criar a pasta %s. C√≥digo de erro %d&quot;,working_folder+&quot;\\&quot;+f
//--- Agora, crie uma pasta n√£o-vazia utilizando a fun√ß√£o FileOpen()
   string filepath=secondFolder+&quot;\\&quot;+filename;  // Formar caminho do arquivo que desej
   handle=FileOpen(filepath,FILE_WRITE|FILE_TXT); // Flag FILE_WRITE neste caso √© obri
   if(handle!=INVALID_HANDLE)
      PrintFormat(&quot;Arquivo %s foi aberto para leitura&quot;,working_folder+&quot;\\&quot;+filepath);
   else
      PrintFormat(&quot;Falha para criar arquivo %s na pasta %s. C√≥digo de erro=&quot;,filename,
   Comment(StringFormat(&quot;Preparar para deletar pastas %s e %s&quot;, firstFolder, secondFol
//--- Uma pequena pausa de 5 segundos para ler uma mensagem no gr√°fico
   Sleep(5000); // Sleep() n√£o pode ser utilizado em indicadores!
//--- Mostrar uma caixa de di√°logo e pedir ao usu√°rio
   int choice=MessageBox(StringFormat(&quot;Voc√™ quer apagar pastas %s e %s?&quot;, firstFolder,
                         &quot;Deletando pastas&quot;,
                         MB_YESNO|MB_ICONQUESTION); //  Dois bot√µes - &quot;Yes&quot; e &quot;No&quot;
//--- Executar uma a√ß√£o dependendo da variante selecionada
   if(choice==IDYES)
     {
      //--- Excluir no gr√°fico o formul√°rio de coment√°rio
      Comment(&quot;&quot;);
      //--- Adicione uma mensagem dentro do jornal &quot;Experts&quot;
      PrintFormat(&quot;Tentando deletar pastas %s e %s&quot;,firstFolder, secondFolder);
      ResetLastError();</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2589
</p>
<pre><code class="language-mql5">
      //--- Deletar uma pasta vazia
      if(FolderDelete(firstFolder))
         //--- A seguinte mensagem deve aparecer uma vez que a pasta est√° vazia
         PrintFormat(&quot;Pasta %s foi deletada com sucesso&quot;,firstFolder);
      else
         PrintFormat(&quot;Falha para deletar pasta %s. C√≥digo de erro=%d&quot;, firstFolder, Ge
      ResetLastError();
      //--- Deletar a pasta que cont√©m um arquivo
      if(FolderDelete(secondFolder))
         PrintFormat(&quot;Pasta %s foi deletada com sucesso&quot;, secondFolder);
      else
         //--- A seguinte mensagem deve aparecer uma vez que a pasta cont√©m um arquivo
         PrintFormat(&quot;Falha para deletar pasta %s. C√≥digo de erro=%d&quot;, secondFolder, G
     }
   else
      Print(&quot;Exclus√£o cancelada&quot;);
//---
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileOpen(), FolderClean(), FileMove()</h3></p>
<p><h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2590
<h3>FolderClean</h3>
A fun√ß√£o exclui todos os arquivos em uma pasta especificada.
</p>
<pre><code class="language-mql5">
bool¬† FolderClean(
   string¬† folder_name,¬†      // String com o nome da pasta eliminada
   int¬†    common_flag=0¬†     // escopo
   );
</code></pre>
<p>
<h3>Par√¢metros</h3>
folder_name
[in] O nome do diret√≥rio onde voc√™ deseja excluir todos os arquivos. Cont√©m o caminho completo
para a pasta.
common_flag=0
[in]  Bandeira determinando a localiza√ß√£o do diret√≥rio. Se common_flag = FILE_COMMON, ent√£o o
diret√≥rio 
est√° 
na 
pasta 
compartilhada 
para 
todos 
os 
terminais 
de 
clientes
\Terminal\Common\Files. Caso contr√°rio, o diret√≥rio est√° numa pasta local (MQL5\Files ou
MQL5\Tester\Files no caso dos testes).
<h3>Valor do Retorno</h3>
Retorna true se bem sucedido, caso contr√°rio false.
<h3>Observa√ß√£o</h3>
Por raz√µes de seguran√ßa, o trabalho com arquivos √© estritamente controlada na l√≠ngua MQL5.
Arquivos com que as opera√ß√µes de arquivo s√£o conduzidas usando os meios MQL5, n√£o podem estar
fora da caixa de prote√ß√£o do arquivo.
Esta fun√ß√£o deve ser usada com cuidado, uma vez que todos os arquivos e todos os subdiret√≥rios
s√£o exclu√≠dos irremediavelmente.
<h3>Exemplo:</h3>
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//|                                             Demo_FolderClean.mq5 |
//|                        Copyright 2011, MetaQuotes Software Corp. |
//|                                              https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright 2000-2024, MetaQuotes Ltd.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//--- Descri√ß√£o
#property description &quot;O script mostra um exemplo de uso FolderClean().&quot;
#property description &quot;Primeiro, os arquivos s√£o criados na pasta especificada utiliza
#property description &quot;Ent√£o, antes que os arquivos sejam apagados, um aviso √© mostrad
//--- Mostrar caixa de di√°logo de par√¢metros de entrada quando se inicia o script
#property script_show_inputs
//--- Par√¢metros de entrada
input string   foldername=&quot;demo_folder&quot;;  // Criar uma pasta em MQL5/Files/</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2591
</p>
<pre><code class="language-mql5">
input int      files=5;                   // O n√∫mero de arquivos para criar e excluir
//+------------------------------------------------------------------+
//| Programa Script da fun√ß√£o start (iniciar)¬†                       |
//+------------------------------------------------------------------+
void OnStart()
  {
   string name=&quot;testfile&quot;;
//---Primeiro abrir ou criar arquivos na pasta de dados do terminal
   for(int N=0;N&lt;files;N++)
     {
      //--- O nome do arquivo no formato demo_pasta\testfileN.txt&#x27;
      string filemane=StringFormat(&quot;%s\\%s%d.txt&quot;,foldername,name,N);
      //--- Abrir um arquivo com a bandeira para a escrita, neste caso, o &#x27;demo_pasta&#x27;
      int handle=FileOpen(filemane,FILE_WRITE);
      //--- Descubra se a fun√ß√£o FileOpen() foi bem sucedida
      if(handle==INVALID_HANDLE)
        {
         PrintFormat(&quot;Falha para criar arquivo %s. C√≥digo de erro&quot;,filemane,GetLastErr
         ResetLastError();
        }
      else
        {
         PrintFormat(&quot;Arquivo %s foi aberto com sucesso&quot;,filemane);
         //--- O arquivo aberto n√£o √© mais necess√°rio, ent√£o fech√°-lo
         FileClose(handle);
        }
     }
//--- Verifique o n√∫mero de arquivos na pasta
   int k=FilesInFolder(foldername+&quot;\\*.*&quot;,0);
   PrintFormat(&quot;Totalmente a pasta %s cont√©m %d arquivos&quot;,foldername,k);
//--- Mostrar uma janela para perguntar ao usu√°rio
   int choice=MessageBox(StringFormat(&quot;Voc√™ vai apagar %d arquivos da pasta %s. Voc√™ q
                         &quot;Excluindo arquivos da pasta&quot;,
                         MB_YESNO|MB_ICONQUESTION); // Dois bot√µes - &quot;Sim&quot; e &quot;N√£o&quot;
   ResetLastError();
//--- Executar uma a√ß√£o dependendo da variante selecionada
   if(choice==IDYES)
     {
      //--- Come√ßar deletar arquivos
      PrintFormat(&quot;Tentando deletar todos os arquivos da pasta %s&quot;,foldername);
      if(FolderClean(foldername,0))
         PrintFormat(&quot;Arquivos foram deletados com sucesso, %d arquivos que restaram n
                     foldername,
                     FilesInFolder(foldername+&quot;\\*.*&quot;,0));
      else
         PrintFormat(&quot;Falha ao deletar arquivos da pasta %s. C√≥digo de erro %d&quot;,folder
     }</p>
<p></code></pre>
<p>
<h3>Fun√ß√µes de Arquivo</h3>
¬© 2000-2025, MetaQuotes Ltd.
2592
</p>
<pre><code class="language-mql5">
   else
      PrintFormat(&quot;Exclus√£o cancelada&quot;);
//---
</code></pre>
<p>
  }
</p>
<pre><code class="language-mql5">
//+------------------------------------------------------------------+
//| Retornar o n√∫mero de arquivos na pasta especificada¬†             |
//+------------------------------------------------------------------+
int FilesInFolder(string path,int flag)
  {
   int count=0;
   long handle;
   string filename;
//---
   handle=FileFindFirst(path,filename,flag);
//--- Se pelo menos um arquivo encontrado, procurar por mais arquivos
   if(handle!=INVALID_HANDLE)
     {
      //--- Mostrar o nome do arquivo
      PrintFormat(&quot;Arquivo %s encontrado&quot;,filename);
      //--- Aumentar o contador de arquivos/pastas encontrados
      count++;
      //--- Iniciar a pesquisa em todos arquivos/pastas
      while(FileFindNext(handle,filename))
        {
         PrintFormat(&quot;Arquivo %s encontrado&quot;,filename);
         count++;
        }
      //--- N√£o se esque√ßa de fechar o manipulador de pesquisa ap√≥s a conclus√£o
      FileFindClose(handle);
     }
   else // Falha ao obter o manipulador
     {
      PrintFormat(&quot;Pesquisa nos arquivos na pasta %s falhou&quot;,path);
     }
//--- Retorna o resultado
   return count;
</code></pre>
<p>
  }
<h3>Tamb√©m Veja</h3>
<h3>FileFindFirst, FileFindNext, FileFindClose</h3>
</p>
        </article>
        
        <footer>
            <p>Documenta√ß√£o MQL5 - Fonte: MetaQuotes Ltd.</p>
        </footer>
    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
        
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
        }
        
        function filterNav() {
            const filter = document.getElementById('search').value.toLowerCase();
            const items = document.querySelectorAll('.nav-list li');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? '' : 'none';
            });
        }
    </script>
</body>
</html>